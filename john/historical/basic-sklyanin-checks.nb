(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6713,        217]
NotebookOptionsPosition[      6077,        191]
NotebookOutlinePosition[      6477,        209]
CellTagsIndexPosition[      6434,        206]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "6"}], ";"}]], "Input",
 CellChangeTimes->{{3.731343933587656*^9, 3.7313439346545963`*^9}, 
   3.731344089617056*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Kp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y", "[", 
      RowBox[{"i", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731320496711886*^9, 3.731320525326016*^9}, {
   3.731320726152176*^9, 3.731320770208788*^9}, {3.731320918812606*^9, 
   3.7313209190939093`*^9}, 3.731343946772084*^9, {3.731344211705406*^9, 
   3.731344236509014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"set", " ", "the", " ", "first", " ", "4", " ", "columns"}], " ", 
    "=", " ", "identity"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Kp", " ", "=", " ", 
    RowBox[{
     RowBox[{"Kp", "//.", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"i_", ",", "i_"}], "]"}], "\[RuleDelayed]", "1"}]}], "//.", 
     RowBox[{
      RowBox[{"y", "[", 
       RowBox[{"i_", ",", "j_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "<", "5"}], ",", "0", ",", 
        RowBox[{"y", "[", 
         RowBox[{"i", ",", "j"}], "]"}]}], "]"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.731344237888039*^9, 3.7313442806870527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"brP", "[", "a__", "]"}], ":=", 
   RowBox[{"Det", "[", 
    RowBox[{"Kp", "[", 
     RowBox[{"[", 
      RowBox[{"{", "a", "}"}], "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731320927586398*^9, 3.731320948692704*^9}, {
  3.731324030912643*^9, 3.7313240321363277`*^9}, {3.731343915765325*^9, 
  3.731343916632083*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sklyaninBrYs", "[", 
    RowBox[{
     RowBox[{"y", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ",", 
     RowBox[{"y", "[", 
      RowBox[{"a_", ",", "b_"}], "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sign", "[", 
       RowBox[{"a", "-", "i"}], "]"}], "-", 
      RowBox[{"Sign", "[", 
       RowBox[{"b", "-", "j"}], "]"}]}], ")"}], 
    RowBox[{"y", "[", 
     RowBox[{"i", ",", "b"}], "]"}], 
    RowBox[{"y", "[", 
     RowBox[{"a", ",", "j"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.731320982737987*^9, 3.731321047987184*^9}, 
   3.73134392556623*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sklyaninBr", "[", 
   RowBox[{"f_", ",", "g_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"f", ",", 
       RowBox[{"y", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], "]"}], 
     RowBox[{"D", "[", 
      RowBox[{"g", ",", 
       RowBox[{"y", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}], 
     RowBox[{"sklyaninBrYs", "[", 
      RowBox[{
       RowBox[{"y", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"y", "[", 
        RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "4"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731321056651613*^9, 3.731321124691764*^9}, {
  3.7313439266898003`*^9, 3.731343944612562*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"br", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "6"}], "]"}], 
     RowBox[{
      RowBox[{"br", "[", 
       RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"br", "[", 
         RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "]"}], 
        RowBox[{"br", "[", 
         RowBox[{"2", ",", "3", ",", "5", ",", "6"}], "]"}]}], ")"}]}]}], "/.", 
    RowBox[{"br", "\[Rule]", "brP"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"br", "[", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5"}], "]"}], 
     RowBox[{
      RowBox[{"br", "[", 
       RowBox[{"3", ",", "4", ",", "5", ",", "6"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"br", "[", 
         RowBox[{"1", ",", "3", ",", "5", ",", "6"}], "]"}], 
        RowBox[{"br", "[", 
         RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "]"}]}], ")"}]}]}], "/.", 
    RowBox[{"br", "\[Rule]", "brP"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.731322258492579*^9, 3.731322326875408*^9}, {
  3.731343974166553*^9, 3.731343975728856*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sklyaninBr", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "a", "*", "b"}], ")"}]}], "//", 
  "simplify"}]], "Input",
 CellChangeTimes->{{3.731322373667366*^9, 3.731322389189968*^9}, {
   3.731324072614663*^9, 3.731324111338202*^9}, 3.731324206842146*^9, {
   3.73132433988617*^9, 3.7313243412897377`*^9}, {3.731343979644287*^9, 
   3.731343981400137*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.731322381852386*^9, 3.731322389654476*^9}, {
   3.7313240754488707`*^9, 3.731324113698887*^9}, 3.731324298854149*^9, {
   3.731324380001195*^9, 3.731324401341263*^9}, 3.731344093889051*^9, 
   3.731344297944892*^9}]
}, Open  ]]
},
Evaluator->"local2",
WindowSize->{840, 1006},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 161, 4, 39, "Input"],
Cell[722, 26, 560, 14, 39, "Input"],
Cell[1285, 42, 753, 21, 66, "Input"],
Cell[2041, 65, 382, 10, 39, "Input"],
Cell[2426, 77, 657, 21, 66, "Input"],
Cell[3086, 100, 976, 30, 92, "Input"],
Cell[4065, 132, 1242, 34, 66, "Input"],
Cell[CellGroupData[{
Cell[5332, 170, 460, 12, 39, "Input"],
Cell[5795, 184, 266, 4, 39, "Output"]
}, Open  ]]
}
]
*)

