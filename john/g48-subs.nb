(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103330,       3092]
NotebookOptionsPosition[     95854,       2853]
NotebookOutlinePosition[     96236,       2870]
CellTagsIndexPosition[     96193,       2867]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Q: Find subgroups of Gr(4,8) with good x-coordinates", "Title",
 CellChangeTimes->{{3.7155216343483543`*^9, 3.715521661935596*^9}, {
   3.7155217024191933`*^9, 3.715521776747312*^9}, {3.715697106466093*^9, 
   3.715697132670868*^9}, 3.717339565784286*^9, {3.717596412665661*^9, 
   3.7175964295471077`*^9}, 3.7190772318918056`*^9, {3.719161602248806*^9, 
   3.719161617724811*^9}, 3.7191622907219543`*^9, {3.719330906137623*^9, 
   3.719330919779743*^9}, 3.7214675803034782`*^9, {3.722256568008562*^9, 
   3.722256584333577*^9}, {3.7222587062837543`*^9, 3.7222587099149513`*^9}, 
   3.723892693455821*^9, {3.723910170409132*^9, 3.723910179723064*^9}, {
   3.7245908711399803`*^9, 3.724590880044897*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "tools.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.713271961760497*^9, 3.7132719819312153`*^9}, {
  3.713272319095078*^9, 3.713272323693686*^9}, {3.7132801678394003`*^9, 
  3.7132801680639467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<pb8.dat\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.724436748119182*^9, 3.724436754021512*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ratios", "[", "8", "]"}], ",", 
     RowBox[{"1", "/", 
      RowBox[{"ratios", "[", "8", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numBase", "=", 
   RowBox[{
    RowBox[{"num", "[", "8", "]"}], "[", "base", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.724085577435013*^9, 3.724085589989286*^9}, {
  3.72458217727081*^9, 3.724582178708366*^9}, {3.72562701289822*^9, 
  3.725627021638221*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"len", "=", 
   RowBox[{"Length", "[", "base", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7239083465195847`*^9, 3.723908350277817*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pairs", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Sort", "/@", 
     RowBox[{"Join", "[", 
      RowBox[{"pb1Pairs", ",", "pb0Pairs"}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7245822247937937`*^9, 3.724582259361697*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"adjMatrix", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Complement", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "aa", "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Intersection", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"aa", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", "len", "]"}]}], ",", "pairs"}], "]"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", "len"}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "len"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.724066094252186*^9, 3.724066203944043*^9}, {
  3.724162440210166*^9, 3.7241624666130247`*^9}, {3.724582304029661*^9, 
  3.724582345397298*^9}, {3.724582428085484*^9, 3.724582441203298*^9}}],

Cell[CellGroupData[{

Cell["find subgroups of length 3,4,5,6", "Section",
 CellChangeTimes->{{3.724590900794965*^9, 3.724590911499824*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"trips", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sort", "/@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"aa", ",", 
                   RowBox[{"adjMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"aa", ",", "i"}], "]"}], "]"}], ",", "#"}], "}"}],
                  "&"}], "/@", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"adjMatrix", "[", 
                   RowBox[{"[", "aa", "]"}], "]"}], ",", 
                  RowBox[{"adjMatrix", "[", 
                   RowBox[{"[", 
                    RowBox[{"adjMatrix", "[", 
                    RowBox[{"[", 
                    RowBox[{"aa", ",", "i"}], "]"}], "]"}], "]"}], "]"}]}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"adjMatrix", "[", 
                   RowBox[{"[", "aa", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
             ",", "1"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"aa", ",", "len"}], "}"}]}], "]"}], ",", "1"}], "]"}], 
      "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "len"}], "}"}]}], "]"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.724066316805529*^9, 3.724066493424045*^9}, {
  3.724066524590736*^9, 3.724066591965693*^9}, {3.724162501212832*^9, 
  3.7241625023093433`*^9}, {3.724582364355098*^9, 3.724582424688099*^9}, {
  3.724582499221233*^9, 3.724582512394599*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trips", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.724582491310903*^9, 3.724582493212484*^9}, {
  3.724582568916297*^9, 3.724582571243828*^9}}],

Cell[BoxData["603584"], "Output",
 CellChangeTimes->{
  3.724582493615192*^9, {3.724582551269093*^9, 3.7245825717156343`*^9}, 
   3.7253709146586533`*^9, 3.72561159475735*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"quads", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"trips", "[", 
             RowBox[{"[", "aa", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "#"}], "}"}], "&"}], "/@", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "b", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "c", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"aa", ",", 
             RowBox[{"Length", "[", "trips", "]"}]}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "trips", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.724066965546423*^9, 3.724066979598278*^9}, {
  3.7240670260938168`*^9, 3.72406704422961*^9}, {3.724067074465363*^9, 
  3.724067205282022*^9}, {3.7240673576839867`*^9, 3.7240673645709267`*^9}, {
  3.724582541716381*^9, 3.724582566783292*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"quads", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.724582491310903*^9, 3.724582493212484*^9}, {
  3.724582568916297*^9, 3.724582571243828*^9}, {3.724582601529038*^9, 
  3.724582602281267*^9}}],

Cell[BoxData["1482400"], "Output",
 CellChangeTimes->{
  3.724582493615192*^9, {3.724582551269093*^9, 3.7245825717156343`*^9}, 
   3.724582603738064*^9, 3.7253709376078787`*^9, 3.725611615071138*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"quints", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"quads", "[", 
             RowBox[{"[", "aa", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "#"}], "}"}],
                 "&"}], "/@", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "b", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "c", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "d", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"aa", ",", 
             RowBox[{"Length", "[", "quads", "]"}]}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "quads", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.724067306056411*^9, 3.724067328444257*^9}, {
  3.724067387316481*^9, 3.724067395573119*^9}, {3.724582665548582*^9, 
  3.7245826795553627`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"quints", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.7245826864449997`*^9, 3.724582688142799*^9}}],

Cell[BoxData["1600352"], "Output",
 CellChangeTimes->{3.724582742528557*^9, 3.725370994489489*^9, 
  3.725611667825737*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sixs", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Sort", "/@", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"quints", "[", 
             RowBox[{"[", "aa", "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "e_"}], 
              "}"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "a", ",", "b", ",", "c", ",", "d", ",", "e", ",", "#"}], 
                 "}"}], "&"}], "/@", 
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "a", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "b", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "c", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "d", "]"}], "]"}], ",", 
                 RowBox[{"adjMatrix", "[", 
                  RowBox[{"[", "e", "]"}], "]"}]}], "]"}]}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"aa", ",", 
             RowBox[{"Length", "[", "quints", "]"}]}], "}"}]}], "]"}], ",", 
         "1"}], "]"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "quints", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.724067306056411*^9, 3.724067328444257*^9}, {
  3.724067387316481*^9, 3.724067395573119*^9}, {3.724067449253071*^9, 
  3.7240674720979643`*^9}, {3.724083482075645*^9, 3.724083482389184*^9}, {
  3.724582699014949*^9, 3.724582716414261*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sixs", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.724582725188115*^9, 3.724582727270398*^9}}],

Cell[BoxData["771328"], "Output",
 CellChangeTimes->{3.724582807478252*^9, 3.725371061379251*^9, 
  3.72561172973314*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["find subgroups of length 6 with E6 structure", "Section",
 CellChangeTimes->{{3.724590918330092*^9, 3.724590950007375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sixsGoodZeroCount", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"sixs", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"pb8", "/@", 
          RowBox[{"Subsets", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "0"}], "]"}], "\[Equal]",
        "10"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724590407772255*^9, 3.7245904341217117`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "sixsGoodZeroCount", "]"}]], "Input",
 CellChangeTimes->{{3.7240835137594547`*^9, 3.724083521426179*^9}}],

Cell[BoxData["155136"], "Output",
 CellChangeTimes->{
  3.7240838844249163`*^9, 3.7241638897219*^9, {3.724590427348592*^9, 
   3.724590447771859*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"correctQuiverStructure", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Sort", "/@", 
     RowBox[{"(", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"sklyanin", "[", "7", "]"}], "[", 
           RowBox[{
            RowBox[{"g47Seed", "[", 
             RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
         "g47Seed"}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "[", "g47Seed", "]"}]}], "}"}]}], "]"}], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724085414383428*^9, 3.7240854689470243`*^9}, {
   3.724085671993291*^9, 3.724085726678268*^9}, {3.7240857833911047`*^9, 
   3.724085787631269*^9}, 3.724155482604869*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findE6s", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmp", "=", 
           RowBox[{"sixsGoodZeroCount", "[", 
            RowBox[{"[", "xx", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"Sort", "/@", 
            RowBox[{"(", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pb8", "[", 
                  RowBox[{
                   RowBox[{"tmp", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                 "/@", "tmp"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}], 
             ")"}]}], "]"}], "\[Equal]", "correctQuiverStructure"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"xx", ",", 
         RowBox[{"Length", "[", "sixsGoodZeroCount", "]"}]}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"xx", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "sixsGoodZeroCount", "]"}]}], "}"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72408563326723*^9, 3.7240856586470633`*^9}, {
  3.724085761226063*^9, 3.724085836839715*^9}, {3.7240858686892567`*^9, 
  3.724085871433628*^9}, {3.724085911407633*^9, 3.7240859471812468`*^9}, {
  3.724155523790444*^9, 3.7241555245331078`*^9}, {3.724169929090067*^9, 
  3.7241699337233047`*^9}, {3.7245904692998753`*^9, 3.7245905031652403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"e6stmp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"sixsGoodZeroCount", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{"findE6s", ",", "True"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724086317622675*^9, 3.7240863527493134`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "e6stmp1", "]"}]], "Input",
 CellChangeTimes->{{3.724590507093107*^9, 3.724590532392852*^9}}],

Cell[BoxData["22832"], "Output",
 CellChangeTimes->{{3.724590516910419*^9, 3.724590533243705*^9}, 
   3.7245907180902987`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rotateE6", "[", "clus_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"brackets", ",", "node"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"brackets", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pb8", "[", 
             RowBox[{
              RowBox[{"clus", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
            "clus"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "6"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "1", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "6", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "3", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "1"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "4", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0", ",",
               "0"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "2", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pb8", "[", 
               RowBox[{
                RowBox[{"node", "[", "1", "]"}], ",", "#"}], "]"}], "&"}], "/@",
              "clus"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "5", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"pb8", "[", 
               RowBox[{
                RowBox[{"node", "[", "6", "]"}], ",", "#"}], "]"}], "&"}], "/@",
              "clus"}], ",", "1"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"node", "/@", 
        RowBox[{"Range", "[", "6", "]"}]}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.724152985295802*^9, 3.724153026816073*^9}, {
  3.724153067443027*^9, 3.724153096477889*^9}, {3.724153190327096*^9, 
  3.72415320354953*^9}, {3.7241532493235407`*^9, 3.7241532515279713`*^9}, {
  3.724155345814637*^9, 3.7241553845265303`*^9}, {3.72417027130831*^9, 
  3.724170272161825*^9}, {3.724170422633583*^9, 3.7241704580936317`*^9}, {
  3.724170549299922*^9, 3.7241705494212112`*^9}, {3.7245907307933817`*^9, 
  3.724590743811893*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotatedE6s", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"rotateE6", "[", 
        RowBox[{"e6stmp1", "[", 
         RowBox[{"[", "aa", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "e6stmp1", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "e6stmp1", "]"}]}], "}"}]}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.724171050996361*^9, 3.724171118925921*^9}, {
  3.724171160903644*^9, 3.724171164445331*^9}, {3.724590756251926*^9, 
  3.72459077103897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"posGoods", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Union", "[", "#", "]"}], "]"}], "&"}], "/@", "rotatedE6s"}],
       ",", "6"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7241721730061197`*^9, 3.7241721786727533`*^9}, {
  3.7241731168032618`*^9, 3.7241731258235197`*^9}, {3.72417318753199*^9, 
  3.7241731898930073`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"e6stmp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"rotatedE6s", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posGoods"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7241731330821857`*^9, 3.724173151250458*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"e6stmp2", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.724424629773654*^9, 3.7244246336958513`*^9}}],

Cell[BoxData["432"], "Output",
 CellChangeTimes->{3.72442463415279*^9, 3.72459079201154*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["find subgroups of length 5 with D5 structure", "Section",
 CellChangeTimes->{{3.7245909428834047`*^9, 3.724590956819758*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"pb", "[", 
     RowBox[{"d5", "[", "]"}], "]"}], "@@@", 
    RowBox[{"Subsets", "[", 
     RowBox[{
      RowBox[{"d5Seed", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.7245909747816257`*^9, 3.7245910106443987`*^9}}],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{{3.724590977962226*^9, 3.724591011282823*^9}, 
   3.725371061524688*^9, 3.725636656419064*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"quintsGoodZeroCount", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"quints", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"pb8", "/@", 
          RowBox[{"Subsets", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "0"}], "]"}], "\[Equal]",
        "6"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724590407772255*^9, 3.7245904341217117`*^9}, {
  3.724591020902022*^9, 3.7245910299019623`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "quintsGoodZeroCount", "]"}]], "Input",
 CellChangeTimes->{{3.7240835137594547`*^9, 3.724083521426179*^9}, {
  3.724591034904099*^9, 3.724591038217979*^9}}],

Cell[BoxData["195264"], "Output",
 CellChangeTimes->{
  3.7240838844249163`*^9, 3.7241638897219*^9, {3.724590427348592*^9, 
   3.724590447771859*^9}, 3.724591052505522*^9, 3.725371083627676*^9, 
   3.725636678836782*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"correctQuiverStructure", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Sort", "/@", 
     RowBox[{"(", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pb", "[", 
            RowBox[{"d5", "[", "]"}], "]"}], "[", 
           RowBox[{
            RowBox[{"d5Seed", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "ii"}], "]"}], "]"}], ",", "#"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"d5Seed", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"d5Seed", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724591071600605*^9, 3.7245911035686502`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["correctQuiverStructure"], "Input",
 CellChangeTimes->{{3.72537307258928*^9, 3.72537307662433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.725373077642124*^9, 3.7256366790182247`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"findD5s", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmp", "=", 
           RowBox[{"quintsGoodZeroCount", "[", 
            RowBox[{"[", "xx", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"Sort", "/@", 
            RowBox[{"(", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pb8", "[", 
                  RowBox[{
                   RowBox[{"tmp", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                 "/@", "tmp"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}], 
             ")"}]}], "]"}], "\[Equal]", "correctQuiverStructure"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"xx", ",", 
         RowBox[{"Length", "[", "quintsGoodZeroCount", "]"}]}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"xx", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "quintsGoodZeroCount", "]"}]}], "}"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72408563326723*^9, 3.7240856586470633`*^9}, {
  3.724085761226063*^9, 3.724085836839715*^9}, {3.7240858686892567`*^9, 
  3.724085871433628*^9}, {3.724085911407633*^9, 3.7240859471812468`*^9}, {
  3.724155523790444*^9, 3.7241555245331078`*^9}, {3.724169929090067*^9, 
  3.7241699337233047`*^9}, {3.7245904692998753`*^9, 3.7245905031652403`*^9}, {
  3.724591266294065*^9, 3.72459128004362*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d5stmp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"quintsGoodZeroCount", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{"findD5s", ",", "True"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724086317622675*^9, 3.7240863527493134`*^9}, {
  3.724591293528088*^9, 3.724591304894121*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "d5stmp1", "]"}]], "Input",
 CellChangeTimes->{{3.724590507093107*^9, 3.724590532392852*^9}, {
  3.724591311121194*^9, 3.7245913117661667`*^9}}],

Cell[BoxData["6448"], "Output",
 CellChangeTimes->{{3.724590516910419*^9, 3.724590533243705*^9}, 
   3.7245907180902987`*^9, 3.7245913122754517`*^9, 3.725371095253477*^9, 
   3.7256367319867153`*^9, 3.725636786293494*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rotateD5", "[", "clus_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"brackets", ",", "node"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"brackets", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pb8", "[", 
             RowBox[{
              RowBox[{"clus", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
            "clus"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "5"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "1", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "2", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "1"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "3", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1", ",", "1"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "4", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "5", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0", ",", "0"}], 
             "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"node", "/@", 
        RowBox[{"Range", "[", "5", "]"}]}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.724152985295802*^9, 3.724153026816073*^9}, {
   3.724153067443027*^9, 3.724153096477889*^9}, {3.724153190327096*^9, 
   3.72415320354953*^9}, {3.7241532493235407`*^9, 3.7241532515279713`*^9}, {
   3.724155345814637*^9, 3.7241553845265303`*^9}, {3.72417027130831*^9, 
   3.724170272161825*^9}, {3.724170422633583*^9, 3.7241704580936317`*^9}, {
   3.724170549299922*^9, 3.7241705494212112`*^9}, {3.7245907307933817`*^9, 
   3.724590743811893*^9}, {3.72459148481706*^9, 3.7245914904564*^9}, {
   3.724591551158687*^9, 3.7245916353721857`*^9}, 3.725371282751771*^9, {
   3.725373363923792*^9, 3.725373367041007*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotatedD5s", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"rotateD5", "[", 
        RowBox[{"d5stmp1", "[", 
         RowBox[{"[", "aa", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "d5stmp1", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "d5stmp1", "]"}]}], "}"}]}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.724171050996361*^9, 3.724171118925921*^9}, {
  3.724171160903644*^9, 3.724171164445331*^9}, {3.724590756251926*^9, 
  3.72459077103897*^9}, {3.7245916596120663`*^9, 3.7245916737564163`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"posGoods", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Union", "[", "#", "]"}], "]"}], "&"}], "/@", "rotatedD5s"}],
       ",", "5"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7241721730061197`*^9, 3.7241721786727533`*^9}, {
  3.7241731168032618`*^9, 3.7241731258235197`*^9}, {3.72417318753199*^9, 
  3.7241731898930073`*^9}, {3.724591686878304*^9, 3.724591694379694*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d5stmp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"rotatedD5s", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posGoods"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7241731330821857`*^9, 3.724173151250458*^9}, {
  3.724591705780758*^9, 3.724591709635092*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exactBmatrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pb", "[", 
       RowBox[{"d5", "[", "]"}], "]"}], "[", 
      RowBox[{
       RowBox[{"d5Seed", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"d5Seed", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "5"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7253733907366247`*^9, 3.72537339771406*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d5stmp3", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"d5stmp2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"pb8", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "5"}], "}"}]}], "]"}], "\[Equal]", 
       "exactBmatrix"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725371129090987*^9, 3.725371148348447*^9}, {
  3.725371181681925*^9, 3.7253712555554028`*^9}, {3.7253731650036907`*^9, 
  3.725373195425283*^9}, {3.725373403131193*^9, 3.725373459365802*^9}, {
  3.725373505185891*^9, 3.725373537893503*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "d5stmp3", "]"}]], "Input",
 CellChangeTimes->{{3.725373540018618*^9, 3.725373543549431*^9}, {
  3.72563676289981*^9, 3.7256367636594143`*^9}}],

Cell[BoxData["2544"], "Output",
 CellChangeTimes->{
  3.725373543981205*^9, {3.72563673367666*^9, 3.7256367876812572`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"d5sNum", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"sortInverse", "[", 
        RowBox[{"d5Xs", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"numBase", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"d5stmp3", "[", 
            RowBox[{"[", "aa", "]"}], "]"}]}], ")"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "d5stmp3", "]"}]}], "}"}]}], "]"}], ",", 
     "aa"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7256367529052343`*^9, 3.725636757276585*^9}, {
  3.725636792379449*^9, 3.72563683295772*^9}, {3.725636867114623*^9, 
  3.725636872101581*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d5sNumReduce", "=", 
   RowBox[{"Union", "[", "d5sNum", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725636835091195*^9, 3.725636844758933*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "d5sNumReduce", "]"}]], "Input",
 CellChangeTimes->{{3.725636847647175*^9, 3.725636851339129*^9}}],

Cell[BoxData["2256"], "Output",
 CellChangeTimes->{3.725636912248135*^9}]
}, Open  ]],

Cell["not really worth separating the distinct ones out", "Text",
 CellChangeTimes->{{3.7256369458513536`*^9, 3.7256369681977882`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d5s", "=", "d5stmp3"}], ";"}]], "Input",
 CellChangeTimes->{{3.7256369704065037`*^9, 3.725636974424073*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"numBase", "[", 
    RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
  RowBox[{"d5s", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.725636975651334*^9, 3.7256369837036448`*^9}, {
  3.725638194745675*^9, 3.725638197342231*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["71629628043680217211590", "62006284169648292037409"], ",", 
   FractionBox["9662858034285848", "140989828134362355"], ",", 
   FractionBox["1191808453444565600", "131173349268866109"], ",", 
   FractionBox["235602938040152638486087", "13914755160355145994240"], ",", 
   FractionBox["23321461491460756637", "11403496740270096000"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.725636976991992*^9, 3.725636984410178*^9}, 
   3.7256381978916063`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<d5FuncR27.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.725636939427986*^9, 3.725636939902504*^9}, {
  3.725636996498992*^9, 3.725637014735746*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "d5s", "]"}]], "Input",
 CellChangeTimes->{{3.725638921356395*^9, 3.725638922844746*^9}}],

Cell[BoxData["2544"], "Output",
 CellChangeTimes->{3.72563892326016*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"countGoods", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Variables", "[", 
             RowBox[{"d5FuncFullA3", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"numBase", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
                RowBox[{"d5s", "[", 
                 RowBox[{"[", "aa", "]"}], "]"}]}], ")"}]}], "]"}], ",", 
            RowBox[{"A3", "[", "__", "]"}]}], "]"}], "/.", 
          RowBox[{
           RowBox[{"A3", "[", "a__", "]"}], "\[RuleDelayed]", 
           RowBox[{"a3Check", "[", 
            RowBox[{"{", "a", "}"}], "]"}]}]}], ",", "True"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "d5s", "]"}]}], "}"}]}], "]"}], ",", "aa"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725637690399045*^9, 3.725637695868855*^9}, {
  3.725638808836432*^9, 3.725638926581792*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "[", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"solve", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"d5FuncFullA3", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"numBase", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"d5s", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}], ")"}], "/.", 
                 RowBox[{
                  RowBox[{"A3", "[", "a__", "]"}], "\[RuleDelayed]", 
                  RowBox[{"tmp", "[", 
                   RowBox[{"a3Check", "[", 
                    RowBox[{"{", "a", "}"}], "]"}], "]"}]}]}], ")"}], "/.", 
               RowBox[{
                RowBox[{"tmp", "[", "True", "]"}], "\[Rule]", "0"}]}], 
              ")"}]}], ")"}], "/.", 
           RowBox[{
            RowBox[{"tmp", "[", "a__", "]"}], "\[RuleDelayed]", "1"}]}], 
          "]"}], "&"}], "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"countGoods", ",", "#"}], "]"}], "]"}]}], ")"}], "&"}], "/@", 
     RowBox[{
      RowBox[{"Union", "[", "countGoods", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], ",", "1"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.725639030122921*^9, 3.725639060305091*^9}, {
  3.725639269891272*^9, 3.725639275916646*^9}, {3.725639452643632*^9, 
  3.7256395625490932`*^9}, {3.7256398192384*^9, 3.725639827159032*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7256390334154778`*^9, 3.7256390607224483`*^9}, 
   3.7256392764498587`*^9, {3.7256394544843397`*^9, 3.725639536720779*^9}, 
   3.725639578195195*^9, 3.725639842772867*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Position", "[", 
     RowBox[{"countGoods", ",", "46"}], "]"}], ",", 
    RowBox[{"Position", "[", 
     RowBox[{"countGoods", ",", "33"}], "]"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "593", ",", "599", ",", "609", ",", "746", ",", "751", ",", "958", ",", 
   "983", ",", "984", ",", "995", ",", "1233", ",", "1677", ",", "1700", ",", 
   "1739", ",", "1746", ",", "1753", ",", "1772", ",", "1938", ",", "1939", 
   ",", "2019", ",", "2022", ",", "2101", ",", "2113", ",", "2144", ",", 
   "2211", ",", "2237", ",", "2259", ",", "2344", ",", "2349", ",", "2481", 
   ",", "2485", ",", "2523", ",", "2527", ",", "23", ",", "32", ",", "33", 
   ",", "38", ",", "48", ",", "74", ",", "75", ",", "77", ",", "95", ",", 
   "97", ",", "98", ",", "106", ",", "136", ",", "137", ",", "140", ",", 
   "153", ",", "163", ",", "165", ",", "179", ",", "231", ",", "232", ",", 
   "243", ",", "288", ",", "289", ",", "306", ",", "314", ",", "349", ",", 
   "350", ",", "363", ",", "389", ",", "390", ",", "398", ",", "427", ",", 
   "473", ",", "532", ",", "579", ",", "581", ",", "636", ",", "639", ",", 
   "640", ",", "649", ",", "653", ",", "654", ",", "679", ",", "687", ",", 
   "688", ",", "708", ",", "714", ",", "715", ",", "740", ",", "741", ",", 
   "773", ",", "774", ",", "777", ",", "780", ",", "825", ",", "829", ",", 
   "830", ",", "847", ",", "889", ",", "1025", ",", "1026", ",", "1038", ",", 
   "1043", ",", "1046", ",", "1049", ",", "1081", ",", "1083", ",", "1092", 
   ",", "1118", ",", "1119", ",", "1123", ",", "1133", ",", "1198", ",", 
   "1260", ",", "1287", ",", "1301", ",", "1634", ",", "1636", ",", "1637", 
   ",", "1668", ",", "1678", ",", "1680", ",", "1681", ",", "1703", ",", 
   "1707", ",", "1712", ",", "1738", ",", "1741", ",", "1742", ",", "1743", 
   ",", "1748", ",", "1749", ",", "1763", ",", "1775", ",", "1777", ",", 
   "1778", ",", "1814", ",", "1815", ",", "1819", ",", "1891", ",", "1893", 
   ",", "1897", ",", "1941", ",", "1945", ",", "1946", ",", "1952", ",", 
   "1953", ",", "1954", ",", "1976", ",", "1977", ",", "1984", ",", "2024", 
   ",", "2029", ",", "2030", ",", "2050", ",", "2059", ",", "2061", ",", 
   "2102", ",", "2111", ",", "2117", ",", "2132", ",", "2137", ",", "2138", 
   ",", "2139", ",", "2141", ",", "2145", ",", "2170", ",", "2175", ",", 
   "2181", ",", "2200", ",", "2207", ",", "2208", ",", "2240", ",", "2241", 
   ",", "2243", ",", "2244", ",", "2245", ",", "2254", ",", "2275", ",", 
   "2281", ",", "2283", ",", "2288", ",", "2289", ",", "2293", ",", "2333", 
   ",", "2342", ",", "2352", ",", "2377", ",", "2389", ",", "2391", ",", 
   "2415", ",", "2442", ",", "2447", ",", "2448", ",", "2516", ",", "2518", 
   ",", "2532", ",", "2536", ",", "2537"}], "}"}]], "Output",
 CellChangeTimes->{3.725641085174932*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"d5AnsatzNoBads", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d5FuncFullA3", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"numBase", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
                RowBox[{"d5s", "[", 
                 RowBox[{"[", "aa", "]"}], "]"}]}], ")"}]}], ")"}], "/.", 
            RowBox[{
             RowBox[{"A3", "[", "a__", "]"}], "\[RuleDelayed]", 
             RowBox[{"tmp", "[", 
              RowBox[{
               RowBox[{"a3Check", "[", 
                RowBox[{"{", "a", "}"}], "]"}], ",", 
               RowBox[{"{", "a", "}"}]}], "]"}]}]}], ")"}], "/.", 
          RowBox[{
           RowBox[{"tmp", "[", 
            RowBox[{
             RowBox[{"a3Check", "[", "__", "]"}], ",", "__"}], "]"}], 
           "\[RuleDelayed]", "0"}]}], ")"}], "/.", 
        RowBox[{
         RowBox[{"tmp", "[", 
          RowBox[{"True", ",", 
           RowBox[{"{", "a__", "}"}]}], "]"}], "\[RuleDelayed]", 
         RowBox[{"A3", "[", "a", "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "d5s", "]"}]}], "}"}]}], "]"}], ",", "aa"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725639896770708*^9, 3.725639899384371*^9}, {
  3.725640457945868*^9, 3.7256405837036037`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzPartial", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "#", "]"}], 
       RowBox[{"d5AnsatzNoBads", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}], "&"}], "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"countGoods", ",", "46"}], "]"}], ",", 
        RowBox[{"Position", "[", 
         RowBox[{"countGoods", ",", "33"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725640854220551*^9, 3.725640919834638*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "ansatzPartial", "]"}]], "Input",
 CellChangeTimes->{{3.725642265225533*^9, 3.725642268995756*^9}}],

Cell[BoxData["192"], "Output",
 CellChangeTimes->{3.725642269378749*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzPartialExp", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ansatzPartial", "[", 
         RowBox[{"[", "aa", "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"A3", "[", "x__", "]"}], ":>", 
         RowBox[{
          RowBox[{"b2b2", "[", "8", "]"}], "[", 
          RowBox[{
           RowBox[{"a3Func", "[", "x", "]"}], "/.", 
           RowBox[{
            RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
            RowBox[{"cb2", "[", 
             RowBox[{"clean8", "[", "a", "]"}], "]"}]}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "ansatzPartial", "]"}]}], "}"}]}], "]"}], ",",
      "aa"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725642222753695*^9, 3.7256422723341618`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzPartialExp", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"collectTensors", "[", 
         RowBox[{"ansatzPartialExp", "[", 
          RowBox[{"[", "aa", "]"}], "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"a_", "*", 
          RowBox[{"tensor", "[", "b__", "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Expand", "[", "a", "]"}], 
          RowBox[{"tensor", "[", "b", "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "ansatzPartialExp", "]"}]}], "}"}]}], "]"}], 
     ",", "aa"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725643949157975*^9, 3.725644060031088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"answer", "=", 
   RowBox[{
    RowBox[{"b2b2", "[", "8", "]"}], "[", 
    RowBox[{"symbol", "[", "8", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725644885883071*^9, 3.725644896030779*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zero", "=", 
   RowBox[{"answer", "-", "ansatzPartialExp"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725644898255939*^9, 3.7256449106571302`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"genEqs", "[", "zero", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725644914780369*^9, 3.72564492740703*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqsRed", "=", 
   RowBox[{"eqs", "/.", 
    RowBox[{
     RowBox[{"p", "[", "a_", "]"}], "\[RuleDelayed]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"a", ">", "10000"}], ",", "0", ",", 
       RowBox[{"p", "[", "a", "]"}]}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7256453048061657`*^9, 3.725645334449486*^9}, {
  3.7256453647848043`*^9, 3.725645391793949*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{
    RowBox[{"sortMinus", "[", "eqs", "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "10"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725645517389513*^9, 3.725645519320075*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{"Thread", "[", 
   RowBox[{"tmp", "\[Equal]", "0"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.725645430572357*^9, 3.725645461108644*^9}, {
  3.725645524795476*^9, 3.725645525001437*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.725645445292494*^9, 3.725645450628536*^9}, 
   3.725645512936819*^9, 3.725645568811994*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqsRed", "[", 
  RowBox[{"[", "2189", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7256455677334337`*^9, 3.725645606224576*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{"p", "[", "74", "]"}], "2"], "-", 
  FractionBox[
   RowBox[{"p", "[", "75", "]"}], "2"], "+", 
  FractionBox[
   RowBox[{"p", "[", "179", "]"}], "2"], "-", 
  FractionBox[
   RowBox[{"p", "[", "679", "]"}], "2"], "+", 
  FractionBox[
   RowBox[{"p", "[", "830", "]"}], "2"], "+", 
  FractionBox[
   RowBox[{"p", "[", "1778", "]"}], "2"], "-", 
  FractionBox[
   RowBox[{"p", "[", "2029", "]"}], "2"], "-", 
  FractionBox[
   RowBox[{"p", "[", "2352", "]"}], "2"]}]], "Output",
 CellChangeTimes->{3.7256456066925573`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "[", 
  RowBox[{"[", "3311", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7256457289921017`*^9, 3.725645731337386*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "2800000", "]"}]}], "+", 
  RowBox[{
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "4800000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "32", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "33", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "593", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "751", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1118", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1123", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1748", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1749", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1753", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2113", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2170", "]"}], " ", 
   RowBox[{"p", "[", "5000000", "]"}]}], "+", 
  RowBox[{
   RowBox[{"p", "[", "2170", "]"}], " ", 
   RowBox[{"p", "[", "5200000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "32", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "33", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "593", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "751", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1118", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1123", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1748", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1749", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1753", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2113", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2170", "]"}], " ", 
   RowBox[{"p", "[", "5300000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "32", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "33", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "593", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "751", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "-", 
  RowBox[{
   FractionBox["3", "2"], " ", 
   RowBox[{"p", "[", "1118", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1123", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1748", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1749", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1753", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2113", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2170", "]"}], " ", 
   RowBox[{"p", "[", "5400000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "32", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "33", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "593", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "751", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1118", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1123", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1748", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1749", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1753", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2113", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2170", "]"}], " ", 
   RowBox[{"p", "[", "5700000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "32", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "33", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "593", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "751", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1118", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1123", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1748", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1749", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1753", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2113", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2170", "]"}], " ", 
   RowBox[{"p", "[", "6000000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "32", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "33", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "593", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "751", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1118", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1123", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1748", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1749", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1753", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "1763", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2113", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"p", "[", "2170", "]"}], " ", 
   RowBox[{"p", "[", "6100000", "]"}]}]}]], "Output",
 CellChangeTimes->{3.725645731736498*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "===", "1"}], ")"}], "&"}], "/@", "eqsRed"}], ",", 
   "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.7256454055173073`*^9, 3.725645421901803*^9}, {
  3.7256455855803947`*^9, 3.72564572604478*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "3311", "}"}], ",", 
   RowBox[{"{", "3738", "}"}], ",", 
   RowBox[{"{", "3741", "}"}], ",", 
   RowBox[{"{", "3834", "}"}], ",", 
   RowBox[{"{", "3837", "}"}], ",", 
   RowBox[{"{", "3864", "}"}], ",", 
   RowBox[{"{", "5090", "}"}], ",", 
   RowBox[{"{", "5091", "}"}], ",", 
   RowBox[{"{", "5194", "}"}], ",", 
   RowBox[{"{", "5195", "}"}], ",", 
   RowBox[{"{", "5213", "}"}], ",", 
   RowBox[{"{", "5216", "}"}], ",", 
   RowBox[{"{", "5220", "}"}], ",", 
   RowBox[{"{", "5496", "}"}], ",", 
   RowBox[{"{", "5497", "}"}], ",", 
   RowBox[{"{", "6141", "}"}], ",", 
   RowBox[{"{", "6425", "}"}], ",", 
   RowBox[{"{", "6433", "}"}], ",", 
   RowBox[{"{", "6436", "}"}], ",", 
   RowBox[{"{", "6439", "}"}], ",", 
   RowBox[{"{", "6456", "}"}], ",", 
   RowBox[{"{", "6808", "}"}], ",", 
   RowBox[{"{", "6822", "}"}], ",", 
   RowBox[{"{", "6975", "}"}], ",", 
   RowBox[{"{", "6979", "}"}], ",", 
   RowBox[{"{", "7012", "}"}], ",", 
   RowBox[{"{", "7013", "}"}], ",", 
   RowBox[{"{", "7121", "}"}], ",", 
   RowBox[{"{", "7144", "}"}], ",", 
   RowBox[{"{", "7145", "}"}], ",", 
   RowBox[{"{", "7167", "}"}], ",", 
   RowBox[{"{", "7182", "}"}], ",", 
   RowBox[{"{", "7216", "}"}], ",", 
   RowBox[{"{", "7220", "}"}], ",", 
   RowBox[{"{", "7401", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.72564541105686*^9, 3.725645423649876*^9}, 
   3.725645599939782*^9, {3.725645633007106*^9, 3.725645726524509*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["find subgroups of length 3 with A3 structure", "Section",
 CellChangeTimes->{{3.725614394547407*^9, 3.7256144021844254`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zeroCount", "=", 
  RowBox[{"Count", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"pb", "[", 
      RowBox[{"a3", "[", "]"}], "]"}], "@@@", 
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"a3Seed", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7245909747816257`*^9, 3.7245910106443987`*^9}, {
  3.725614427588594*^9, 3.725614438871868*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.724590977962226*^9, 3.724591011282823*^9}, 
   3.725371061524688*^9, 3.725614440879023*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"tripsGoodZeroCount", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"trips", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"pb8", "/@", 
          RowBox[{"Subsets", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "0"}], "]"}], "\[Equal]",
        "zeroCount"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724590407772255*^9, 3.7245904341217117`*^9}, {
  3.724591020902022*^9, 3.7245910299019623`*^9}, {3.72561445030232*^9, 
  3.725614459481801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "tripsGoodZeroCount", "]"}]], "Input",
 CellChangeTimes->{{3.7240835137594547`*^9, 3.724083521426179*^9}, {
  3.724591034904099*^9, 3.724591038217979*^9}, {3.725614469068842*^9, 
  3.725614469472184*^9}}],

Cell[BoxData["51328"], "Output",
 CellChangeTimes->{
  3.7240838844249163`*^9, 3.7241638897219*^9, {3.724590427348592*^9, 
   3.724590447771859*^9}, 3.724591052505522*^9, 3.725371083627676*^9, {
   3.725614464569256*^9, 3.725614469811102*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"correctQuiverStructure", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Sort", "/@", 
     RowBox[{"(", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"pb", "[", 
            RowBox[{"a3", "[", "]"}], "]"}], "[", 
           RowBox[{
            RowBox[{"a3Seed", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "ii"}], "]"}], "]"}], ",", "#"}], "]"}], 
          "&"}], "/@", 
         RowBox[{"a3Seed", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"ii", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"a3Seed", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ")"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724591071600605*^9, 3.7245911035686502`*^9}, {
  3.725614496540792*^9, 3.725614505383334*^9}}],

Cell[CellGroupData[{

Cell[BoxData["correctQuiverStructure"], "Input",
 CellChangeTimes->{{3.72537307258928*^9, 3.72537307662433*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.725373077642124*^9, 3.725614507710574*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"findA3s", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tmp", "=", 
           RowBox[{"tripsGoodZeroCount", "[", 
            RowBox[{"[", "xx", "]"}], "]"}]}], "}"}], ",", 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{"Sort", "/@", 
            RowBox[{"(", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"pb8", "[", 
                  RowBox[{
                   RowBox[{"tmp", "[", 
                    RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                 "/@", "tmp"}], ",", 
               RowBox[{"{", 
                RowBox[{"ii", ",", 
                 RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}], 
             ")"}]}], "]"}], "\[Equal]", "correctQuiverStructure"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"xx", ",", 
         RowBox[{"Length", "[", "tripsGoodZeroCount", "]"}]}], "}"}]}], "]"}],
      ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"xx", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "tripsGoodZeroCount", "]"}]}], "}"}]}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72408563326723*^9, 3.7240856586470633`*^9}, {
  3.724085761226063*^9, 3.724085836839715*^9}, {3.7240858686892567`*^9, 
  3.724085871433628*^9}, {3.724085911407633*^9, 3.7240859471812468`*^9}, {
  3.724155523790444*^9, 3.7241555245331078`*^9}, {3.724169929090067*^9, 
  3.7241699337233047`*^9}, {3.7245904692998753`*^9, 3.7245905031652403`*^9}, {
  3.724591266294065*^9, 3.72459128004362*^9}, {3.7256145121553993`*^9, 
  3.725614525671916*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a3stmp1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"tripsGoodZeroCount", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Position", "[", 
      RowBox[{"findA3s", ",", "True"}], "]"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.724086317622675*^9, 3.7240863527493134`*^9}, {
  3.724591293528088*^9, 3.724591304894121*^9}, {3.7256145322034082`*^9, 
  3.7256145412477903`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "a3stmp1", "]"}]], "Input",
 CellChangeTimes->{{3.724590507093107*^9, 3.724590532392852*^9}, {
  3.724591311121194*^9, 3.7245913117661667`*^9}, {3.725614545085094*^9, 
  3.7256145459509563`*^9}}],

Cell[BoxData["22112"], "Output",
 CellChangeTimes->{{3.724590516910419*^9, 3.724590533243705*^9}, 
   3.7245907180902987`*^9, 3.7245913122754517`*^9, 3.725371095253477*^9, 
   3.72561454646563*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rotateA3", "[", "clus_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"brackets", ",", "node"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"brackets", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"pb8", "[", 
             RowBox[{
              RowBox[{"clus", "[", 
               RowBox[{"[", "ii", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
            "clus"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "1", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "2", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "1"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"node", "[", "3", "]"}], "=", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"brackets", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"node", "/@", 
        RowBox[{"Range", "[", "3", "]"}]}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.724152985295802*^9, 3.724153026816073*^9}, {
   3.724153067443027*^9, 3.724153096477889*^9}, {3.724153190327096*^9, 
   3.72415320354953*^9}, {3.7241532493235407`*^9, 3.7241532515279713`*^9}, {
   3.724155345814637*^9, 3.7241553845265303`*^9}, {3.72417027130831*^9, 
   3.724170272161825*^9}, {3.724170422633583*^9, 3.7241704580936317`*^9}, {
   3.724170549299922*^9, 3.7241705494212112`*^9}, {3.7245907307933817`*^9, 
   3.724590743811893*^9}, {3.72459148481706*^9, 3.7245914904564*^9}, {
   3.724591551158687*^9, 3.7245916353721857`*^9}, 3.725371282751771*^9, {
   3.725373363923792*^9, 3.725373367041007*^9}, {3.725614571997755*^9, 
   3.725614603564447*^9}, {3.725614633872696*^9, 3.725614634332098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rotatedA3s", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"rotateA3", "[", 
        RowBox[{"a3stmp1", "[", 
         RowBox[{"[", "aa", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "a3stmp1", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"aa", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "a3stmp1", "]"}]}], "}"}]}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.724171050996361*^9, 3.724171118925921*^9}, {
  3.724171160903644*^9, 3.724171164445331*^9}, {3.724590756251926*^9, 
  3.72459077103897*^9}, {3.7245916596120663`*^9, 3.7245916737564163`*^9}, {
  3.7256146094472513`*^9, 3.7256146245329227`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"posGoods", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Union", "[", "#", "]"}], "]"}], "&"}], "/@", "rotatedA3s"}],
       ",", "3"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7241721730061197`*^9, 3.7241721786727533`*^9}, {
  3.7241731168032618`*^9, 3.7241731258235197`*^9}, {3.72417318753199*^9, 
  3.7241731898930073`*^9}, {3.724591686878304*^9, 3.724591694379694*^9}, {
  3.725614640194923*^9, 3.725614645076962*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a3stmp2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"rotatedA3s", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posGoods"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7241731330821857`*^9, 3.724173151250458*^9}, {
  3.724591705780758*^9, 3.724591709635092*^9}, {3.725614647158222*^9, 
  3.725614650994527*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"exactBmatrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"pb", "[", 
       RowBox[{"a3", "[", "]"}], "]"}], "[", 
      RowBox[{
       RowBox[{"a3Seed", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"a3Seed", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "j"}], "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7253733907366247`*^9, 3.72537339771406*^9}, {
  3.725614670435944*^9, 3.7256146836314497`*^9}}],

Cell[BoxData["4"], "Input",
 CellChangeTimes->{3.725624576823884*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a3stmp3", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"a3stmp2", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"pb8", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[Equal]", 
       "exactBmatrix"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725371129090987*^9, 3.725371148348447*^9}, {
  3.725371181681925*^9, 3.7253712555554028`*^9}, {3.7253731650036907`*^9, 
  3.725373195425283*^9}, {3.725373403131193*^9, 3.725373459365802*^9}, {
  3.725373505185891*^9, 3.725373537893503*^9}, {3.725614688054268*^9, 
  3.725614697830739*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "a3stmp3", "]"}]], "Input",
 CellChangeTimes->{{3.725373540018618*^9, 3.725373543549431*^9}, {
  3.7256147022377167`*^9, 3.7256147026440783`*^9}}],

Cell[BoxData["22112"], "Output",
 CellChangeTimes->{3.725373543981205*^9, 3.725614703491808*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"a3s", "=", "a3stmp3"}], ";"}]], "Input",
 CellChangeTimes->{{3.72561479072233*^9, 3.725614798201981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a3Func", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", "x1", "]"}], ",", 
      RowBox[{"cb2", "[", "x3", "]"}]}], "]"}], "+", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       FractionBox["x2", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]], "]"}], ",", 
      RowBox[{"cb2", "[", 
       FractionBox[
        RowBox[{"x1", " ", "x2", " ", "x3"}], 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]], "]"}]}], "]"}], "-", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       RowBox[{"x1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x2", "+", 
          RowBox[{"x2", " ", "x3"}]}], ")"}]}], "]"}], ",", 
      RowBox[{"cb2", "[", 
       FractionBox["x3", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}]}]], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72562625141131*^9, 3.725626258632489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#1", ",", "#2"}], "}"}], "&"}], "@@", "#"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "f"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7256282251716957`*^9, 3.725628244957448*^9}, {
  3.725628295502524*^9, 3.725628301902824*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"c", ",", "d"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"e", ",", "f"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7256282353635197`*^9, 3.7256282468966303`*^9}, {
  3.725628297470295*^9, 3.7256283024115*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a3Squares", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["x2", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]], ",", 
       FractionBox[
        RowBox[{"x1", " ", "x2", " ", "x3"}], 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x2", "+", 
          RowBox[{"x2", " ", "x3"}]}], ")"}]}], ",", 
       FractionBox["x3", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}]}]]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725628327438286*^9, 3.725628332458877*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a3SquaresFull", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Sort", "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#1", ",", "#2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "#1"}], ",", "#2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "#1"}], ",", 
               RowBox[{"1", "/", "#2"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"#1", ",", 
               RowBox[{"1", "/", "#2"}]}], "}"}]}], "}"}], "&"}], "@@", "#"}],
          "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "x3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["x2", 
             RowBox[{"1", "+", "x1", "+", 
              RowBox[{"x1", " ", "x2"}]}]], ",", 
            FractionBox[
             RowBox[{"x1", " ", "x2", " ", "x3"}], 
             RowBox[{"1", "+", "x1", "+", 
              RowBox[{"x1", " ", "x2"}]}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "x2", "+", 
               RowBox[{"x2", " ", "x3"}]}], ")"}]}], ",", 
            FractionBox["x3", 
             RowBox[{"1", "+", "x2", "+", 
              RowBox[{"x2", " ", "x3"}]}]]}], "}"}]}], "}"}]}], ",", "1"}], 
      "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725626263543479*^9, 3.725626290086039*^9}, {
  3.725628117535019*^9, 3.725628214165614*^9}, {3.7256282511758213`*^9, 
  3.725628268323201*^9}, {3.725628305684417*^9, 3.725628322856565*^9}, {
  3.725628459043908*^9, 3.7256284718422203`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"clean8", "[", 
      RowBox[{
       RowBox[{"numRatios", "[", "8", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"allRatios", "[", "8", "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"numRatios", "[", "8", "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"clean8", "[", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"numRatios", "[", "8", "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"allRatios", "[", "8", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"numRatios", "[", "8", "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.725626332129253*^9, 3.72562637601993*^9}, {
  3.725626437295609*^9, 3.725626448422358*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"clean8", "[", "x_", "]"}], ":=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.725626473134863*^9, 3.7256264820493*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allA3s", "=", 
   RowBox[{"a3Squares", "@@@", 
    RowBox[{
     RowBox[{"num", "[", "8", "]"}], "[", 
     RowBox[{"a3s", "/.", 
      RowBox[{
       RowBox[{"i_", "?", "IntegerQ"}], "\[RuleDelayed]", 
       RowBox[{"base", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725626565747184*^9, 3.725626617890922*^9}, {
  3.725626688922804*^9, 3.725626697046294*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"allA3sClean", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"clean8", "/@", 
      RowBox[{"allA3s", "[", 
       RowBox[{"[", "aa", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", 
       RowBox[{"Length", "[", "allA3s", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72562662308654*^9, 3.725626674498638*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodPos", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Position", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "allA3sClean"}], ",", 
      "0"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725626675693602*^9, 3.72562667810854*^9}, {
  3.725626754288992*^9, 3.725626795865943*^9}, {3.725626836773164*^9, 
  3.7256268398415737`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodA3s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"a3s", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "goodPos"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725626851856368*^9, 3.725626863541995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"numA3s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"numBase", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
    "goodA3s"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725638565130249*^9, 3.725638599310183*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a3Check", "[", 
      RowBox[{"numA3s", "[", 
       RowBox[{"[", "aa", "]"}], "]"}], "]"}], "=", "True"}], ",", 
    RowBox[{"{", 
     RowBox[{"aa", ",", 
      RowBox[{"Length", "[", "numA3s", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a3Check", "[", 
      RowBox[{"1", "/", 
       RowBox[{"Reverse", "[", 
        RowBox[{"numA3s", "[", 
         RowBox[{"[", "aa", "]"}], "]"}], "]"}]}], "]"}], "=", "True"}], ",", 
    
    RowBox[{"{", 
     RowBox[{"aa", ",", 
      RowBox[{"Length", "[", "numA3s", "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.725638608359864*^9, 3.725638648392087*^9}, {
  3.725638785538463*^9, 3.725638793241769*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Sort", "[", 
   RowBox[{"(", 
    RowBox[{"a3Xs", "@@", 
     RowBox[{"(", 
      RowBox[{"1", "/", 
       RowBox[{"Reverse", "[", 
        RowBox[{"numA3s", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], ")"}], "]"}], 
  "\[Equal]", 
  RowBox[{"Sort", "[", 
   RowBox[{"(", 
    RowBox[{"a3Xs", "@@", 
     RowBox[{"numA3s", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7256386806673927`*^9, 3.725638760321424*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.725638685354629*^9, 3.725638760765009*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{"numA3s", ",", 
   RowBox[{"1", "/", 
    RowBox[{"Reverse", "[", 
     RowBox[{"numA3s", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7256386878251247`*^9, 3.725638708753367*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7256387091758966`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodA3sNumFull", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"a3SquaresFull", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"numBase", "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
        RowBox[{"goodA3s", "[", 
         RowBox[{"[", "aa", "]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", 
       RowBox[{"Length", "[", "goodA3s", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725628603758757*^9, 3.725628616229924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodA3sReduced", "=", 
   RowBox[{"Union", "[", "goodA3sNumFull", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.725628110040587*^9, {3.725628339251218*^9, 3.7256283759323673`*^9}, {
   3.7256284352960777`*^9, 3.7256284373171663`*^9}, {3.725628489511764*^9, 
   3.7256284910065613`*^9}, 3.725628622813816*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a3sWork", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"goodA3s", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"goodA3sNumFull", ",", 
          RowBox[{"goodA3sReduced", "[", 
           RowBox[{"[", "iii", "]"}], "]"}]}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"iii", ",", 
       RowBox[{"Length", "[", "goodA3sReduced", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725628584198151*^9, 3.725628595986239*^9}, {
  3.72562862618841*^9, 3.725628688929564*^9}}],

Cell["fit to R28", "Text",
 CellChangeTimes->{{3.725628844875917*^9, 3.725628848727036*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", "aaa", "]"}], 
       RowBox[{"(", 
        RowBox[{"a3Func", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"numBase", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
           RowBox[{"a3sWork", "[", 
            RowBox[{"[", "aaa", "]"}], "]"}]}], ")"}]}], ")"}]}], "/.", 
      RowBox[{
       RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
       RowBox[{"cb2", "[", 
        RowBox[{"clean8", "[", "a", "]"}], "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"aaa", ",", 
       RowBox[{"Length", "[", "a3sWork", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72562869054277*^9, 3.725628692569036*^9}, {
  3.725628739292921*^9, 3.725628852382419*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"b2b2", "[", "8", "]"}], "[", 
        RowBox[{
         RowBox[{
          RowBox[{"p", "[", "aaa", "]"}], 
          RowBox[{"(", 
           RowBox[{"a3Func", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"numBase", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"a3sWork", "[", 
               RowBox[{"[", "aaa", "]"}], "]"}]}], ")"}]}], ")"}]}], "/.", 
         RowBox[{
          RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
          RowBox[{"cb2", "[", 
           RowBox[{"clean8", "[", "a", "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aaa", ",", 
         RowBox[{"Length", "[", "a3sWork", "]"}]}], "}"}]}], "]"}], ",", 
     "aaa"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725629072647973*^9, 3.725629101047537*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"answer", "=", 
   RowBox[{
    RowBox[{"b2b2", "[", "8", "]"}], "[", 
    RowBox[{"symbol", "[", "8", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725629348590317*^9, 3.7256293545858727`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soln", "=", 
   RowBox[{"fit", "[", 
    RowBox[{"answer", "-", "ansatzExp"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7256293560830803`*^9, 3.725629365693534*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", "/@", 
        RowBox[{"Range", "[", "1600", "]"}]}], ")"}], "//.", "soln"}], ")"}], 
    "//.", 
    RowBox[{
     RowBox[{"p", "[", "_", "]"}], "\[RuleDelayed]", "0"}]}], ",", "0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.725629463126049*^9, 3.7256294920794163`*^9}}],

Cell[BoxData["1377"], "Output",
 CellChangeTimes->{{3.725629484779647*^9, 3.7256294965670137`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"1600", "-", "1377"}]], "Input",
 CellChangeTimes->{{3.72562950019145*^9, 3.725629503345433*^9}}],

Cell[BoxData["223"], "Output",
 CellChangeTimes->{3.725629503690473*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["how to check wedge cancellation numerically -- an idea", "Section",
 CellChangeTimes->{{3.725638206949645*^9, 3.7256382094134483`*^9}, {
  3.725638454302389*^9, 3.72563846080912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"factorInt", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"factorInt", "[", "x", "]"}], "=", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FactorInteger", "[", "x", "]"}], "/.", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a_", "?", "IntegerQ"}], ",", 
           RowBox[{"b_", "?", "IntegerQ"}]}], "}"}], "\[RuleDelayed]", 
         SuperscriptBox[
          RowBox[{"br", "[", "a", "]"}], "b"]}]}], ")"}]}], "/.", 
     RowBox[{
      RowBox[{"br", "[", 
       RowBox[{"-", "1"}], "]"}], "\[RuleDelayed]", "1"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7256379577805777`*^9, 3.725638008596513*^9}, {
  3.725638090701996*^9, 3.725638097096702*^9}, {3.7256381583644657`*^9, 
  3.7256381629330053`*^9}, {3.725641329512689*^9, 3.725641332282168*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tensorExpand", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"b2b2", "[", "6", "]"}], "[", 
      RowBox[{
       RowBox[{"wedge", "[", 
        RowBox[{
         RowBox[{"cb2", "[", "y", "]"}], ",", 
         RowBox[{"cb2", "[", 
          RowBox[{"1", "/", "x1"}], "]"}]}], "]"}], "+", 
       RowBox[{"wedge", "[", 
        RowBox[{
         RowBox[{"cb2", "[", "y", "]"}], ",", 
         RowBox[{"cb2", "[", "x2", "]"}]}], "]"}], "+", 
       RowBox[{"wedge", "[", 
        RowBox[{
         RowBox[{"cb2", "[", "y", "]"}], ",", 
         RowBox[{"cb2", "[", 
          RowBox[{"x1", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x2"}], ")"}]}], "]"}]}], "]"}], "+", 
       RowBox[{"wedge", "[", 
        RowBox[{
         RowBox[{"cb2", "[", "y", "]"}], ",", 
         RowBox[{"cb2", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "x1", "+", 
             RowBox[{"x1", " ", "x2"}]}], ")"}], "/", "x2"}], "]"}]}], "]"}], 
       "+", 
       RowBox[{"wedge", "[", 
        RowBox[{
         RowBox[{"cb2", "[", "y", "]"}], ",", 
         RowBox[{"cb2", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "x1"}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"x1", " ", "x2"}], ")"}]}], "]"}]}], "]"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "\[Rule]", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], "]"}]}], ",", 
       RowBox[{"x2", "\[Rule]", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "10"}], "}"}], "]"}]}]}], "}"}]}], ")"}], "//.", 
   RowBox[{
    RowBox[{"tensor", "[", 
     RowBox[{"x___", ",", 
      RowBox[{"y_", "?", "IntegerQ"}], ",", "z___"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"tensor", "[", 
     RowBox[{"x", ",", 
      RowBox[{"factorInt", "[", "y", "]"}], ",", "z"}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.725637793665416*^9, 3.7256379444510307`*^9}, {
  3.725638016004406*^9, 3.725638068718927*^9}, {3.7256380998448277`*^9, 
  3.725638118921855*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.72563787888513*^9, 3.725637883080793*^9}, {
   3.725637914028063*^9, 3.725637944919158*^9}, {3.725638062470811*^9, 
   3.725638069183782*^9}, {3.725638106665615*^9, 3.7256381193268137`*^9}, 
   3.7256381643150806`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 1002},
WindowMargins->{{147, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 709, 9, 183, "Title"],
Cell[1292, 33, 368, 9, 66, "Input"],
Cell[1663, 44, 143, 3, 39, "Input"],
Cell[1809, 49, 531, 15, 66, "Input"],
Cell[2343, 66, 174, 4, 39, "Input"],
Cell[2520, 72, 278, 8, 39, "Input"],
Cell[2801, 82, 1119, 31, 66, "Input"],
Cell[CellGroupData[{
Cell[3945, 117, 117, 1, 80, "Section"],
Cell[4065, 120, 1929, 50, 248, "Input"],
Cell[CellGroupData[{
Cell[6019, 174, 174, 3, 39, "Input"],
Cell[6196, 179, 175, 3, 39, "Output"]
}, Open  ]],
Cell[6386, 185, 1705, 43, 248, "Input"],
Cell[CellGroupData[{
Cell[8116, 232, 223, 4, 39, "Input"],
Cell[8342, 238, 199, 3, 39, "Output"]
}, Open  ]],
Cell[8556, 244, 1760, 46, 248, "Input"],
Cell[CellGroupData[{
Cell[10341, 294, 128, 2, 39, "Input"],
Cell[10472, 298, 123, 2, 39, "Output"]
}, Open  ]],
Cell[10610, 303, 1997, 50, 248, "Input"],
Cell[CellGroupData[{
Cell[12632, 357, 124, 2, 39, "Input"],
Cell[12759, 361, 121, 2, 39, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[12929, 369, 129, 1, 62, "Section"],
Cell[13061, 372, 483, 14, 60, "Input"],
Cell[CellGroupData[{
Cell[13569, 390, 143, 2, 60, "Input"],
Cell[13715, 394, 150, 3, 60, "Output"]
}, Open  ]],
Cell[13880, 400, 805, 22, 60, "Input"],
Cell[14688, 424, 1743, 45, 225, "Input"],
Cell[16434, 471, 370, 10, 60, "Input"],
Cell[CellGroupData[{
Cell[16829, 485, 131, 2, 60, "Input"],
Cell[16963, 489, 126, 2, 60, "Output"]
}, Open  ]],
Cell[17104, 494, 4369, 120, 387, "Input"],
Cell[21476, 616, 757, 21, 102, "Input"],
Cell[22236, 639, 490, 13, 60, "Input"],
Cell[22729, 654, 263, 8, 60, "Input"],
Cell[CellGroupData[{
Cell[23017, 666, 129, 2, 60, "Input"],
Cell[23149, 670, 92, 1, 60, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[23290, 677, 131, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[23446, 682, 389, 11, 39, "Input"],
Cell[23838, 695, 142, 2, 39, "Output"]
}, Open  ]],
Cell[23995, 700, 537, 15, 39, "Input"],
Cell[CellGroupData[{
Cell[24557, 719, 194, 3, 39, "Input"],
Cell[24754, 724, 220, 4, 39, "Output"]
}, Open  ]],
Cell[24989, 731, 878, 26, 66, "Input"],
Cell[CellGroupData[{
Cell[25892, 761, 112, 1, 39, "Input"],
Cell[26007, 764, 651, 18, 39, "Output"]
}, Open  ]],
Cell[26673, 785, 1798, 46, 144, "Input"],
Cell[28474, 833, 421, 11, 39, "Input"],
Cell[CellGroupData[{
Cell[28920, 848, 182, 3, 39, "Input"],
Cell[29105, 853, 221, 3, 39, "Output"]
}, Open  ]],
Cell[29341, 859, 3900, 104, 222, "Input"],
Cell[33244, 965, 807, 21, 66, "Input"],
Cell[34054, 988, 536, 13, 39, "Input"],
Cell[34593, 1003, 312, 9, 39, "Input"],
Cell[34908, 1014, 633, 19, 39, "Input"],
Cell[35544, 1035, 881, 23, 39, "Input"],
Cell[CellGroupData[{
Cell[36450, 1062, 181, 3, 39, "Input"],
Cell[36634, 1067, 123, 2, 39, "Output"]
}, Open  ]],
Cell[36772, 1072, 790, 22, 39, "Input"],
Cell[37565, 1096, 182, 4, 39, "Input"],
Cell[CellGroupData[{
Cell[37772, 1104, 136, 2, 39, "Input"],
Cell[37911, 1108, 73, 1, 39, "Output"]
}, Open  ]],
Cell[37999, 1112, 135, 1, 37, "Text"],
Cell[38137, 1115, 143, 3, 39, "Input"],
Cell[CellGroupData[{
Cell[38305, 1122, 299, 8, 39, "Input"],
Cell[38607, 1132, 504, 10, 95, "Output"]
}, Open  ]],
Cell[39126, 1145, 196, 4, 39, "Input"],
Cell[CellGroupData[{
Cell[39347, 1153, 127, 2, 39, "Input"],
Cell[39477, 1157, 72, 1, 39, "Output"]
}, Open  ]],
Cell[39564, 1161, 1158, 31, 92, "Input"],
Cell[CellGroupData[{
Cell[40747, 1196, 1845, 48, 118, "Input"],
Cell[42595, 1246, 262, 5, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42894, 1256, 261, 7, 39, "Input"],
Cell[43158, 1265, 2646, 37, 274, "Output"]
}, Open  ]],
Cell[45819, 1305, 1574, 43, 144, "Input"],
Cell[47396, 1350, 620, 18, 39, "Input"],
Cell[CellGroupData[{
Cell[48041, 1372, 137, 2, 39, "Input"],
Cell[48181, 1376, 72, 1, 39, "Output"]
}, Open  ]],
Cell[48268, 1380, 879, 24, 92, "Input"],
Cell[49150, 1406, 769, 21, 92, "Input"],
Cell[49922, 1429, 235, 6, 39, "Input"],
Cell[50160, 1437, 182, 4, 39, "Input"],
Cell[50345, 1443, 171, 4, 39, "Input"],
Cell[50519, 1449, 422, 11, 39, "Input"],
Cell[50944, 1462, 257, 7, 39, "Input"],
Cell[CellGroupData[{
Cell[51226, 1473, 239, 5, 39, "Input"],
Cell[51468, 1480, 149, 2, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51654, 1487, 153, 3, 39, "Input"],
Cell[51810, 1492, 581, 18, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52428, 1515, 150, 3, 39, "Input"],
Cell[52581, 1520, 9850, 299, 612, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62468, 1824, 314, 9, 39, "Input"],
Cell[62785, 1835, 1485, 39, 92, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64319, 1880, 131, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[64475, 1885, 478, 13, 39, "Input"],
Cell[64956, 1900, 142, 2, 39, "Output"]
}, Open  ]],
Cell[65113, 1905, 591, 16, 39, "Input"],
Cell[CellGroupData[{
Cell[65729, 1925, 242, 4, 39, "Input"],
Cell[65974, 1931, 243, 4, 39, "Output"]
}, Open  ]],
Cell[66232, 1938, 927, 27, 66, "Input"],
Cell[CellGroupData[{
Cell[67184, 1969, 112, 1, 39, "Input"],
Cell[67299, 1972, 366, 11, 39, "Output"]
}, Open  ]],
Cell[67680, 1986, 1845, 47, 144, "Input"],
Cell[69528, 2035, 473, 12, 39, "Input"],
Cell[CellGroupData[{
Cell[70026, 2051, 233, 4, 39, "Input"],
Cell[70262, 2057, 197, 3, 39, "Output"]
}, Open  ]],
Cell[70474, 2063, 2918, 74, 170, "Input"],
Cell[73395, 2139, 860, 22, 66, "Input"],
Cell[74258, 2163, 585, 14, 39, "Input"],
Cell[74846, 2179, 361, 10, 39, "Input"],
Cell[75210, 2191, 684, 20, 39, "Input"],
Cell[75897, 2213, 69, 1, 39, "Input"],
Cell[75969, 2216, 930, 24, 39, "Input"],
Cell[CellGroupData[{
Cell[76924, 2244, 184, 3, 39, "Input"],
Cell[77111, 2249, 96, 1, 39, "Output"]
}, Open  ]],
Cell[77222, 2253, 140, 3, 39, "Input"],
Cell[77365, 2258, 1098, 32, 107, "Input"],
Cell[CellGroupData[{
Cell[78488, 2294, 495, 16, 39, "Input"],
Cell[78986, 2312, 347, 10, 39, "Output"]
}, Open  ]],
Cell[79348, 2325, 902, 27, 59, "Input"],
Cell[80253, 2354, 1978, 54, 157, "Input"],
Cell[82234, 2410, 1150, 36, 66, "Input"],
Cell[83387, 2448, 167, 4, 39, "Input"],
Cell[83557, 2454, 454, 12, 39, "Input"],
Cell[84014, 2468, 398, 12, 39, "Input"],
Cell[84415, 2482, 472, 13, 39, "Input"],
Cell[84890, 2497, 253, 8, 39, "Input"],
Cell[85146, 2507, 311, 10, 39, "Input"],
Cell[85460, 2519, 849, 27, 66, "Input"],
Cell[CellGroupData[{
Cell[86334, 2550, 519, 16, 39, "Input"],
Cell[86856, 2568, 97, 1, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86990, 2574, 280, 7, 39, "Input"],
Cell[87273, 2583, 89, 2, 39, "Output"]
}, Open  ]],
Cell[87377, 2588, 567, 17, 39, "Input"],
Cell[87947, 2607, 347, 7, 39, "Input"],
Cell[88297, 2616, 677, 19, 39, "Input"],
Cell[88977, 2637, 92, 1, 37, "Text"],
Cell[89072, 2640, 886, 26, 39, "Input"],
Cell[89961, 2668, 1034, 29, 66, "Input"],
Cell[90998, 2699, 237, 6, 39, "Input"],
Cell[91238, 2707, 207, 5, 39, "Input"],
Cell[CellGroupData[{
Cell[91470, 2716, 405, 13, 39, "Input"],
Cell[91878, 2731, 99, 1, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92014, 2737, 120, 2, 39, "Input"],
Cell[92137, 2741, 72, 1, 39, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[92258, 2748, 189, 2, 62, "Section"],
Cell[92450, 2752, 892, 24, 43, "Input"],
Cell[CellGroupData[{
Cell[93367, 2780, 2175, 62, 144, "Input"],
Cell[95545, 2844, 269, 4, 39, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

