(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64652,       1945]
NotebookOptionsPosition[     61121,       1827]
NotebookOutlinePosition[     61500,       1844]
CellTagsIndexPosition[     61457,       1841]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["R28 paper calculations", "Title",
 CellChangeTimes->{{3.7155216343483543`*^9, 3.715521661935596*^9}, {
   3.7155217024191933`*^9, 3.715521776747312*^9}, {3.715697106466093*^9, 
   3.715697132670868*^9}, 3.717339565784286*^9, {3.717596412665661*^9, 
   3.7175964295471077`*^9}, 3.7190772318918056`*^9, {3.719161602248806*^9, 
   3.719161617724811*^9}, 3.7191622907219543`*^9, {3.719330906137623*^9, 
   3.719330919779743*^9}, 3.7214675803034782`*^9, {3.722256568008562*^9, 
   3.722256584333577*^9}, {3.7222587062837543`*^9, 3.7222587099149513`*^9}, 
   3.723892693455821*^9, {3.723910170409132*^9, 3.723910179723064*^9}, {
   3.7247613005595207`*^9, 3.724761305849478*^9}, {3.7251093997280607`*^9, 
   3.725109422520021*^9}, {3.725109486952263*^9, 3.725109487141718*^9}, {
   3.7253796263545513`*^9, 3.725379627752042*^9}, {3.7262081679226522`*^9, 
   3.726208187405767*^9}, {3.7262310495952473`*^9, 3.726231058788488*^9}, {
   3.727099108843804*^9, 3.727099123185153*^9}, {3.727512928109139*^9, 
   3.727512933417872*^9}, {3.72821639588512*^9, 3.728216402599391*^9}, {
   3.728300715791695*^9, 3.728300727366877*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "tools.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.713271961760497*^9, 3.7132719819312153`*^9}, {
  3.713272319095078*^9, 3.713272323693686*^9}, {3.7132801678394003`*^9, 
  3.7132801680639467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<a2SubFuncs.dat\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.7283185933500347`*^9, 3.7283186231599913`*^9}}],

Cell[CellGroupData[{

Cell["defs", "Section",
 CellChangeTimes->{{3.7283191082457447`*^9, 3.728319108536017*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a2Func", "[", 
    RowBox[{"x1_", ",", "x2_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", "x2", "]"}], ",", 
      RowBox[{"cb2", "[", "x1", "]"}]}], "]"}], "+", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       FractionBox[
        RowBox[{"x1", " ", "x2"}], 
        RowBox[{"1", "+", "x1"}]], "]"}], ",", 
      RowBox[{"cb2", "[", "x1", "]"}]}], "]"}], "-", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       FractionBox[
        RowBox[{"x1", " ", "x2"}], 
        RowBox[{"1", "+", "x1"}]], "]"}], ",", 
      RowBox[{"cb2", "[", "x2", "]"}]}], "]"}], "+", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       RowBox[{"x1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x2"}], ")"}]}], "]"}], ",", 
      RowBox[{"cb2", "[", "x1", "]"}]}], "]"}], "-", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       RowBox[{"x1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x2"}], ")"}]}], "]"}], ",", 
      RowBox[{"cb2", "[", "x2", "]"}]}], "]"}], "+", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       RowBox[{"x1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x2"}], ")"}]}], "]"}], ",", 
      RowBox[{"cb2", "[", 
       FractionBox[
        RowBox[{"x1", " ", "x2"}], 
        RowBox[{"1", "+", "x1"}]], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.715938534197373*^9, 3.715938545964035*^9}, 
   3.7159451171088142`*^9, {3.715948055564451*^9, 3.715948055623437*^9}, {
   3.7159483350499983`*^9, 3.715948339388291*^9}, 3.727515567579928*^9, 
   3.7283191185282793`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Describe A5", "Section",
 CellChangeTimes->{{3.728300753524189*^9, 3.728300757482068*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5Letters", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "x1", "+", 
      RowBox[{"x1", " ", "x2"}]}], ",", 
     RowBox[{"1", "+", "x2", "+", 
      RowBox[{"x2", " ", "x3"}]}], ",", 
     RowBox[{"1", "+", "x1", "+", 
      RowBox[{"x1", " ", "x2"}], "+", 
      RowBox[{"x1", " ", "x2", " ", "x3"}]}], ",", 
     RowBox[{"1", "+", "x3", "+", 
      RowBox[{"x3", " ", "x4"}]}], ",", 
     RowBox[{"1", "+", "x2", "+", 
      RowBox[{"x2", " ", "x3"}], "+", 
      RowBox[{"x2", " ", "x3", " ", "x4"}]}], ",", 
     RowBox[{"1", "+", "x1", "+", 
      RowBox[{"x1", " ", "x2"}], "+", 
      RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
      RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}]}], ",", 
     RowBox[{"1", "+", "x4", "+", 
      RowBox[{"x4", " ", "x5"}]}], ",", 
     RowBox[{"1", "+", "x3", "+", 
      RowBox[{"x3", " ", "x4"}], "+", 
      RowBox[{"x3", " ", "x4", " ", "x5"}]}], ",", 
     RowBox[{"1", "+", "x2", "+", 
      RowBox[{"x2", " ", "x3"}], "+", 
      RowBox[{"x2", " ", "x3", " ", "x4"}], "+", 
      RowBox[{"x2", " ", "x3", " ", "x4", " ", "x5"}]}], ",", 
     RowBox[{"1", "+", "x1", "+", 
      RowBox[{"x1", " ", "x2"}], "+", 
      RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
      RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
      RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.72829643657787*^9, 3.72829643943563*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5LettersShort", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "+", "x12"}], ",", 
     RowBox[{"1", "+", "x23"}], ",", 
     RowBox[{"1", "+", "x123"}], ",", 
     RowBox[{"1", "+", "x34"}], ",", 
     RowBox[{"1", "+", "x234"}], ",", 
     RowBox[{"1", "+", "x1234"}], ",", 
     RowBox[{"1", "+", "x45"}], ",", 
     RowBox[{"1", "+", "x345"}], ",", 
     RowBox[{"1", "+", "x2345"}], ",", 
     RowBox[{"1", "+", "x12345"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728296446547937*^9, 3.72829645642203*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"fPrint", "[", 
      RowBox[{"a5Letters", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
     RowBox[{"a5LettersShort", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "10"}], "}"}]}], "]"}], ";", 
  RowBox[{
   RowBox[{"fPrint", "[", "a_", "]"}], ":=", "a"}], ";"}]], "Input",
 CellChangeTimes->{{3.728296427994474*^9, 3.728296430826558*^9}, {
   3.728296500478599*^9, 3.7282965274442053`*^9}, 3.7283007667486277`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"listGaurd", "[", "x_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "x", "]"}], "===", "Times"}], ",", 
     RowBox[{"List", "@@", "x"}], ",", 
     RowBox[{"{", "x", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728296684834722*^9, 3.72829676556608*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cleanify", "[", "tmp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"fPrint", "/@", 
          RowBox[{"(", 
           RowBox[{"listGaurd", "[", 
            RowBox[{"Numerator", "[", "tmp", "]"}], "]"}], ")"}]}], ")"}]}], 
       ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"fPrint", "/@", 
          RowBox[{"(", 
           RowBox[{"listGaurd", "[", 
            RowBox[{"Denominator", "[", "tmp", "]"}], "]"}], ")"}]}], ")"}]}],
        ")"}]}], ")"}], "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "\[Rule]", 
       SubscriptBox["x", "1"]}], ",", 
      RowBox[{"x2", "\[Rule]", 
       SubscriptBox["x", "2"]}], ",", 
      RowBox[{"x3", "\[Rule]", 
       SubscriptBox["x", "3"]}], ",", 
      RowBox[{"x4", "\[Rule]", 
       SubscriptBox["x", "4"]}], ",", 
      RowBox[{"x5", "\[Rule]", 
       SubscriptBox["x", "5"]}], ",", 
      RowBox[{"x12", "\[Rule]", 
       SubscriptBox["x", "12"]}], ",", 
      RowBox[{"x23", "\[Rule]", 
       SubscriptBox["x", "23"]}], ",", 
      RowBox[{"x34", "\[Rule]", 
       SubscriptBox["x", "34"]}], ",", 
      RowBox[{"x45", "\[Rule]", 
       SubscriptBox["x", "45"]}], ",", 
      RowBox[{"x123", "\[Rule]", 
       SubscriptBox["x", "123"]}], ",", 
      RowBox[{"x234", "\[Rule]", 
       SubscriptBox["x", "234"]}], ",", 
      RowBox[{"x345", "\[Rule]", 
       SubscriptBox["x", "345"]}], ",", 
      RowBox[{"x2345", "\[Rule]", 
       SubscriptBox["x", "2345"]}], ",", 
      RowBox[{"x12345", "\[Rule]", 
       SubscriptBox["x", "12345"]}], ",", 
      RowBox[{"x1234", "\[Rule]", 
       SubscriptBox["x", "1234"]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728296791546609*^9, 3.728296804504272*^9}, {
  3.7282970910004387`*^9, 3.728297210702445*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a5\[Sigma]", "/.", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "\[RuleDelayed]", 
   RowBox[{
    RowBox[{"cleanify", "[", "a", "]"}], "\[Rule]", 
    RowBox[{"cleanify", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.728296103088028*^9, 3.728296103098021*^9}, 
   3.7282965627697287`*^9, {3.728296776027948*^9, 3.7282968084849577`*^9}, {
   3.72829722394422*^9, 3.728297226587141*^9}, {3.728300798143456*^9, 
   3.72830079890543*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", "1"], "\[Rule]", 
    FractionBox[
     SubscriptBox["x", "2"], 
     RowBox[{"1", "+", 
      SubscriptBox["x", "12"]}]]}], ",", 
   RowBox[{
    SubscriptBox["x", "2"], "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["x", "1"]}], ")"}], " ", 
      SubscriptBox["x", "3"]}], 
     RowBox[{"1", "+", 
      SubscriptBox["x", "123"]}]]}], ",", 
   RowBox[{
    SubscriptBox["x", "3"], "\[Rule]", 
    FractionBox[
     RowBox[{
      SubscriptBox["x", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["x", "12"]}], ")"}]}], 
     RowBox[{"1", "+", 
      SubscriptBox["x", "1234"]}]]}], ",", 
   RowBox[{
    SubscriptBox["x", "4"], "\[Rule]", 
    FractionBox[
     RowBox[{
      SubscriptBox["x", "5"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SubscriptBox["x", "123"]}], ")"}]}], 
     RowBox[{"1", "+", 
      SubscriptBox["x", "12345"]}]]}], ",", 
   RowBox[{
    SubscriptBox["x", "5"], "\[Rule]", 
    FractionBox[
     RowBox[{"1", "+", 
      SubscriptBox["x", "1234"]}], 
     RowBox[{
      SubscriptBox["x", "1"], " ", 
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["x", "4"], " ", 
      SubscriptBox["x", "5"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.728300799763801*^9, 3.728300804222576*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"HoldForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], "\[Rule]", 
      FractionBox[
       SubscriptBox["x", "2"], 
       RowBox[{"1", "+", 
        SubscriptBox["x", "12"]}]]}], ",", 
     RowBox[{
      SubscriptBox["x", "2"], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SubscriptBox["x", "1"]}], ")"}], " ", 
        SubscriptBox["x", "3"]}], 
       RowBox[{"1", "+", 
        SubscriptBox["x", "123"]}]]}], ",", 
     RowBox[{
      SubscriptBox["x", "3"], "\[Rule]", 
      FractionBox[
       RowBox[{
        SubscriptBox["x", "4"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SubscriptBox["x", "12"]}], ")"}]}], 
       RowBox[{"1", "+", 
        SubscriptBox["x", "1234"]}]]}], ",", 
     RowBox[{
      SubscriptBox["x", "4"], "\[Rule]", 
      FractionBox[
       RowBox[{
        SubscriptBox["x", "5"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SubscriptBox["x", "123"]}], ")"}]}], 
       RowBox[{"1", "+", 
        SubscriptBox["x", "12345"]}]]}], ",", 
     RowBox[{
      SubscriptBox["x", "5"], "\[Rule]", 
      FractionBox[
       RowBox[{"1", "+", 
        SubscriptBox["x", "1234"]}], 
       RowBox[{
        SubscriptBox["x", "1"], " ", 
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["x", "3"], " ", 
        SubscriptBox["x", "4"], " ", 
        SubscriptBox["x", "5"]}]]}]}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.728297251462769*^9, 3.7282972763009777`*^9}, {
  3.7282973327565937`*^9, 3.7282973364345217`*^9}}],

Cell["\<\
\\left\\{x_1\\to \\frac{x_2}{1+x_{12}},x_2\\to
   \\frac{\\left(1+x_1\\right) x_3}{1+x_{123}},x_3\\to
   \\frac{x_4 \\left(1+x_{12}\\right)}{1+x_{1234}},x_4\\to
   \\frac{x_5 \\left(1+x_{123}\\right)}{1+x_{12345}},x_5\\to
   \\frac{1+x_{1234}}{x_1 x_2 x_3 x_4 x_5}\\right\\}\
\>", "Output",
 CellChangeTimes->{3.728297337171114*^9}]
}, Open  ]],

Cell[TextData[{
 "describe ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " subalgebras"
}], "Text",
 CellChangeTimes->{{3.728300816735783*^9, 3.728300840352474*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"alg", "=", 
   RowBox[{"a5", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.715963005596505*^9, 3.715963007922741*^9}, {
  3.7175152589894247`*^9, 3.717515289159834*^9}, {3.727515891931024*^9, 
  3.7275158921535177`*^9}, {3.727515975705367*^9, 3.727515975855365*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"algA2s", "=", 
   RowBox[{
    RowBox[{"subalgSeed", "[", "alg", "]"}], "/@", 
    RowBox[{
     RowBox[{"subalg", "[", "alg", "]"}], "[", "a2", "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.715961269928583*^9, 3.715961328571192*^9}, {
  3.715962878341123*^9, 3.715962881213232*^9}, {3.7159629985171127`*^9, 
  3.715963014387723*^9}, {3.717515265031704*^9, 3.7175152935727*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "algA2s", "]"}], "]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"a2Func", "@@@", "algA2s"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"baseSymb", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "algA2s", "]"}], "]"}]}], ")"}], ".", 
    RowBox[{"(", 
     RowBox[{"a2F", "@@@", "algA2s"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.71596133021533*^9, 3.715961359214322*^9}, {
  3.7159628865403214`*^9, 3.71596288973164*^9}, {3.7159630202028217`*^9, 
  3.7159630318470383`*^9}, {3.717515295715838*^9, 3.7175152992805758`*^9}, {
  3.727517306573821*^9, 3.727517319262204*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"applyA5\[Sigma]", "[", "n_", "]"}], "[", "x_", "]"}], ":=", 
   RowBox[{"Nest", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Together", "[", 
       RowBox[{"#", "/.", "a5\[Sigma]"}], "]"}], "&"}], ",", "x", ",", "n"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"applyA5\[Tau]", "[", "x_", "]"}], ":=", 
   RowBox[{"Together", "[", 
    RowBox[{"x", "/.", "a5\[Tau]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7283008917465754`*^9, 3.728300952168201*^9}, {
  3.728301377200726*^9, 3.7283013981585627`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5Collects", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"sortInverse", "/@", 
        RowBox[{"Together", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", 
               RowBox[{"applyA5\[Tau]", "/@", "#"}]}], "}"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"NestList", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"applyA5\[Sigma]", "[", "1", "]"}], "/@", "#"}], 
                "&"}], ",", 
               RowBox[{"(", 
                RowBox[{"a2Xs", "@@", 
                 RowBox[{"algA2s", "[", 
                  RowBox[{"[", "aa", "]"}], "]"}]}], ")"}], ",", "7"}], "]"}],
              ")"}]}], ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"aa", ",", 
        RowBox[{"Length", "[", "algA2s", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728301364961111*^9, 3.72830137219333*^9}, {
  3.7283014030422688`*^9, 3.728301524183138*^9}, {3.728301569083768*^9, 
  3.728301572388612*^9}, {3.7283016656655483`*^9, 3.728301678400133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "/@", "a5Collects"}]], "Input",
 CellChangeTimes->{{3.7283015795949717`*^9, 3.728301583852565*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8", ",", "8", ",", "16", ",", "16"}], "}"}]], "Output",
 CellChangeTimes->{3.7283015858658333`*^9, 3.728301693747219*^9, 
  3.72841083189872*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{"a5Collects", ",", 
     RowBox[{"sortInverse", "[", 
      RowBox[{"a2Xs", "@@", "#"}], "]"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2", ",", "x3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3", ",", "x4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x4", ",", "x5"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.728301954221895*^9, 3.7283019904897957`*^9}, {
  3.7283029662979603`*^9, 3.7283029777516623`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"4", ",", "3"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"4", ",", "7"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "5"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.728301957923753*^9, 3.728301991616466*^9}, {
   3.728302969198349*^9, 3.728302978166402*^9}, 3.728410832019793*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pb", "[", 
   RowBox[{"a5", "[", "]"}], "]"}], "[", 
  RowBox[{"x2", ",", 
   RowBox[{"x3", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x4", "+", 
      RowBox[{"x4", " ", "x5"}]}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.728302925912924*^9, 3.728302938118116*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.728302938577862*^9, 3.7284108322536077`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pb", "[", 
   RowBox[{"a5", "[", "]"}], "]"}], "[", 
  RowBox[{"x2", ",", 
   RowBox[{"x3", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x4"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.728302952552649*^9, 3.728302953563759*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.728302954911396*^9, 3.728410832536932*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"pb", "[", 
   RowBox[{"a5", "[", "]"}], "]"}], "[", 
  RowBox[{
   FractionBox[
    RowBox[{"x1", " ", "x2"}], 
    RowBox[{"1", "+", "x1"}]], ",", 
   RowBox[{"x3", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x4"}], ")"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7283029877320223`*^9, 3.7283029891027412`*^9}, {
   3.728303191712866*^9, 3.728303202760581*^9}, 3.72830324189989*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.728302990133251*^9, {3.728303195208596*^9, 3.7283032037569532`*^9}, 
   3.728303242841198*^9, 3.7284108327217207`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"cleanify", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", 
        RowBox[{"x3", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x4"}], ")"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
        FractionBox[
         RowBox[{"x3", " ", "x4"}], 
         RowBox[{"1", "+", "x3"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", ",", "x3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"x1", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x2"}], ")"}]}], ",", 
        FractionBox[
         RowBox[{"x2", " ", "x3"}], 
         RowBox[{"1", "+", "x2"}]]}], "}"}]}], "}"}]}], ")"}], "/.", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_"}], "}"}], "\[RuleDelayed]", 
   RowBox[{"a", "\[Rule]", "b"}]}]}]], "Input",
 CellChangeTimes->{{3.728303475312779*^9, 3.728303496362034*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubscriptBox["x", "1"], "\[Rule]", 
    SubscriptBox["x", "2"]}], ",", 
   RowBox[{
    SubscriptBox["x", "2"], "\[Rule]", 
    RowBox[{
     SubscriptBox["x", "3"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["x", "4"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["x", "3"]}], ")"}]}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SubscriptBox["x", "3"], " ", 
      SubscriptBox["x", "4"]}], 
     RowBox[{"1", "+", 
      SubscriptBox["x", "3"]}]]}], ",", 
   RowBox[{
    SubscriptBox["x", "2"], "\[Rule]", 
    SubscriptBox["x", "3"]}], ",", 
   RowBox[{
    RowBox[{
     SubscriptBox["x", "1"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SubscriptBox["x", "2"]}], ")"}]}], "\[Rule]", 
    FractionBox[
     RowBox[{
      SubscriptBox["x", "2"], " ", 
      SubscriptBox["x", "3"]}], 
     RowBox[{"1", "+", 
      SubscriptBox["x", "2"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.728410832820178*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"HoldForm", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["x", "1"], "\[Rule]", 
      SubscriptBox["x", "2"]}], ",", 
     RowBox[{
      SubscriptBox["x", "2"], "\[Rule]", 
      RowBox[{
       SubscriptBox["x", "3"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["x", "4"]}], ")"}]}]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["x", "3"]}], ")"}]}], "\[Rule]", 
      FractionBox[
       RowBox[{
        SubscriptBox["x", "3"], " ", 
        SubscriptBox["x", "4"]}], 
       RowBox[{"1", "+", 
        SubscriptBox["x", "3"]}]]}], ",", 
     RowBox[{
      SubscriptBox["x", "2"], "\[Rule]", 
      SubscriptBox["x", "3"]}], ",", 
     RowBox[{
      RowBox[{
       SubscriptBox["x", "1"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SubscriptBox["x", "2"]}], ")"}]}], "\[Rule]", 
      FractionBox[
       RowBox[{
        SubscriptBox["x", "2"], " ", 
        SubscriptBox["x", "3"]}], 
       RowBox[{"1", "+", 
        SubscriptBox["x", "2"]}]]}]}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7283035074203377`*^9, 3.7283035146545963`*^9}}],

Cell["\<\
\\left\\{x_1\\to x_2,x_2\\to x_3 \\left(1+x_4\\right),x_2
   \\left(1+x_3\\right)\\to \\frac{x_3 x_4}{1+x_3},x_2\\to
   x_3,x_1 \\left(1+x_2\\right)\\to \\frac{x_2
   x_3}{1+x_2}\\right\\}\
\>", "Output",
 CellChangeTimes->{3.7283035151832933`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"Sort", "/@", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"9", "-", "#"}]}], "}"}], "&"}], "/@", 
           RowBox[{"NestList", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "+", "1"}], "&"}], ",", "#", ",", "7"}], "]"}]}], 
          ",", "1"}], "]"}], ",", "8", ",", "1"}], "]"}]}], "]"}], "&"}], "/@",
    " ", 
   RowBox[{"Subsets", "[", 
    RowBox[{
     RowBox[{"Range", "[", "8", "]"}], ",", 
     RowBox[{"{", "5", "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.728312766471657*^9, 3.72831278398149*^9}, {
  3.7283129410704823`*^9, 3.7283129509772577`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "5", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "5", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "5", ",", "7", ",", "8"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "6", ",", "7", ",", "8"}], "}"}]}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{{3.7283127804647217`*^9, 3.728312784493863*^9}, {
   3.728312945509841*^9, 3.72831295139434*^9}, 3.728410832921702*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "/@", "%"}]], "Input",
 CellChangeTimes->{{3.728312952511685*^9, 3.728312956589704*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8", ",", "8", ",", "16", ",", "16"}], "}"}]], "Output",
 CellChangeTimes->{3.728312957070017*^9, 3.728410833324502*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"Sort", "/@", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"9", "-", "#"}]}], "}"}], "&"}], "/@", 
           RowBox[{"NestList", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "+", "1"}], "&"}], ",", "#", ",", "7"}], "]"}]}], 
          ",", "1"}], "]"}], ",", "8", ",", "1"}], "]"}]}], "]"}], "&"}], "/@",
    " ", 
   RowBox[{"Subsets", "[", 
    RowBox[{
     RowBox[{"Range", "[", "8", "]"}], ",", 
     RowBox[{"{", "6", "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7284282431969748`*^9, 3.728428243459898*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "6", ",", "7"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "6", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "7"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "6", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "6", ",", "7"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "5", ",", "6", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "6", ",", "7"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "5", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "5", ",", "6", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "4", ",", "6", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "4", ",", "5", ",", "7", ",", "8"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "3", ",", "5", ",", "6", ",", "7", ",", "8"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.728428245114717*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Position", "[", 
    RowBox[{"a5Collects", ",", 
     RowBox[{"sortInverse", "[", 
      RowBox[{"Together", "[", 
       RowBox[{"a2Xs", "@@", "#"}], "]"}], "]"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2", ",", 
      RowBox[{"x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
      FractionBox[
       RowBox[{"x3", " ", "x4"}], 
       RowBox[{"1", "+", "x3"}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x2", ",", "x3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}]}], ",", 
      FractionBox[
       RowBox[{"x2", " ", "x3"}], 
       RowBox[{"1", "+", "x2"}]]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.728303011177045*^9, 3.728303076156507*^9}, 
   3.7283032935497913`*^9, {3.728303377337152*^9, 3.728303378216218*^9}, {
   3.728303421258562*^9, 3.728303435465926*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", "3"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"4", ",", "3"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"5", ",", "4"}], "}"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.728303012668648*^9, {3.728303050338649*^9, 3.728303077609103*^9}, 
   3.7283032951461487`*^9, 3.728303379071189*^9, {3.728303425915798*^9, 
   3.7283034359052687`*^9}, 3.728410833591181*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a5Collects", "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7283017112330017`*^9, 3.7283017131519117`*^9}, {
  3.7283018903553247`*^9, 3.7283019135286922`*^9}, {3.728302797063941*^9, 
  3.7283028047009163`*^9}, {3.728302846531382*^9, 3.728302852199168*^9}, {
  3.728302915414054*^9, 3.728302915920624*^9}, {3.728303090119821*^9, 
  3.72830313456775*^9}, {3.7283032626285887`*^9, 3.728303262752057*^9}, {
  3.7283033204763403`*^9, 3.728303320679222*^9}, {3.728303364116218*^9, 
  3.7283033646095753`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"x1", " ", "x2"}], 
      RowBox[{"1", "+", "x1"}]], ",", 
     RowBox[{"x3", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x4"}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"x1", " ", "x2", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}]}], 
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}]}]], ",", 
     FractionBox[
      RowBox[{"x1", " ", "x2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x3", "+", 
         RowBox[{"x3", " ", "x4"}]}], ")"}]}], 
      RowBox[{"1", "+", "x1"}]], ",", 
     FractionBox[
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1"}], ")"}], " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"x2", " ", "x3"}], 
      RowBox[{"1", "+", "x2"}]], ",", 
     RowBox[{"x4", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x5"}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"x2", " ", "x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}], 
      RowBox[{"1", "+", "x2", "+", 
       RowBox[{"x2", " ", "x3"}]}]], ",", 
     FractionBox[
      RowBox[{"x2", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4", "+", 
         RowBox[{"x4", " ", "x5"}]}], ")"}]}], 
      RowBox[{"1", "+", "x2"}]], ",", 
     FractionBox[
      RowBox[{"1", "+", "x2", "+", 
       RowBox[{"x2", " ", "x3"}], "+", 
       RowBox[{"x2", " ", "x3", " ", "x4"}], "+", 
       RowBox[{"x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}], " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"x3", " ", "x4"}], 
      RowBox[{"1", "+", "x3"}]], ",", 
     FractionBox[
      RowBox[{"x2", " ", "x3", " ", "x4"}], 
      RowBox[{"1", "+", "x2", "+", 
       RowBox[{"x2", " ", "x3"}]}]], ",", 
     RowBox[{"x2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x3", "+", 
        RowBox[{"x3", " ", "x4"}]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}], "+", 
         RowBox[{"x2", " ", "x3", " ", "x4"}]}], ")"}]}], 
      RowBox[{"x3", " ", "x4"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}], 
      RowBox[{"1", "+", "x3"}]], ",", 
     FractionBox[
      RowBox[{"x2", " ", "x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}], 
      RowBox[{"1", "+", "x2", "+", 
       RowBox[{"x2", " ", "x3"}]}]], ",", 
     RowBox[{"x2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x3", "+", 
        RowBox[{"x3", " ", "x4"}], "+", 
        RowBox[{"x3", " ", "x4", " ", "x5"}]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}], "+", 
         RowBox[{"x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x2", " ", "x3", " ", "x4", " ", "x5"}]}], ")"}]}], 
      RowBox[{"x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"x1", " ", "x2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x3"}], ")"}]}], 
      RowBox[{"1", "+", "x1"}]], ",", 
     FractionBox[
      RowBox[{"x3", " ", "x4"}], 
      RowBox[{"1", "+", "x3"}]], ",", 
     FractionBox[
      RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], 
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3"}]}]], ",", 
     FractionBox[
      RowBox[{"x1", " ", "x2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x3", "+", 
         RowBox[{"x3", " ", "x4"}]}], ")"}]}], 
      RowBox[{"1", "+", "x1"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x3"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1"}], ")"}], " ", "x3", " ", "x4"}]]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}]}], ")"}]}], 
      RowBox[{"x2", " ", "x3"}]], ",", 
     FractionBox[
      RowBox[{"1", "+", "x2", "+", 
       RowBox[{"x2", " ", "x3"}], "+", 
       RowBox[{"x2", " ", "x3", " ", "x4"}], "+", 
       RowBox[{"x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}], " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}], ")"}], " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
        ")"}]}], 
      RowBox[{"x2", " ", "x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x5"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
        ")"}]}], 
      RowBox[{"x2", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4", "+", 
         RowBox[{"x4", " ", "x5"}]}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1"}], ")"}], " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x3", "+", 
         RowBox[{"x3", " ", "x4"}], "+", 
         RowBox[{"x3", " ", "x4", " ", "x5"}]}], ")"}]}], 
      RowBox[{"x4", " ", "x5"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}], ")"}], " ", "x4", " ", "x5"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x3", "+", 
         RowBox[{"x3", " ", "x4"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1"}], ")"}], " ", "x3", " ", "x4", " ", "x5"}]], 
     ",", 
     FractionBox[
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1"}], ")"}], " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4", "+", 
         RowBox[{"x4", " ", "x5"}]}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}]}], ")"}]}], 
      RowBox[{"x2", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}], "+", 
         RowBox[{"x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x2", " ", "x3", " ", "x4", " ", "x5"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}], " ", "x4", " ", "x5"}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x4"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
        ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}], ")"}], " ", "x4", " ", "x5"}]], ",", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"x2", " ", "x3", " ", "x4", " ", "x5"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}], "+", 
         RowBox[{"x2", " ", "x3", " ", "x4"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
        ")"}]}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4", " ", "x5"}]}], 
        ")"}]}], 
      RowBox[{"x2", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x4", "+", 
         RowBox[{"x4", " ", "x5"}]}], ")"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.72830171347171*^9, {3.728301891189116*^9, 3.728301914105816*^9}, {
   3.728302797710541*^9, 3.728302805376463*^9}, 3.7283028582767553`*^9, 
   3.728302916624638*^9, 3.728303090690357*^9, {3.7283031211894283`*^9, 
   3.728303135272346*^9}, 3.728303263337256*^9, 3.728303321153489*^9, 
   3.728303365269034*^9, 3.7284108336904573`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define fA5", "Section",
 CellChangeTimes->{{3.728318655133588*^9, 3.728318658619977*^9}, {
  3.7283191500939827`*^9, 3.7283191517944107`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"target", "=", 
   RowBox[{"a5FuncMM", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"1", "/", "4"}]}], ",", 
      RowBox[{
       RowBox[{"q", "[", "3", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "4", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "5", "]"}], "\[Rule]", 
       RowBox[{"1", "/", "4"}]}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728412197994596*^9, 3.7284122040421333`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"targetExp", "=", 
   RowBox[{
    RowBox[{"b2b2", "[", "6", "]"}], "[", "target", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728422768982747*^9, 3.7284227784079657`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"targetExp", "=", 
   RowBox[{"collectTensors", "[", "targetExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728422671398077*^9, 3.7284227158947153`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"targetExp", "=", 
   RowBox[{"tensorClean", "[", "targetExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7284226956783113`*^9, 3.728422719196741*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a5a2", "[", "1", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a5a2", "[", "2", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"x2", ",", 
     RowBox[{"x3", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x4"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a5a2", "[", "3", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
     RowBox[{"x3", " ", 
      RowBox[{"x4", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x3"}], ")"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a5a2", "[", "4", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"x2", ",", "x3"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a5a2", "[", "5", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x2"}], ")"}]}], ",", 
     RowBox[{"x2", " ", 
      RowBox[{"x3", "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x2"}], ")"}]}]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7284122196723824`*^9, 3.728412279612302*^9}, {
  3.728422512159947*^9, 3.72842253666751*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"cleanWedge", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"aa", ",", "i", ",", "0"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"a2Func", "@@@", 
            RowBox[{"NestList", "[", 
             RowBox[{
              RowBox[{"applyA5\[Sigma]", "[", "1", "]"}], ",", 
              RowBox[{"a5a2", "[", "aa", "]"}], ",", "7"}], "]"}]}], ")"}]}], 
         "+", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{"aa", ",", "i", ",", "1"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "8"}], "}"}]}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"a2Func", "@@@", 
            RowBox[{"(", 
             RowBox[{"applyA5\[Tau]", "[", 
              RowBox[{"NestList", "[", 
               RowBox[{
                RowBox[{"applyA5\[Sigma]", "[", "1", "]"}], ",", 
                RowBox[{"a5a2", "[", "aa", "]"}], ",", "7"}], "]"}], "]"}], 
             ")"}]}], ")"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"aa", ",", "5"}], "}"}]}], "]"}], "]"}], ",", 
     RowBox[{"wedge", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728412327054899*^9, 3.728412364075251*^9}, {
  3.728422351141021*^9, 3.728422407554716*^9}, {3.728422438791959*^9, 
  3.728422480379918*^9}, {3.728422540466597*^9, 3.728422616416032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{
    RowBox[{"b2b2", "[", "8", "]"}], "[", "ansatz", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728422618245751*^9, 3.728422628163773*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{"collectTensors", "[", "ansatzExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728422630126141*^9, 3.728422642318635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{"tensorClean", "[", "ansatzExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7284226450200653`*^9, 3.728422651417557*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zero", "=", 
   RowBox[{"collectTensors", "[", 
    RowBox[{"targetExp", "-", "ansatzExp"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728422935496757*^9, 3.728422948881271*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"sortMinus", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", "zero"}], ")"}], "/.", 
     RowBox[{
      RowBox[{"tensor", "[", "__", "]"}], "\[RuleDelayed]", "1"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728422950373238*^9, 3.728422974181571*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soln", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"Thread", "[", 
      RowBox[{"eqs", "\[Equal]", "0"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7284229758197803`*^9, 3.728422991812393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"cleanWedge", "[", 
      RowBox[{
       RowBox[{"1", "/", "4"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "x"], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"p", "[", "1", "]"}], 
                RowBox[{"a2Func", "[", 
                 RowBox[{"x2", ",", 
                  RowBox[{"x3", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "x4"}], ")"}]}]}], "]"}]}], "+", 
               RowBox[{"a2Func", "[", 
                RowBox[{
                 RowBox[{"x1", 
                  RowBox[{"(", 
                   RowBox[{"1", "+", "x2"}], ")"}]}], ",", 
                 RowBox[{"x2", " ", 
                  RowBox[{"x3", "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "x2"}], ")"}]}]}]}], "]"}]}], ")"}]}], "/.", 
            RowBox[{
             RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
             RowBox[{"cb2", "[", 
              RowBox[{"Together", "[", 
               RowBox[{
                RowBox[{"applyA5\[Sigma]", "[", "x", "]"}], "[", "a", "]"}], 
               "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "7"}], "}"}]}], "]"}], "-", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"-", "1"}], ")"}], "x"], 
             RowBox[{"(", 
              RowBox[{"applyA5\[Tau]", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"p", "[", "2", "]"}], 
                 RowBox[{"a2Func", "[", 
                  RowBox[{"x2", ",", 
                   RowBox[{"x3", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "x4"}], ")"}]}]}], "]"}]}], "+", 
                RowBox[{"a2Func", "[", 
                 RowBox[{
                  RowBox[{"x1", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "x2"}], ")"}]}], ",", 
                  RowBox[{"x2", " ", 
                   RowBox[{"x3", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "x2"}], ")"}]}]}]}], "]"}]}], "]"}], 
              ")"}]}], "/.", 
            RowBox[{
             RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
             RowBox[{"cb2", "[", 
              RowBox[{"Together", "[", 
               RowBox[{
                RowBox[{"applyA5\[Sigma]", "[", "x", "]"}], "[", "a", "]"}], 
               "]"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0", ",", "7"}], "}"}]}], "]"}]}], ")"}]}], 
      "]"}], ",", 
     RowBox[{"wedge", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728319319221921*^9, 3.728319320019093*^9}, {
  3.728319399356933*^9, 3.728319545773611*^9}, {3.728319587120013*^9, 
  3.728319594149251*^9}, {3.728320124087727*^9, 3.728320124256181*^9}, {
  3.728404637057727*^9, 3.728404638293535*^9}, {3.728423596759632*^9, 
  3.728423602776931*^9}, {3.7284240112953663`*^9, 3.728424133946239*^9}, {
  3.728426645234129*^9, 3.728426690706758*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zero", "=", 
   RowBox[{"tmp", "-", "target"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728424158450473*^9, 3.728424162802472*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroExp", "=", 
   RowBox[{
    RowBox[{"b2b2", "[", "6", "]"}], "[", "zero", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728422768982747*^9, 3.7284227784079657`*^9}, {
  3.728424218525713*^9, 3.728424226994885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroExp", "=", 
   RowBox[{"collectTensors", "[", "zeroExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728422671398077*^9, 3.7284227158947153`*^9}, {
  3.728424221406311*^9, 3.7284242299909067`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroExp", "=", 
   RowBox[{"tensorClean", "[", "zeroExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7284226956783113`*^9, 3.728422719196741*^9}, {
  3.7284242238431396`*^9, 3.728424232319047*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"zeroExp", "=", 
   RowBox[{"collectTensors", "[", "zeroExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728424291454547*^9, 3.728424302763494*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zeroExp", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.728424304561029*^9, 3.7284243053550997`*^9}, {
  3.728426757604231*^9, 3.72842677176505*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.728424305724687*^9, {3.728426745487652*^9, 3.7284267725143967`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{840, 1006},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1124, 15, 114, "Title"],
Cell[1707, 39, 368, 9, 66, "Input"],
Cell[2078, 50, 154, 3, 39, "Input"],
Cell[CellGroupData[{
Cell[2257, 57, 91, 1, 80, "Section"],
Cell[2351, 60, 1739, 51, 154, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4127, 116, 96, 1, 80, "Section"],
Cell[4226, 119, 1486, 36, 118, "Input"],
Cell[5715, 157, 564, 15, 66, "Input"],
Cell[6282, 174, 563, 15, 66, "Input"],
Cell[6848, 191, 359, 10, 39, "Input"],
Cell[7210, 203, 1953, 56, 170, "Input"],
Cell[CellGroupData[{
Cell[9188, 263, 496, 11, 39, "Input"],
Cell[9687, 276, 1446, 50, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11170, 331, 1666, 53, 149, "Input"],
Cell[12839, 386, 342, 7, 128, "Output"]
}, Open  ]],
Cell[13196, 396, 229, 8, 39, "Text"],
Cell[13428, 406, 308, 6, 39, "Input"],
Cell[13739, 414, 420, 10, 39, "Input"],
Cell[14162, 426, 848, 23, 66, "Input"],
Cell[15013, 451, 614, 17, 66, "Input"],
Cell[15630, 470, 1298, 34, 196, "Input"],
Cell[CellGroupData[{
Cell[16953, 508, 132, 2, 39, "Input"],
Cell[17088, 512, 195, 4, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17320, 521, 610, 18, 66, "Input"],
Cell[17933, 541, 531, 16, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18501, 562, 314, 9, 39, "Input"],
Cell[18818, 573, 94, 1, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18949, 579, 275, 8, 39, "Input"],
Cell[19227, 589, 92, 1, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19356, 595, 424, 12, 58, "Input"],
Cell[19783, 609, 171, 3, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19991, 617, 1105, 35, 107, "Input"],
Cell[21099, 654, 1111, 40, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22247, 699, 1284, 42, 142, "Input"],
Cell[23534, 743, 258, 6, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23829, 754, 878, 26, 92, "Input"],
Cell[24710, 782, 5614, 131, 378, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30361, 918, 121, 2, 39, "Input"],
Cell[30485, 922, 169, 3, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30691, 930, 828, 25, 92, "Input"],
Cell[31522, 957, 3307, 95, 274, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34866, 1057, 1203, 37, 135, "Input"],
Cell[36072, 1096, 693, 21, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36802, 1122, 553, 9, 39, "Input"],
Cell[37358, 1133, 12730, 358, 992, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50137, 1497, 148, 2, 80, "Section"],
Cell[50288, 1501, 639, 18, 39, "Input"],
Cell[50930, 1521, 210, 5, 39, "Input"],
Cell[51143, 1528, 193, 4, 39, "Input"],
Cell[51339, 1534, 190, 4, 39, "Input"],
Cell[51532, 1540, 1333, 46, 144, "Input"],
Cell[52868, 1588, 1703, 44, 222, "Input"],
Cell[54574, 1634, 208, 5, 39, "Input"],
Cell[54785, 1641, 191, 4, 39, "Input"],
Cell[54979, 1647, 190, 4, 39, "Input"],
Cell[55172, 1653, 219, 5, 39, "Input"],
Cell[55394, 1660, 338, 10, 39, "Input"],
Cell[55735, 1672, 298, 8, 39, "Input"],
Cell[56036, 1682, 3400, 87, 372, "Input"],
Cell[59439, 1771, 167, 4, 39, "Input"],
Cell[59609, 1777, 255, 6, 39, "Input"],
Cell[59867, 1785, 240, 5, 39, "Input"],
Cell[60110, 1792, 237, 5, 39, "Input"],
Cell[60350, 1799, 187, 4, 39, "Input"],
Cell[CellGroupData[{
Cell[60562, 1807, 395, 11, 39, "Input"],
Cell[60960, 1820, 121, 2, 39, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

