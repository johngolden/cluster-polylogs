(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26590,        825]
NotebookOptionsPosition[     24578,        759]
NotebookOutlinePosition[     24978,        777]
CellTagsIndexPosition[     24935,        774]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Q: Find a good B2b2 not completable to a cluster-A function", "Title",
 CellChangeTimes->{{3.7155216343483543`*^9, 3.715521661935596*^9}, {
   3.7155217024191933`*^9, 3.715521776747312*^9}, {3.715697106466093*^9, 
   3.715697132670868*^9}, 3.717339565784286*^9, {3.717596412665661*^9, 
   3.7175964295471077`*^9}, 3.7190772318918056`*^9, {3.719161602248806*^9, 
   3.719161617724811*^9}, 3.7191622907219543`*^9, {3.719330906137623*^9, 
   3.719330919779743*^9}, 3.7214675803034782`*^9, {3.722256568008562*^9, 
   3.722256584333577*^9}, {3.7222587062837543`*^9, 3.7222587099149513`*^9}, 
   3.723892693455821*^9, {3.723910170409132*^9, 3.723910179723064*^9}, {
   3.7247613005595207`*^9, 3.724761305849478*^9}, {3.7251093997280607`*^9, 
   3.725109422520021*^9}, {3.725109486952263*^9, 3.725109487141718*^9}, {
   3.7253796263545513`*^9, 3.725379627752042*^9}, {3.7262081679226522`*^9, 
   3.726208187405767*^9}, {3.7262310495952473`*^9, 3.726231058788488*^9}, {
   3.727099108843804*^9, 3.727099123185153*^9}, {3.727512928109139*^9, 
   3.727512933417872*^9}, {3.72821639588512*^9, 3.728216402599391*^9}, {
   3.730102925667328*^9, 3.730102926024365*^9}, {3.732289648831846*^9, 
   3.73228965611917*^9}, 3.733229848125965*^9, {3.735926990223662*^9, 
   3.735926991974353*^9}, {3.736155977439673*^9, 3.736155983903709*^9}, {
   3.744437211687118*^9, 3.744437217226323*^9}, {3.744437673079648*^9, 
   3.744437699859138*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "tools.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.713271961760497*^9, 3.7132719819312153`*^9}, {
  3.713272319095078*^9, 3.713272323693686*^9}, {3.7132801678394003`*^9, 
  3.7132801680639467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5Subs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"g47ify", "/@", "#"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"subalgSeed", "[", 
       RowBox[{"e6", "[", "]"}], "]"}], "/@", 
      RowBox[{
       RowBox[{"subalg", "[", 
        RowBox[{"e6", "[", "]"}], "]"}], "[", "a3", "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.749111329003358*^9, 3.749111332198621*^9}, {
  3.7491558635581217`*^9, 3.74915586533949*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp1", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"clean", "[", "7", "]"}], "/@", 
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"a5", "@@", 
       RowBox[{"a5Subs", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.74915586887621*^9, 3.749155922263859*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a51E6Flip", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"clean", "[", "7", "]"}], "/@", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"a5", "@@", 
       RowBox[{
        RowBox[{"flip", "[", "7", "]"}], "[", 
        RowBox[{"a5Subs", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7491568768153753`*^9, 3.749156945985283*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a52A5Flip", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"clean", "[", "7", "]"}], "/@", 
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{"a5", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a5Subs", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_", ",", "e_"}], "}"}], 
          "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "e"}], ",", 
            RowBox[{"1", "/", "d"}], ",", 
            RowBox[{"1", "/", "c"}], ",", 
            RowBox[{"1", "/", "b"}], ",", 
            RowBox[{"1", "/", "a"}]}], "}"}]}]}], ")"}]}], ")"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.749156971320202*^9, 3.7491570337834463`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"a52A5Flip", "==", "a51E6Flip"}]], "Input",
 CellChangeTimes->{{3.749157037474229*^9, 3.7491570692461*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7491570396140537`*^9, 3.749157069808195*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"a5", "@@", 
  RowBox[{"a5Subs", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.749156961840949*^9, 3.749156966517645*^9}}],

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"clean", "[", "7", "]"}], "/@", 
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{"a5", "@@", 
     RowBox[{
      RowBox[{"flip", "[", "7", "]"}], "[", 
      RowBox[{"a5Subs", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"clean", "[", "7", "]"}], "/@", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"a5", "@@", 
          RowBox[{
           RowBox[{"flip", "[", "7", "]"}], "[", 
           RowBox[{"a5Subs", "[", 
            RowBox[{"[", "aaa", "]"}], "]"}], "]"}]}], ")"}]}], "]"}], ")"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"aaa", ",", "7"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749155931393742*^9, 3.749155938593265*^9}, {
  3.749156015428451*^9, 3.749156037393796*^9}, {3.749156077419245*^9, 
  3.74915609631511*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Position", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"sortInverse", "/@", "#"}], ")"}], "&"}], "/@", "tmp2"}], ",", 
   RowBox[{"sortInverse", "[", 
    RowBox[{"tmp1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.749156040511183*^9, 3.749156048403365*^9}, {
  3.749156100755084*^9, 3.749156103501824*^9}, {3.749156180375675*^9, 
  3.749156195141304*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2", ",", "7"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.749156048722649*^9, 3.7491561081315536`*^9, {3.749156191597598*^9, 
   3.749156195597178*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"numVals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"sortInverse", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"num", "[", "7", "]"}], "[", 
          RowBox[{
           RowBox[{"listSym", "[", "7", "]"}], "[", 
           RowBox[{"A3", "@@", 
            RowBox[{"a3Subs", "[", 
             RowBox[{"[", "aaa", "]"}], "]"}]}], "]"}], "]"}], "/.", 
         RowBox[{"A3", "\[Rule]", "a3Xs"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"aaa", ",", 
       RowBox[{"Length", "[", "a3Subs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7491113469009733`*^9, 3.749111437561479*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"numValsUnion", "=", 
   RowBox[{"Union", "[", "numVals", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.74911144079252*^9, 3.7491114459277487`*^9}, {
  3.749112072008317*^9, 3.749112081484673*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{
    RowBox[{"addSym", "[", "7", "]"}], "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "numValsUnion", "]"}], "]"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"A3", "@@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"a3Subs", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"numVals", ",", "#"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "numValsUnion"}], 
           "]"}], "]"}]}], ")"}]}], ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749112145989602*^9, 3.749112236733457*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"list", "=", 
   RowBox[{"(", 
    RowBox[{"A3", "@@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"a3Subs", "[", 
         RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
       RowBox[{"Union", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"numVals", ",", "#"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "numValsUnion"}], 
         "]"}], "]"}]}], ")"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7491126805472593`*^9, 3.749112684994574*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a3FuncB2b2", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", "x1", "]"}], ",", 
      RowBox[{"cb2", "[", "x3", "]"}]}], "]"}], "+", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       FractionBox["x2", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]], "]"}], ",", 
      RowBox[{"cb2", "[", 
       FractionBox[
        RowBox[{"x1", " ", "x2", " ", "x3"}], 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]], "]"}]}], "]"}], "-", 
    RowBox[{"wedge", "[", 
     RowBox[{
      RowBox[{"cb2", "[", 
       RowBox[{"x1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x2", "+", 
          RowBox[{"x2", " ", "x3"}]}], ")"}]}], "]"}], ",", 
      RowBox[{"cb2", "[", 
       FractionBox["x3", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}]}]], "]"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7491122676615562`*^9, 3.74911227812609*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{"collectTensors", "[", 
    RowBox[{
     RowBox[{"b2b2", "[", "7", "]"}], "[", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"cleanWedge", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ansatz", "/.", 
           RowBox[{"A3", "\[Rule]", "a3FuncB2b2"}]}], ")"}], "//.", 
         RowBox[{
          RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
          RowBox[{"cb2", "[", 
           RowBox[{
            RowBox[{"clean", "[", "7", "]"}], "[", "a", "]"}], "]"}]}]}], 
        "]"}], ",", 
       RowBox[{"wedge", "[", "__", "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7491122798680964`*^9, 3.7491123591506577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soln", "=", 
   RowBox[{"fit", "[", "ansatzExp", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7491123644226627`*^9, 3.7491123674792147`*^9}, {
  3.749112403046637*^9, 3.749112414151208*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{
   RowBox[{"Variables", "[", "ansatzExp", "]"}], ",", 
   RowBox[{"p", "[", "_", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7491128740126867`*^9, 3.7491128809687777`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"p", "[", "1", "]"}], ",", 
   RowBox[{"p", "[", "4", "]"}], ",", 
   RowBox[{"p", "[", "5", "]"}], ",", 
   RowBox[{"p", "[", "6", "]"}], ",", 
   RowBox[{"p", "[", "7", "]"}], ",", 
   RowBox[{"p", "[", "8", "]"}], ",", 
   RowBox[{"p", "[", "13", "]"}], ",", 
   RowBox[{"p", "[", "17", "]"}], ",", 
   RowBox[{"p", "[", "10", "]"}], ",", 
   RowBox[{"p", "[", "16", "]"}], ",", 
   RowBox[{"p", "[", "3", "]"}], ",", 
   RowBox[{"p", "[", "9", "]"}], ",", 
   RowBox[{"p", "[", "11", "]"}], ",", 
   RowBox[{"p", "[", "2", "]"}], ",", 
   RowBox[{"p", "[", "12", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.74911288217493*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"p", "/@", 
           RowBox[{"Range", "[", "17", "]"}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"c", "/@", 
           RowBox[{"Range", "[", "17", "]"}]}], ")"}]}], "//.", "soln"}], ",",
        "#"}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{"c", "/@", 
      RowBox[{"Range", "[", "17", "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.74911242639811*^9, 3.749112461985623*^9}, {
  3.749113255319669*^9, 3.749113344667885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"big", "=", 
   RowBox[{"Subsets", "[", 
    RowBox[{"eqs", ",", 
     RowBox[{"{", "14", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.74911334794125*^9, 3.7491133722400837`*^9}, {
  3.749113448087132*^9, 3.749113448974757*^9}, {3.749113487082078*^9, 
  3.7491134872774878`*^9}, {3.749113521936751*^9, 3.7491135220727253`*^9}, {
  3.7491135800606956`*^9, 3.749113580437737*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solns", "=", 
   RowBox[{"solve", "/@", "big"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7491133607956133`*^9, 3.7491133904734*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "/@", 
       RowBox[{"Range", "[", "17", "]"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"c", "/@", 
       RowBox[{"Range", "[", "17", "]"}]}], ")"}]}], "//.", "soln"}], ")"}], "//.", 
  RowBox[{"Union", "[", "solns", "]"}]}]], "Input",
 CellChangeTimes->{{3.749113547469602*^9, 3.749113566048307*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"c", "[", "4", "]"}], " ", 
     RowBox[{"p", "[", "10", "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "5", "]"}], " ", 
     RowBox[{"p", "[", "10", "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "10", "]"}], " ", 
     RowBox[{"p", "[", "10", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"c", "[", "9", "]"}], " ", 
     RowBox[{"p", "[", "16", "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "10", "]"}], " ", 
     RowBox[{"p", "[", "16", "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "16", "]"}], " ", 
     RowBox[{"p", "[", "16", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "5", "]"}], " ", 
     RowBox[{"p", "[", "10", "]"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"c", "[", "6", "]"}], " ", 
     RowBox[{"p", "[", "10", "]"}]}], "+", 
    RowBox[{
     RowBox[{"c", "[", "10", "]"}], " ", 
     RowBox[{"p", "[", "10", "]"}]}]}], ",", "0"}], "}"}]], "Input",
 CellChangeTimes->{{3.749113593232176*^9, 3.749113650833852*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{
    RowBox[{"addSym", "[", "7", "]"}], "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "4", "]"}]}], "+", 
      RowBox[{"c", "[", "6", "]"}]}], "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c", "[", "a_", "]"}], "\[RuleDelayed]", 
       RowBox[{"list", "[", 
        RowBox[{"[", "a", "]"}], "]"}]}], ")"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7491125998576183`*^9, 3.749112607271729*^9}, {
   3.7491126437655897`*^9, 3.74911265010159*^9}, {3.7491126899343433`*^9, 
   3.749112724299861*^9}, 3.7491129237797413`*^9, {3.749113216034605*^9, 
   3.74911322182927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"check1", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"cleanWedge", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"check", "/.", 
         RowBox[{"A3", "\[Rule]", "a3FuncB2b2"}]}], ")"}], "//.", 
       RowBox[{
        RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
        RowBox[{"cb2", "[", 
         RowBox[{
          RowBox[{"clean", "[", "7", "]"}], "[", "a", "]"}], "]"}]}]}], "]"}],
      ",", 
     RowBox[{"wedge", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749113179268968*^9, 3.7491131845226803`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"length", "[", "check1", "]"}]], "Input",
 CellChangeTimes->{{3.749113186979876*^9, 3.7491131924354563`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7491131933904448`*^9, 3.749113226406968*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"check2", "=", 
   RowBox[{"collectTensors", "[", 
    RowBox[{
     RowBox[{"b2b2", "[", "7", "]"}], "[", 
     RowBox[{"Collect", "[", 
      RowBox[{
       RowBox[{"cleanWedge", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"check", "/.", 
           RowBox[{"A3", "\[Rule]", "a3FuncB2b2"}]}], ")"}], "//.", 
         RowBox[{
          RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
          RowBox[{"cb2", "[", 
           RowBox[{
            RowBox[{"clean", "[", "7", "]"}], "[", "a", "]"}], "]"}]}]}], 
        "]"}], ",", 
       RowBox[{"wedge", "[", "__", "]"}]}], "]"}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.74911261047106*^9, 3.749112610835761*^9}, {
  3.7491127445722313`*^9, 3.749112786917644*^9}}],

Cell[CellGroupData[{

Cell[BoxData["check2"], "Input",
 CellChangeTimes->{{3.749112931162485*^9, 3.749112932637426*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.749112937140914*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"c", "[", "4", "]"}]}], "+", 
     RowBox[{"c", "[", "5", "]"}], "+", 
     RowBox[{"c", "[", "10", "]"}]}], "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c", "[", "a_", "]"}], "\[RuleDelayed]", 
      RowBox[{"list", "[", 
       RowBox[{"[", "a", "]"}], "]"}]}], ")"}]}], ")"}], "/.", 
  RowBox[{
   RowBox[{"A3", "[", "a___", "]"}], "\[RuleDelayed]", 
   RowBox[{"(", 
    RowBox[{"A3", "@@", 
     RowBox[{"(", 
      RowBox[{"e6ify", "/@", 
       RowBox[{"{", "a", "}"}]}], ")"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.74911299194839*^9, 3.749113015869478*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"A3", "[", 
      RowBox[{"x1", ",", 
       RowBox[{"x2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
       FractionBox[
        RowBox[{"x3", " ", "x4", " ", "x5"}], 
        RowBox[{"1", "+", "x53"}]]}], "]"}]}], "+", 
    RowBox[{"A3", "[", 
     RowBox[{"x1", ",", 
      RowBox[{"x2", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
      FractionBox[
       RowBox[{"x3", " ", "x4", " ", "x5", " ", "x6"}], 
       RowBox[{"1", "+", "x653"}]]}], "]"}], "+", 
    RowBox[{"A3", "[", 
     RowBox[{"x1", ",", 
      FractionBox[
       RowBox[{"x2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x6534"}], ")"}]}], 
       RowBox[{"1", "+", "x65"}]], ",", 
      FractionBox[
       RowBox[{"x3", " ", "x5"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "+", "x5"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x653"}], ")"}]}]]}], "]"}]}], "//", "print"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.749113024229261*^9, 3.7491130918565207`*^9}, {
  3.7491145199610662`*^9, 3.7491145210448*^9}}],

Cell["\<\
-2 \\text{A3}\\left(\\text{x1},\\text{x2}
   (\\text{x3}+1),\\frac{\\text{x3} \\text{x4}
   \\text{x5}}{\\text{x53}+1}\\right)+\\text{A3}\\left(\\text{x
   1},\\text{x2} (\\text{x3}+1),\\frac{\\text{x3} \\text{x4}
   \\text{x5}
   \\text{x6}}{\\text{x653}+1}\\right)+\\text{A3}\\left(\\text{
   x1},\\frac{\\text{x2}
   (\\text{x6534}+1)}{\\text{x65}+1},\\frac{\\text{x3}
   \\text{x5}}{(\\text{x5}+1) (\\text{x653}+1)}\\right)\
\>", "Output",
 CellChangeTimes->{3.749114521648468*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a3Ims", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["x2", 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]], ",", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "x1"}], ")"}], " ", "x3"}], 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}]}]], ",", 
       FractionBox[
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}], 
        RowBox[{"x1", " ", "x2", " ", "x3"}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["x3", 
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}]}]], ",", 
       FractionBox[
        RowBox[{"1", "+", "x2"}], 
        RowBox[{"x2", " ", "x3"}]], ",", 
       RowBox[{"x1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x2", "+", 
          RowBox[{"x2", " ", "x3"}]}], ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "x3"], ",", 
       FractionBox[
        RowBox[{"x1", " ", "x2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x3"}], ")"}]}], 
        RowBox[{"1", "+", "x1"}]], ",", 
       FractionBox["1", "x1"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"x1", " ", "x2", " ", "x3"}], 
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}]], ",", 
       FractionBox["1", 
        RowBox[{"x1", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x2"}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}]}], "x2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"x1", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x2", "+", 
           RowBox[{"x2", " ", "x3"}]}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"1", "+", "x1", "+", 
         RowBox[{"x1", " ", "x2"}], "+", 
         RowBox[{"x1", " ", "x2", " ", "x3"}]}], 
        RowBox[{"x2", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x3"}], ")"}]}]], ",", 
       FractionBox[
        RowBox[{"1", "+", "x2", "+", 
         RowBox[{"x2", " ", "x3"}]}], "x3"]}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.749113877486459*^9, 3.749113923815283*^9}, {
  3.749114004022504*^9, 3.74911403308284*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findNice", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Together", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"listSym", "[", "7", "]"}], "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "]"}], "/.", 
            RowBox[{
             RowBox[{"A3", "[", "a__", "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"A3", "@@", 
               RowBox[{"(", 
                RowBox[{"e6ify", "/@", 
                 RowBox[{"{", "a", "}"}]}], ")"}]}], ")"}]}]}], ")"}], "/.", 
          RowBox[{"A3", "\[Rule]", "a3Ims"}]}], "]"}], ",", "1"}], "]"}], 
      "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"4", ",", "5", ",", "10"}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7491137415725393`*^9, 3.749113752285701*^9}, {
  3.749114041311152*^9, 3.749114114185354*^9}, {3.749114158286571*^9, 
  3.7491141675023413`*^9}}]
}, Open  ]]
},
Evaluator->"local2",
WindowSize->{840, 1005},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1428, 19, 252, "Title"],
Cell[2011, 43, 368, 9, 66, "Input"],
Cell[2382, 54, 491, 15, 39, "Input"],
Cell[2876, 71, 534, 16, 39, "Input"],
Cell[3413, 89, 585, 18, 66, "Input"],
Cell[4001, 109, 985, 29, 144, "Input"],
Cell[CellGroupData[{
Cell[5011, 142, 130, 2, 39, "Input"],
Cell[5144, 146, 97, 1, 39, "Output"]
}, Open  ]],
Cell[5256, 150, 174, 4, 39, "Input"],
Cell[5433, 156, 438, 14, 39, "Input"],
Cell[5874, 172, 896, 26, 118, "Input"],
Cell[CellGroupData[{
Cell[6795, 202, 458, 12, 39, "Input"],
Cell[7256, 216, 216, 6, 39, "Output"]
}, Open  ]],
Cell[7487, 225, 736, 21, 144, "Input"],
Cell[8226, 248, 233, 5, 39, "Input"],
Cell[8462, 255, 908, 26, 118, "Input"],
Cell[9373, 283, 646, 19, 118, "Input"],
Cell[10022, 304, 1104, 32, 135, "Input"],
Cell[11129, 338, 752, 21, 144, "Input"],
Cell[11884, 361, 228, 5, 39, "Input"],
Cell[CellGroupData[{
Cell[12137, 370, 225, 5, 39, "Input"],
Cell[12365, 377, 685, 18, 66, "Output"]
}, Open  ]],
Cell[13065, 398, 663, 20, 66, "Input"],
Cell[13731, 420, 424, 9, 39, "Input"],
Cell[14158, 431, 168, 4, 39, "Input"],
Cell[14329, 437, 414, 12, 39, "Input"],
Cell[14746, 451, 1128, 35, 92, "Input"],
Cell[15877, 488, 683, 18, 39, "Input"],
Cell[16563, 508, 608, 17, 115, "Input"],
Cell[CellGroupData[{
Cell[17196, 529, 132, 2, 48, "Input"],
Cell[17331, 533, 94, 1, 48, "Output"]
}, Open  ]],
Cell[17440, 537, 794, 22, 147, "Input"],
Cell[CellGroupData[{
Cell[18259, 563, 98, 1, 48, "Input"],
Cell[18360, 566, 70, 1, 48, "Output"]
}, Open  ]],
Cell[18445, 570, 707, 22, 82, "Input"],
Cell[19155, 594, 1230, 38, 173, InheritFromParent],
Cell[20388, 634, 495, 11, 288, "Output"],
Cell[20886, 647, 2603, 78, 297, "Input"],
Cell[23492, 727, 1070, 29, 212, "Input"]
}, Open  ]]
}
]
*)

