(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12896,        434]
NotebookOptionsPosition[     11346,        377]
NotebookOutlinePosition[     11725,        394]
CellTagsIndexPosition[     11682,        391]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Q: Find all automorphisms ", "Title",
 CellChangeTimes->{{3.7155216343483543`*^9, 3.715521661935596*^9}, {
   3.7155217024191933`*^9, 3.715521776747312*^9}, {3.715697106466093*^9, 
   3.715697132670868*^9}, 3.717339565784286*^9, {3.717596412665661*^9, 
   3.7175964295471077`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "tools.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.713271961760497*^9, 3.7132719819312153`*^9}, {
  3.713272319095078*^9, 3.713272323693686*^9}, {3.7132801678394003`*^9, 
  3.7132801680639467`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x1Num", "=", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}], "/", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2Num", "=", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}], "/", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x3Num", "=", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}], "/", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x4Num", "=", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}], "/", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x5Num", "=", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}], "/", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"100", ",", "1000"}], "}"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.717524500117943*^9, 3.717524531495681*^9}, {
  3.717524858530752*^9, 3.717524860403586*^9}, {3.717532070185253*^9, 
  3.7175320758645573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"num", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", "x1Num"}], ",", 
     RowBox[{"x2", "\[Rule]", "x2Num"}], ",", 
     RowBox[{"x3", "\[Rule]", "x3Num"}], ",", 
     RowBox[{"x4", "\[Rule]", "x4Num"}], ",", 
     RowBox[{"x5", "\[Rule]", "x5Num"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717524862310693*^9, 3.7175248862558527`*^9}, {
  3.717532079044788*^9, 3.717532085028463*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"d4Xs", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717531759007806*^9, 3.7175317637098837`*^9}, {
  3.717748816808289*^9, 3.717748817146017*^9}, {3.717748895909293*^9, 
  3.717748896074374*^9}, {3.7177490020883017`*^9, 3.717749002380991*^9}, {
  3.71774969954734*^9, 3.717749699779861*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"baseNum", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"base", "/.", "num"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717749360814973*^9, 3.717749362521278*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"isGood", "[", "x_", "]"}], ":=", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"baseNum", ",", 
     RowBox[{"x", "/.", "num"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717748441225418*^9, 3.717748466828643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"len", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.717531939461928*^9, 3.717531941669343*^9}, {
  3.717748822226533*^9, 3.717748822585375*^9}, {3.717748899784136*^9, 
  3.7177488999268436`*^9}, {3.717749006049078*^9, 3.717749006306943*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"xs", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "}"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "len"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717531937335643*^9, 3.7175319548356752`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"targets", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"base", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Variables", "[", "#", "]"}], "===", 
          RowBox[{"xs", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "i"}], "]"}], "]"}]}], "&"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "len"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717747472429068*^9, 3.71774751420539*^9}, {
  3.717747560742216*^9, 3.717747593378622*^9}, {3.717747869983876*^9, 
  3.717747873220318*^9}, {3.717748836879538*^9, 3.717748847082415*^9}, {
  3.7177489948169537`*^9, 3.717748995395252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"opts", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x1", ",", "x2"}], "}"}], "\[Rule]", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Permutations", "/@", 
       RowBox[{"Subsets", "[", 
        RowBox[{"base", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "1"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7177501534980392`*^9, 3.717750165522036*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"step", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"step", "[", "i", "]"}], "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"opts", "[", "i", "]"}], ",", 
      RowBox[{
       RowBox[{"isGood", "[", 
        RowBox[{
         RowBox[{"targets", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "/.", "#"}], "]"}], "&"}]}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71775018425226*^9, 3.717750203923725*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"opts", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"opts", "[", "i", "]"}], "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"step", "[", 
              RowBox[{"i", "-", "1"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"xs", "[", 
              RowBox[{"[", 
               RowBox[{"i", "+", "1"}], "]"}], "]"}], "\[Rule]", "#"}]}], 
           "]"}], "&"}], "/@", "base"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"step", "[", 
            RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      "1"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717750211822497*^9, 3.7177502811371813`*^9}, {
  3.717750417656123*^9, 3.717750418009671*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"step", "[", "1", "]"}], ";"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"Length", "[", 
    RowBox[{"step", "[", "1", "]"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.717750301803606*^9, 3.717750329736691*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7.`*^-6", ",", "360"}], "}"}]], "Output",
 CellChangeTimes->{3.717750330910112*^9, 3.7177504283892307`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"opts", "[", "2", "]"}], ";"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"Length", "[", 
    RowBox[{"opts", "[", "2", "]"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.717750391950583*^9, 3.717750399325184*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.17842`", ",", "37440"}], "}"}]], "Output",
 CellChangeTimes->{3.717750400299411*^9, 3.717750430649448*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"step", "[", "2", "]"}], ";"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"Length", "[", 
    RowBox[{"step", "[", "2", "]"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.717750301803606*^9, 3.717750329736691*^9}, {
  3.71775043909909*^9, 3.717750441050788*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.533857`", ",", "1776"}], "}"}]], "Output",
 CellChangeTimes->{
  3.717750330910112*^9, {3.7177504283892307`*^9, 3.717750445107189*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"opts", "[", "3", "]"}], ";"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"Length", "[", 
    RowBox[{"opts", "[", "3", "]"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.717750391950583*^9, 3.717750399325184*^9}, {
  3.717750456818829*^9, 3.717750460126274*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.829005`", ",", "184704"}], "}"}]], "Output",
 CellChangeTimes->{3.717750400299411*^9, 3.717750430649448*^9, 
  3.717750461413419*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{
      RowBox[{"step", "[", "3", "]"}], ";"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", 
   RowBox[{"Length", "[", 
    RowBox[{"step", "[", "3", "]"}], "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.717750468787614*^9, 3.71775047188769*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"26.393175`", ",", "4416"}], "}"}]], "Output",
 CellChangeTimes->{3.717750498775906*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"final", "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"step", "[", "3", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"base", "/.", "#"}], ")"}], "/.", "num"}], "]"}], "===", 
        "baseNum"}], "&"}]}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.717750565555645*^9, 3.717750566784086*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"52.714997`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.71775062824302*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "final", "]"}]], "Input",
 CellChangeTimes->{{3.717750633736939*^9, 3.717750635564055*^9}}],

Cell[BoxData["48"], "Output",
 CellChangeTimes->{3.7177506360816813`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{840, 1006},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 287, 4, 114, "Title"],
Cell[870, 28, 368, 9, 66, "Input"],
Cell[1241, 39, 1659, 52, 144, "Input"],
Cell[2903, 93, 450, 11, 39, "Input"],
Cell[3356, 106, 359, 7, 39, "Input"],
Cell[3718, 115, 202, 5, 39, "Input"],
Cell[3923, 122, 264, 7, 39, "Input"],
Cell[4190, 131, 281, 5, 39, "Input"],
Cell[4474, 138, 305, 8, 39, "Input"],
Cell[4782, 148, 785, 20, 66, "Input"],
Cell[5570, 170, 545, 17, 66, "Input"],
Cell[6118, 189, 487, 15, 39, "Input"],
Cell[6608, 206, 1023, 30, 118, "Input"],
Cell[CellGroupData[{
Cell[7656, 240, 350, 10, 39, "Input"],
Cell[8009, 252, 147, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8193, 260, 350, 10, 39, "Input"],
Cell[8546, 272, 148, 3, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8731, 280, 398, 11, 39, "Input"],
Cell[9132, 293, 177, 4, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9346, 302, 399, 11, 39, "Input"],
Cell[9748, 315, 175, 4, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9960, 324, 349, 10, 39, "Input"],
Cell[10312, 336, 127, 3, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10476, 344, 471, 14, 39, "Input"],
Cell[10950, 360, 126, 3, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11113, 368, 129, 2, 39, "Input"],
Cell[11245, 372, 73, 1, 39, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

