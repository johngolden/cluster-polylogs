(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18807,        473]
NotebookOptionsPosition[     18053,        443]
NotebookOutlinePosition[     18456,        461]
CellTagsIndexPosition[     18413,        458]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Q: Prove A2 functions are a basis", "Title",
 CellChangeTimes->{{3.7155216343483543`*^9, 3.715521661935596*^9}, {
   3.7155217024191933`*^9, 3.715521776747312*^9}, {3.715697106466093*^9, 
   3.715697132670868*^9}, 3.717339565784286*^9, {3.717596412665661*^9, 
   3.7175964295471077`*^9}, 3.7190772318918056`*^9, {3.719161602248806*^9, 
   3.719161617724811*^9}, 3.7191622907219543`*^9, {3.719330906137623*^9, 
   3.719330919779743*^9}, 3.7214675803034782`*^9, {3.722256568008562*^9, 
   3.722256584333577*^9}, {3.7222587062837543`*^9, 3.7222587099149513`*^9}, 
   3.723892693455821*^9, {3.723910170409132*^9, 3.723910179723064*^9}, {
   3.7247613005595207`*^9, 3.724761305849478*^9}, {3.7251093997280607`*^9, 
   3.725109422520021*^9}, {3.725109486952263*^9, 3.725109487141718*^9}, {
   3.7253796263545513`*^9, 3.725379627752042*^9}, {3.7262081679226522`*^9, 
   3.726208187405767*^9}, {3.7262310495952473`*^9, 3.726231058788488*^9}, {
   3.727099108843804*^9, 3.727099123185153*^9}, {3.727512928109139*^9, 
   3.727512933417872*^9}, {3.72821639588512*^9, 3.728216402599391*^9}, {
   3.730102925667328*^9, 3.730102926024365*^9}, {3.732289648831846*^9, 
   3.73228965611917*^9}, 3.733229848125965*^9, {3.735926990223662*^9, 
   3.735926991974353*^9}, {3.736155977439673*^9, 3.736155983903709*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "tools.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.713271961760497*^9, 3.7132719819312153`*^9}, {
  3.713272319095078*^9, 3.713272323693686*^9}, {3.7132801678394003`*^9, 
  3.7132801680639467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"e6a2s", "=", 
   RowBox[{
    RowBox[{"subalgSeed", "[", 
     RowBox[{"e6", "[", "]"}], "]"}], "/@", 
    RowBox[{
     RowBox[{"subalg", "[", 
      RowBox[{"e6", "[", "]"}], "]"}], "[", "a2", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737375430432701*^9, 3.737375444979865*^9}, {
  3.7373754874922657`*^9, 3.737375510291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a2B2b2", "[", "n_", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "answer"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "=", 
       RowBox[{"1", "/", "x1"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"x", "[", "2", "]"}], "=", "x2"}], ";", "\n", 
      RowBox[{
       RowBox[{"x", "[", "3", "]"}], "=", 
       RowBox[{
        RowBox[{"clean", "[", "n", "]"}], "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "x2"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"1", "/", "x1"}], ")"}]}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"x", "[", "4", "]"}], "=", 
       RowBox[{
        RowBox[{"clean", "[", "n", "]"}], "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x2", "+", 
            RowBox[{"(", 
             RowBox[{"1", "/", "x1"}], ")"}]}], " ", ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "x1"}], ")"}], " ", "x2"}], ")"}]}], ")"}], 
        "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"x", "[", "5", "]"}], "=", 
       RowBox[{
        RowBox[{"clean", "[", "n", "]"}], "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"(", 
            RowBox[{"1", "/", "x1"}], ")"}]}], ")"}], "/", "x2"}], "]"}]}], 
      ";", "\n", 
      RowBox[{"answer", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3"}], " ", 
         RowBox[{"wedge", "[", 
          RowBox[{
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "1", "]"}], "]"}], ",", 
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "2", "]"}], "]"}]}], "]"}]}], "-", 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "1", "]"}], "]"}], ",", 
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "3", "]"}], "]"}]}], "]"}], "+", 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "1", "]"}], "]"}], ",", 
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "4", "]"}], "]"}]}], "]"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"wedge", "[", 
          RowBox[{
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "1", "]"}], "]"}], ",", 
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "5", "]"}], "]"}]}], "]"}]}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"wedge", "[", 
          RowBox[{
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "2", "]"}], "]"}], ",", 
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "3", "]"}], "]"}]}], "]"}]}], "-", 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "2", "]"}], "]"}], ",", 
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "4", "]"}], "]"}]}], "]"}], "+", 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "2", "]"}], "]"}], ",", 
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "5", "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"wedge", "[", 
          RowBox[{
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "3", "]"}], "]"}], ",", 
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "4", "]"}], "]"}]}], "]"}]}], "-", 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "3", "]"}], "]"}], ",", 
          RowBox[{"cb2", "[", 
           RowBox[{"x", "[", "5", "]"}], "]"}]}], "]"}], "-", 
        RowBox[{"3", " ", 
         RowBox[{"wedge", "[", 
          RowBox[{
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "4", "]"}], "]"}], ",", 
           RowBox[{"cb2", "[", 
            RowBox[{"x", "[", "5", "]"}], "]"}]}], "]"}]}]}]}], ";", "\n", 
      RowBox[{"Return", "[", "answer", "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.737375630220113*^9, 3.737375642011305*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], 
      RowBox[{
       RowBox[{"b2b2", "[", "7", "]"}], "[", 
       RowBox[{
        RowBox[{"a2B2b2", "[", "7", "]"}], "@", 
        RowBox[{"(", 
         RowBox[{"g47ify", "/@", 
          RowBox[{"e6a2s", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "e6a2s", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7373755006282682`*^9, 3.737375503051346*^9}, {
  3.737375536914906*^9, 3.737375601267054*^9}, {3.737375657749061*^9, 
  3.737375658013567*^9}, {3.737375693924221*^9, 3.7373757240648117`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "ansatz", "]"}], ",", 
     RowBox[{"tensor", "[", "___", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737376121999363*^9, 3.737376141180265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffs", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{"ansatz", ",", "vars"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737376154601406*^9, 3.737376173194063*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varCoeffs", "=", 
   RowBox[{"Variables", "[", "coeffs", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737376174435483*^9, 3.737376175002469*^9}, {
  3.737376235322175*^9, 3.737376247568495*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"coeffs", ",", "varCoeffs"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737376258187394*^9, 3.737376271280085*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixRank", "[", "eqs", "]"}], "eqs"}]], "Input",
 CellChangeTimes->{{3.737376273323011*^9, 3.737376281389503*^9}, {
  3.737376406052417*^9, 3.737376406366375*^9}}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[
               SparseArray[
                Automatic, {10, 10}, 0.93, {
                 1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                   10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 
                0}, {10, 10}}, {0, 1}], Frame -> False, Axes -> False, 
               AspectRatio -> 1, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], Frame -> True, 
               FrameTicks -> None, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameLabel -> {None, None}, 
               FrameTicks -> {{None, None}, {None, None}}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2140096", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"622944", ",", "504"}], "}"}], "SummaryItem"]}]}},
                GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[
               RasterBox[
               SparseArray[
                Automatic, {10, 10}, 0.93, {
                 1, {{0, 1, 1, 4, 4, 5, 6, 6, 8, 10, 13}, {{4}, {6}, {7}, {
                   10}, {5}, {9}, {3}, {8}, {5}, {7}, {2}, {3}, {7}}}, {0., 
                  0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.}}], {{0, 
                0}, {10, 10}}, {0, 1}], Frame -> False, Axes -> False, 
               AspectRatio -> 1, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}], Frame -> True, 
               FrameTicks -> None, FrameStyle -> Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameLabel -> {None, None}, 
               FrameTicks -> {{None, None}, {None, None}}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["2140096", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"622944", ",", "504"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.006816378714976342`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    RowBox[{"-", "5"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "17"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "5", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "49"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "5", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "50"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    "5", ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                    False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<2140096>, {622944, 504}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.737376274359293*^9}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"local2",
WindowSize->{1280, 1396},
WindowMargins->{{Automatic, 276}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1302, 17, 114, "Title"],
Cell[1885, 41, 368, 9, 66, "Input"],
Cell[2256, 52, 371, 10, 39, "Input"],
Cell[2630, 64, 4266, 121, 300, "Input"],
Cell[6899, 187, 765, 21, 39, "Input"],
Cell[7667, 210, 276, 7, 39, "Input"],
Cell[7946, 219, 310, 8, 39, "Input"],
Cell[8259, 229, 232, 5, 39, "Input"],
Cell[8494, 236, 274, 7, 39, "Input"],
Cell[CellGroupData[{
Cell[8793, 247, 200, 4, 39, "Input"],
Cell[8996, 253, 9029, 186, 74, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

