(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18030,        472]
NotebookOptionsPosition[     17368,        445]
NotebookOutlinePosition[     17748,        462]
CellTagsIndexPosition[     17705,        459]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "tools.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.710544703731085*^9, 3.7105447218174133`*^9}, {
  3.710545037599579*^9, 3.710545040249243*^9}, {3.710545086638508*^9, 
  3.7105450892339478`*^9}}],

Cell[CellGroupData[{

Cell["Generating and Labeling Subalgebras", "Title",
 CellChangeTimes->{{3.710257129383018*^9, 3.710257137510057*^9}}],

Cell[BoxData[
 RowBox[{"\"\<\nsubalg[rank_][clusters_]:= lists all subalgebras of `rank` \
wholly contained in `clusters`.\n\nNote: in all of the code that follows it \
is necessary that clusters come with coords. \n\nSubalgebras are written at \
the end of a coord, for example {1,2,3,a2a2[4,2]}.\n\nNote that subalgebras \
generated from the origin, i.e. coord {}, will look a little\nfunny. For \
example, in x1->x2->x3, the A1 x A1 generated by x1 and x3 is written as \n\
{a1a1[1,3]}.\n\nFor the purpose of writing emails and in papers I propose the \
notation (coord)[subalg], e.g.:\n\n(123)[25] is an A2 subalgebra starting at \
coord (123) and generated by nodes 2 & 5\n(123)[25,43] is an A2 x A2 \
subalgebra starting at coord (123) with A2's 2->5 and 4->3\n\nDn algebras are \
a bit trickier to write. In tex we could use superscript + subscript,\ne.g. \
(123)[\!\(\*SubscriptBox[SuperscriptBox[\(61\), \(2\)], \(4\)]\)]. We could \
also use a / to delineate the 'A(n-2)' portion from \nthe 'prongs', e.g. \
(123)[61/24]; this has the benefit of being usable in emails. \n\n\>\"", 
  ";"}]], "Input",
 CellChangeTimes->{{3.7102571568717747`*^9, 3.710257295889076*^9}, {
  3.710257344387957*^9, 3.710257378511601*^9}, {3.710257478227352*^9, 
  3.710257641731586*^9}, {3.710257777387521*^9, 3.710258166129319*^9}, {
  3.710258482368939*^9, 3.710258986137166*^9}, {3.710490165611559*^9, 
  3.71049031871729*^9}, {3.710490349228387*^9, 3.7104904299822493`*^9}, {
  3.710495061964425*^9, 3.7104950672006683`*^9}, {3.710539710707017*^9, 
  3.7105397117916317`*^9}, {3.7105437710303373`*^9, 3.710543902343799*^9}, {
  3.710543967305112*^9, 3.710543967869484*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"subsCanonSeeded", "[", "algSeed_", "]"}], "[", "cluster_", 
     "]"}], ":=", " ", 
    RowBox[{
    "finds", " ", "subsets", " ", "of", " ", "`cluster`", " ", "that", " ", 
     "are", " ", "in", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"canonical", "'"}], " ", "form", "\n", "of", " ", "a", " ", 
     "subalgebra", " ", "of", " ", "type", " ", "`algSeed`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"'", 
        RowBox[{"canonical", "'"}], " ", "form", " ", "means", " ", "x1"}], "->", 
       RowBox[{"x2", "->", 
        RowBox[{
         RowBox[{"x3", " ", "or", " ", "x2"}], "->", 
         RowBox[{"x3", "->", 
          RowBox[{
           RowBox[{
            RowBox[{"x1", " ", "but", " ", "not", " ", "x1"}], "<", 
            RowBox[{"-", "x2"}]}], "->", 
           RowBox[{"x3", "."}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"subsCanonSeeded", "[", "algSeed_", "]"}], "[", "cluster_", 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "xs", ",", "b", ",", "subIndicesTotal", ",", "subMatrices", ",", 
        "posGood", ",", "subIndicesGood", ",", "ret"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xs", "=", 
        RowBox[{"cluster", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"cluster", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subIndicesTotal", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Permutations", "/@", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "xs", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Length", "[", 
               RowBox[{"algSeed", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}], "}"}]}], "]"}]}], ",", 
          "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"subMatrices", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"f", "@@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", "#"}], "}"}], "&"}], "/@", 
             "subIndicesTotal"}], ")"}]}], ")"}], "/.", 
         RowBox[{
          RowBox[{"f", "[", "a__", "]"}], "\[RuleDelayed]", 
          RowBox[{"b", "[", 
           RowBox[{"[", "a", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"posGood", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"subMatrices", ",", 
          RowBox[{"algSeed", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"subIndicesGood", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"subIndicesTotal", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Flatten", "[", "posGood", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ret", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Gather", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"xs", "[", 
              RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "subIndicesGood"}],
            ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Sort", "[", "#1", "]"}], "\[Equal]", 
             RowBox[{"Sort", "[", "#2", "]"}]}], "&"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.7104990158907146`*^9, 3.7104990168222723`*^9}, {
  3.710514906499134*^9, 3.710514917412438*^9}, {3.710515500614464*^9, 
  3.710515501083991*^9}, {3.710515855024459*^9, 3.710515868355443*^9}, {
  3.710515920138565*^9, 3.710515923086258*^9}, {3.710516599519376*^9, 
  3.71051666131109*^9}, {3.710539729125443*^9, 3.710539729980351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"algOfRank", "[", 
     RowBox[{"[", "i", "]"}], "]"}], " ", "gives", " ", "a", " ", "list", " ",
     "of", " ", "algebras", " ", "of", " ", "rank", " ", "i"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"algOfRank", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "\"\<a1\>\"", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<a2\>\"", ",", "\"\<a1a1\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<a3\>\"", ",", "\"\<a2a1\>\"", ",", "\"\<a1a1a1\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<d4\>\"", ",", "\"\<a4\>\"", ",", "\"\<a3a1\>\"", ",", 
        "\"\<a2a2\>\"", ",", "\"\<a2a1a1\>\"", ",", "\"\<a1a1a1a1\>\""}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<d5\>\"", ",", "\"\<d4a1\>\"", ",", "\"\<a4a1\>\"", ",", 
        "\"\<a3a2\>\"", ",", "\"\<a3a1a1\>\"", ",", "\"\<a2a2a1\>\"", ",", 
        "\"\<a2a1a1a1\>\"", ",", "\"\<a1a1a1a1a1\>\""}], "}"}]}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.710497406172803*^9, 3.710497546326357*^9}, 
   3.710497577468033*^9, {3.7104990421139593`*^9, 3.7104990929576387`*^9}, {
   3.710502451361876*^9, 3.710502455161487*^9}, {3.7105447305008173`*^9, 
   3.710544794575676*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"subsCanon", "[", "rank_", "]"}], "[", "cluster_", "]"}], ":=", 
    " ", 
    RowBox[{
    "finds", " ", "subsets", " ", "of", " ", "`cluster`", " ", "that", " ", 
     "are", " ", "in", " ", 
     RowBox[{"the", " ", "'"}], 
     RowBox[{"canonical", "'"}], " ", "form", "\n", "of", " ", "a", " ", 
     "subalgebra", " ", "of", " ", 
     RowBox[{"`rank`", "."}]}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"subsCanon", "[", "rank_", "]"}], "[", "cluster_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"subsCanonSeeded", "[", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"#", "<>", "\"\<Seed\>\""}], "]"}], "]"}], "[", "cluster", 
         "]"}]}], "}"}], "&"}], "/@", 
     RowBox[{"algOfRank", "[", 
      RowBox[{"[", "rank", "]"}], "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7104989823678083`*^9, 3.710498987961749*^9}, {
   3.7104990238878927`*^9, 3.7104990299428*^9}, {3.710499177941399*^9, 
   3.710499345755514*^9}, 3.710539751624074*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"finally", " ", "we", " ", "get", " ", "to", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"subalg", "[", "rank_", "]"}], "[", "clusters_", "]"}], " ", 
      "--"}], " ", "this", " ", "is", " ", "poorly", " ", "written", " ", 
     "and", " ", "can", " ", "be", " ", "cleaned"}], "+", 
    RowBox[{"sped", " ", "up", " ", "if", " ", "necessary"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"subalg", "[", "rank_", "]"}], "[", "clusters_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "groups", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"groups", "=", 
        RowBox[{"Gather", "[", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "@@@", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", 
                RowBox[{
                 RowBox[{"subsCanon", "[", "rank", "]"}], "[", "#", "]"}]}], 
               ")"}], "&"}], "/@", "clusters"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#1", "/.", 
              RowBox[{
               RowBox[{"a_String", "[", "x__", "]"}], "\[RuleDelayed]", 
               RowBox[{"Sort", "[", 
                RowBox[{"Sort", "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{"ToExpression", "[", "a", "]"}], "[", "x", 
                    "]"}]}], ")"}]}], "]"}]}]}], ")"}], "===", 
            RowBox[{"(", 
             RowBox[{"#2", "/.", 
              RowBox[{
               RowBox[{"a_String", "[", "x__", "]"}], "\[RuleDelayed]", 
               RowBox[{"Sort", "[", 
                RowBox[{"Sort", "/@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                   RowBox[{
                    RowBox[{"ToExpression", "[", "a", "]"}], "[", "x", 
                    "]"}]}], ")"}]}], "]"}]}]}], ")"}]}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{"Sort", "/@", 
           RowBox[{"(", 
            RowBox[{"groups", "/.", 
             RowBox[{
              RowBox[{"a_String", "[", "x__", "]"}], ":>", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"tmp", "=", 
                  RowBox[{"clusters", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Intersection", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"Position", "[", 
                    RowBox[{"clusters", ",", "#"}], "]"}]}], "&"}], "/@", 
                    RowBox[{"{", "x", "}"}]}], ")"}]}], ")"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}], 
                ",", 
                RowBox[{"Append", "[", 
                 RowBox[{
                  RowBox[{"tmp", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{"a", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"tmp", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "#"}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
                    RowBox[{"{", "x", "}"}]}], ")"}]}]}], "]"}]}], "]"}]}]}], 
            ")"}]}], ")"}]}], "]"}], ";"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.710541183003524*^9, 3.71054121386862*^9}, {
  3.710541365759336*^9, 3.710541391681737*^9}, {3.710541486512273*^9, 
  3.710541501479965*^9}, {3.710541858872566*^9, 3.710541879432124*^9}, {
  3.71054420959369*^9, 3.7105442187740917`*^9}, {3.710544799873678*^9, 
  3.7105448287213497`*^9}, {3.71054512731812*^9, 3.71054516870242*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"subalg", "[", "3", "]"}], "[", 
  RowBox[{"d4", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.710542882453051*^9, 3.7105428829908333`*^9}, {
   3.710542970261051*^9, 3.7105429759746027`*^9}, 3.71054341570494*^9, {
   3.710543620094821*^9, 3.7105436206064453`*^9}, {3.710545112623814*^9, 
   3.710545112781341*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"a1a1a1\"\>", "[", 
     RowBox[{"1", ",", "3", ",", "4"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"\<\"a1a1a1\"\>", "[", 
      RowBox[{"1", ",", "3", ",", "4"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "4", ",", 
     RowBox[{"\<\"a1a1a1\"\>", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "1", ",", "4", ",", 
     RowBox[{"\<\"a1a1a1\"\>", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"a3\"\>", "[", 
     RowBox[{"1", ",", "2", ",", "3"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"a3\"\>", "[", 
     RowBox[{"1", ",", "2", ",", "4"}], "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"1", ",", "2", ",", "4"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"1", ",", "2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "4", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"3", ",", "1", ",", "2"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "3", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"4", ",", "1", ",", "2"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"3", ",", "2", ",", "4"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"3", ",", "2", ",", "4"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"3", ",", "1", ",", "4"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"1", ",", "4", ",", "2"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"1", ",", "3", ",", "2"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "2", ",", "4", ",", 
     RowBox[{"\<\"a3\"\>", "[", 
      RowBox[{"3", ",", "1", ",", "2"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7105425351598473`*^9, 3.710542721796677*^9, 3.71054288392864*^9, 
   3.710542976677383*^9, 3.710543093068652*^9, 3.710543416656554*^9, 
   3.7105435252674847`*^9, 3.710543622079805*^9, 3.7105448943370667`*^9, 
   3.710545066173019*^9, {3.710545096359315*^9, 3.710545115975944*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1244, 1002},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 366, 9, 66, "Input"],
Cell[CellGroupData[{
Cell[949, 33, 118, 1, 114, "Title"],
Cell[1070, 36, 1666, 23, 560, "Input"],
Cell[2739, 61, 4161, 108, 300, "Input"],
Cell[6903, 171, 1302, 32, 92, "Input"],
Cell[8208, 205, 1148, 31, 92, "Input"],
Cell[9359, 238, 4959, 122, 326, "Input"],
Cell[CellGroupData[{
Cell[14343, 364, 354, 7, 39, "Input"],
Cell[14700, 373, 2640, 68, 92, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

