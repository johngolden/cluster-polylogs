(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    127268,       3795]
NotebookOptionsPosition[    118217,       3518]
NotebookOutlinePosition[    118596,       3535]
CellTagsIndexPosition[    118553,       3532]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["solve code", "Subsection",
 CellChangeTimes->{{3.719914958649269*^9, 3.719914962880127*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solve", "[", "eqs_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x", ",", "m", ",", "b", ",", "mat", ",", "matSolve", ",", "soln", ",", 
       "isSolnGood"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"x", "=", 
       RowBox[{"Variables", "[", "eqs", "]"}]}], ";", "\n", 
      RowBox[{"m", "=", 
       RowBox[{
        RowBox[{"CoefficientArrays", "[", 
         RowBox[{"eqs", ",", "x"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
      RowBox[{"b", "=", 
       RowBox[{
        RowBox[{"-", "eqs"}], "/.", 
        RowBox[{
         RowBox[{"p", "[", "_", "]"}], ":>", "0"}]}]}], ";", "\n", 
      RowBox[{"mat", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "m", "]"}], ",", "b"}], "]"}], "]"}]}], 
      ";", "\n", 
      RowBox[{"matSolve", "=", 
       RowBox[{"Rationalize", "[", 
        RowBox[{
         RowBox[{"Chop", "[", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"RowReduce", "[", 
             RowBox[{"N", "[", "mat", "]"}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{"mat", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
           "]"}], "]"}], ",", ".0000001"}], "]"}]}], ";", "\n", 
      RowBox[{"isSolnGood", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "matSolve", "]"}], "-", 
           RowBox[{"Length", "[", 
            RowBox[{"matSolve", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "==", "0"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{"matSolve", "-", 
               RowBox[{"IdentityMatrix", "[", 
                RowBox[{"Length", "[", "matSolve", "]"}], "]"}]}], "]"}], 
             "]"}], "==", 
            RowBox[{"{", "0", "}"}]}], ",", "0", ",", "1"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"#", ",", "1", ",", "1", ",", "1"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
              "matSolve"}], "]"}], ">", 
            RowBox[{"Length", "[", "x", "]"}]}], ",", "0", ",", "1"}], 
          "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"soln", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"isSolnGood", "==", "1"}], ",", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"pos", "=", 
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"matSolve", "[", 
                   RowBox[{"[", "iii", "]"}], "]"}], ",", "1", ",", "1", ",", 
                  "1"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "pos", "]"}], "]"}], "->", 
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"matSolve", "[", 
                  RowBox[{"[", 
                   RowBox[{"iii", ",", 
                    RowBox[{
                    RowBox[{"pos", "+", "1"}], ";;", 
                    RowBox[{"-", "1"}]}]}], "]"}], "]"}], ".", 
                 RowBox[{
                  RowBox[{"Append", "[", 
                   RowBox[{"x", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"pos", "+", "1"}], ";;", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}]}], ")"}]}]}]}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"iii", ",", 
             RowBox[{"Length", "[", "matSolve", "]"}]}], "}"}]}], "]"}], ",", 
         
         RowBox[{"{", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Return", "[", "soln", "]"}], ";"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"collectPs", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", ",", "array"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Variables", "[", "x", "]"}], ",", 
         RowBox[{"p", "[", "_", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"array", "=", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"x", ",", "vars"}], "]"}]}], ";", "\n", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"array", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"vars", ".", 
         RowBox[{"Normal", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"array", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"collectTensors", "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vars", ",", "array"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"vars", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Variables", "[", "x", "]"}], ",", 
         RowBox[{"tensor", "[", "__", "]"}]}], "]"}]}], ";", "\n", 
      RowBox[{"array", "=", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"x", ",", "vars"}], "]"}]}], ";", "\n", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"array", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"vars", ".", 
         RowBox[{"Normal", "[", 
          RowBox[{"Expand", "[", 
           RowBox[{"array", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72987144770303*^9, 3.729871453550599*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tensor", "[", 
    RowBox[{"a___", ",", 
     RowBox[{"b_", "*", "c_"}], ",", "d___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Tensor", "[", 
     RowBox[{"a", ",", "b", ",", "d"}], "]"}], "+", 
    RowBox[{"Tensor", "[", 
     RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Tensor", "[", 
    RowBox[{"a___", ",", 
     RowBox[{"b_", "^", "c_"}], ",", "d___"}], "]"}], ":=", 
   RowBox[{"c", " ", 
    RowBox[{"Tensor", "[", 
     RowBox[{"a", ",", "b", ",", "d"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Tensor", "[", 
    RowBox[{"a___", ",", 
     RowBox[{"b_", "/", "c_"}], ",", "d___"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Tensor", "[", 
     RowBox[{"a", ",", "b", ",", "d"}], "]"}], "-", 
    RowBox[{"Tensor", "[", 
     RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Tensor", "[", 
     RowBox[{"a___", ",", 
      RowBox[{"b_", "?", "NumberQ"}], ",", "c___"}], "]"}], ":=", "0"}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tensorExpand", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"x", "/.", 
      RowBox[{"tensor", ":>", "Tensor"}]}], ")"}], "/.", 
    RowBox[{"Tensor", ":>", "tensor"}]}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fit", "[", "x_", "]"}], ":=", 
   RowBox[{"solve", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"List", "@@", 
       RowBox[{"collectTensors", "[", "x", "]"}]}], ")"}], "//.", 
     RowBox[{
      RowBox[{"tensor", "[", "__", "]"}], "\[RuleDelayed]", "1"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7298713650028563`*^9, 3.729871384338779*^9}, {
  3.72987146353051*^9, 3.729871485491276*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["alphabets", "Subsection",
 CellChangeTimes->{{3.719914970371683*^9, 3.719914973477695*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a2Alphabet", "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", 
     RowBox[{"x1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x2"}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}]}], "x2"], ",", 
     FractionBox[
      RowBox[{"x1", " ", "x2"}], 
      RowBox[{"1", "+", "x1"}]]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719915587711329*^9, 3.719915613160328*^9}, {
  3.7250931496829147`*^9, 3.725093164565587*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a2XcoordsRep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", "x1", ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"-", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "X1", ",", "b"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", "x2", ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", "X2", ",", "b"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", 
        RowBox[{"x1", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x2"}], ")"}]}], ",", "b___"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", "X3", ",", "b"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", 
        FractionBox[
         RowBox[{"1", "+", "x1", "+", 
          RowBox[{"x1", " ", "x2"}]}], "x2"], ",", "b___"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", "X4", ",", "b"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", 
        FractionBox[
         RowBox[{"x1", " ", "x2"}], 
         RowBox[{"1", "+", "x1"}]], ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"-", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "X5", ",", "b"}], "]"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2Explicit", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", "X1", ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"-", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "x1", ",", "b"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", "X2", ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", "x2", ",", "b"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", "X3", ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", 
        RowBox[{"x1", 
         RowBox[{"(", 
          RowBox[{"1", "+", "x2"}], ")"}]}], ",", "b"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", "X4", ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", 
        FractionBox[
         RowBox[{"1", "+", "x1", "+", 
          RowBox[{"x1", " ", "x2"}]}], "x2"], ",", "b"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a___", ",", "X5", ",", "b___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"-", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", 
         FractionBox[
          RowBox[{"x1", " ", "x2"}], 
          RowBox[{"1", "+", "x1"}]], ",", "b"}], "]"}]}]}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.725093114442459*^9, 3.725093132647943*^9}, {
  3.72509317693976*^9, 3.725093292170376*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a3Alphabet", "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", 
     FractionBox[
      RowBox[{"x1", " ", "x2"}], 
      RowBox[{"1", "+", "x1"}]], ",", 
     RowBox[{"x1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x2"}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}]}], "x2"], ",", "x3", ",", 
     RowBox[{"x2", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x3"}], ")"}]}], ",", 
     RowBox[{"x1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x2", "+", 
        RowBox[{"x2", " ", "x3"}]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{"1", "+", "x1", "+", 
       RowBox[{"x1", " ", "x2"}], "+", 
       RowBox[{"x1", " ", "x2", " ", "x3"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "x1"}], ")"}], " ", "x3"}]]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7197721022111883`*^9, 3.719772114842031*^9}, 
   3.719772364453024*^9, 3.719780204468321*^9, 3.7197811586343184`*^9, {
   3.719914267555942*^9, 3.719914269794528*^9}, {3.719915581925583*^9, 
   3.7199155854959583`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["weight 2", "Subsection",
 CellChangeTimes->{{3.719914984791234*^9, 3.7199149901069403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"alphabet", "=", "a2Alphabet"}], ";"}]], "Input",
 CellChangeTimes->{{3.719914270820632*^9, 3.719914283284379*^9}, {
  3.719915632711026*^9, 3.719915658268292*^9}, {3.725006989026065*^9, 
  3.725006989136662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Variables", "[", "alphabet", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71991393937253*^9, 3.7199139450103292`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"numEval", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"vars", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "100"}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.719913949866541*^9, 3.7199139767514343`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dLog", "[", "arg_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"vars", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Log", "[", "arg", "]"}], ",", 
        RowBox[{"vars", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7172647001703176`*^9, 3.717264745304821*^9}, {
   3.717265067829185*^9, 3.717265073926282*^9}, {3.717265523332923*^9, 
   3.717265540260006*^9}, 3.717265576650344*^9, {3.719772387356271*^9, 
   3.719772391580015*^9}, {3.719914102466428*^9, 3.719914132177369*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wedgeRules", ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"wedge", "[", 
       RowBox[{"xx___", ",", 
        RowBox[{"a_", "+", "b_"}], ",", "yy___"}], "]"}], "\[RuleDelayed]", 
      RowBox[{
       RowBox[{"wedge", "[", 
        RowBox[{"xx", ",", "a", ",", "yy"}], "]"}], "+", 
       RowBox[{"wedge", "[", 
        RowBox[{"xx", ",", "b", ",", "yy"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"wedge", "[", 
       RowBox[{"xx___", ",", 
        RowBox[{"a_", "*", 
         RowBox[{"d", "[", "x_", "]"}]}], ",", "yy___"}], "]"}], 
      "\[RuleDelayed]", 
      RowBox[{"a", " ", 
       RowBox[{"wedge", "[", 
        RowBox[{"xx", ",", 
         RowBox[{"d", "[", "x", "]"}], ",", "yy"}], "]"}]}]}], ",", 
     RowBox[{
      RowBox[{"wedge", "[", 
       RowBox[{"a_", ",", "a_"}], "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"wedge", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"{", 
           RowBox[{"a", ",", "b"}], "}"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}]}], ",", 
        RowBox[{"wedge", "[", 
         RowBox[{"a", ",", "b"}], "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"wedge", "[", 
          RowBox[{"b", ",", "a"}], "]"}]}]}], "]"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.717265770538763*^9, 3.717265813494288*^9}, {
   3.717265877102478*^9, 3.717265936094447*^9}, 3.719772160549757*^9, {
   3.719772398024316*^9, 3.719772417695689*^9}, 3.719914051332156*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2AnsatzList", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{
        RowBox[{"alphabet", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"alphabet", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "alphabet", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "alphabet", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7197721196516733`*^9, 3.7197721379286337`*^9}, {
  3.7197723680779*^9, 3.719772377890497*^9}, {3.719914144012299*^9, 
  3.7199141477338467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2Ansatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "w2AnsatzList", "]"}], "]"}]}], ")"}], ".", 
    "w2AnsatzList"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719914153489924*^9, 3.719914155001597*^9}, {
  3.719914296384759*^9, 3.7199142974515257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2dLog", "=", 
   RowBox[{
    RowBox[{"w2Ansatz", "/.", 
     RowBox[{
      RowBox[{"tensor", "[", 
       RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"wedge", "[", 
       RowBox[{
        RowBox[{"dLog", "[", "a", "]"}], ",", 
        RowBox[{"dLog", "[", "b", "]"}]}], "]"}]}]}], "//.", "wedgeRules"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.719914197472579*^9, 3.719914210858232*^9}, {
  3.71991430227035*^9, 3.719914303556121*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wedges", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "w2dLog", "]"}], ",", 
     RowBox[{"wedge", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719914216081603*^9, 3.71991422956423*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2EqsInit", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{"w2dLog", ",", "wedges"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719780410111075*^9, 3.7197804634821243`*^9}, {
  3.7199141591487617`*^9, 3.719914192312685*^9}, {3.719914234216734*^9, 
  3.7199142413711643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2TaylorExp", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ser", "[", 
             RowBox[{"w2EqsInit", "[", 
              RowBox[{"[", "ii", "]"}], "]"}], "]"}], "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"vars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "3"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], 
           ")"}], "/.", 
          RowBox[{
           RowBox[{
            RowBox[{"ser", "[", "a_", "]"}], "[", "b__", "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"Series", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}], "//.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"vars", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "\[Rule]", 
           RowBox[{"X", "[", "i", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w2EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"ii", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "w2EqsInit", "]"}]}], "}"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7199145902150097`*^9, 3.7199146986500673`*^9}, {
  3.7199147875753927`*^9, 3.7199147997*^9}, {3.719915736063532*^9, 
  3.719915739346169*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2TaylorExpEqs", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"w2TaylorExp", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"X", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "vars", "]"}], "]"}]}]}], "]"}]}], "]"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719914394324697*^9, 3.719914403542997*^9}, {
  3.719914605570013*^9, 3.7199146083330383`*^9}, {3.7199148352836857`*^9, 
  3.719914859846924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2Soln", "=", 
   RowBox[{"solve", "[", "w2TaylorExpEqs", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719915021525976*^9, 3.719915038246346*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w2EqsInit", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "numEval"}], ")"}], "/.", 
          "w2Soln"}], "//", "Expand"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "w2EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "w2EqsInit", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], "]"}]}], ";", 
  RowBox[{"check", "\[Equal]", 
   RowBox[{"{", "0", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.719915349994891*^9, 3.719915397938978*^9}, {
  3.7199154335537367`*^9, 3.719915435458828*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7199154008286247`*^9, 3.719915436212875*^9, 
  3.719915663947118*^9, 3.721407554206176*^9, 3.7214075990278797`*^9, 
  3.721749446638348*^9, 3.721751894676951*^9, 3.7217520332479973`*^9, 
  3.725007000230337*^9, 3.725036997263543*^9, 3.72504042473491*^9, 
  3.725093509409165*^9, 3.729852758806178*^9, 3.729871048511086*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2Basis", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"w2Ansatz", "//.", "w2Soln"}], ",", 
         RowBox[{"p", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "w2Ansatz", "]"}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7199150426605177`*^9, 3.719915126462996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goods", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"X1", ",", "X2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X2", ",", "X3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X3", ",", "X4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X4", ",", "X5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X5", ",", "X1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X2", ",", "X1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X3", ",", "X2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X4", ",", "X3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X5", ",", "X4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X1", ",", "X5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X1", ",", "X1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X2", ",", "X2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X3", ",", "X3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X4", ",", "X4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"X5", ",", "X5"}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"w2Basis", "//.", "a2XcoordsRep"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725040428311413*^9, 3.725040442484074*^9}, {
  3.725040685523015*^9, 3.7250406886056356`*^9}, {3.725093191320801*^9, 
  3.72509319711075*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2BasisBads", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "tmp", "]"}], ",", 
     RowBox[{
      RowBox[{"#", "/.", 
       RowBox[{
        RowBox[{"tensor", "[", "a__", "]"}], "\[RuleDelayed]", 
        RowBox[{"!", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"goods", ",", 
           RowBox[{"{", "a", "}"}]}], "]"}]}]}]}], "&"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725007656165476*^9, 3.725007745919237*^9}, {
  3.72504073544276*^9, 3.725040766523053*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "tmp", "]"}], "]"}]}], ")"}], ".", "tmp"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725040824836896*^9, 3.725040826465382*^9}, {
  3.7250933838005123`*^9, 3.725093384180983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w2BasisAdj", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"(", 
         RowBox[{"tmp", "//.", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Coefficient", "[", 
                   RowBox[{"tmp", ",", "#"}], "]"}], "&"}], "/@", 
                 "w2BasisBads"}], ")"}], ")"}], "\[Equal]", "0"}], "]"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ")"}], "//.", 
      RowBox[{
       RowBox[{"p", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], ")"}], "//.", 
    "a2Explicit"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7250407742550898`*^9, 3.725040853599792*^9}, {
  3.725093397232316*^9, 3.725093447126*^9}, {3.725093478773481*^9, 
  3.725093493712769*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "w2BasisAdj", "]"}]], "Input",
 CellChangeTimes->{{3.729871051547386*^9, 3.7298710560273457`*^9}}],

Cell[BoxData["14"], "Output",
 CellChangeTimes->{3.7298710565646143`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"p", "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "w2Basis", "]"}], "]"}]}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"w2Basis", "//.", "a2XcoordsRep"}], ")"}]}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"tensor", "[", 
      RowBox[{"X2", ",", "X2"}], "]"}], "+", 
     RowBox[{"tensor", "[", 
      RowBox[{"X2", ",", "X5"}], "]"}], "-", 
     RowBox[{"tensor", "[", 
      RowBox[{"X5", ",", "X2"}], "]"}], "-", 
     RowBox[{"tensor", "[", 
      RowBox[{"X5", ",", "X5"}], "]"}]}], ")"}]}], "//", "fit"}]], "Input",
 CellChangeTimes->{{3.729876242889489*^9, 3.729876292694274*^9}, {
  3.729877234524727*^9, 3.729877234596321*^9}, {3.7298773400411263`*^9, 
  3.7298773640276747`*^9}, {3.729877397261012*^9, 3.7298774049995127`*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{{3.729876246088067*^9, 3.729876293059874*^9}, 
   3.7298772351245813`*^9, 3.729877364686742*^9, {3.729877398463171*^9, 
   3.7298774055862217`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"w2BasisAdj", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "//.", "a2XcoordsRep"}]], "Input",
 CellChangeTimes->{{3.7298762980578403`*^9, 3.729876315814805*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tensor", "[", 
   RowBox[{"X1", ",", "X2"}], "]"}], "+", 
  RowBox[{"tensor", "[", 
   RowBox[{"X1", ",", "X5"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.729876304617622*^9, 3.7298763162229013`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["weight 3", "Subsection",
 CellChangeTimes->{{3.729865754820895*^9, 3.729865756337058*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w1Basis", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"tensor", "[", 
      RowBox[{"alphabet", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "alphabet", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.729865783516653*^9, 3.729865818039804*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3AnsatzList", "=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"f", ",", "w2BasisAdj", ",", "w1Basis"}], "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"x___", ",", 
            RowBox[{"a_", "+", "b_"}], ",", "y___"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"x", ",", "a", ",", "y"}], "]"}], "+", 
           RowBox[{"f", "[", 
            RowBox[{"x", ",", "b", ",", "y"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"x___", ",", 
            RowBox[{"-", "a_"}], ",", "y___"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"-", 
           RowBox[{"f", "[", 
            RowBox[{"x", ",", "a", ",", "y"}], "]"}]}]}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"tensor", "[", "a__", "]"}], ",", 
        RowBox[{"tensor", "[", "b__", "]"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729865830576171*^9, 3.729865837454732*^9}, {
  3.729871078584888*^9, 3.729871082849978*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Ansatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "w3AnsatzList", "]"}], "]"}]}], ")"}], ".", 
    "w3AnsatzList"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7298658718749943`*^9, 3.729865876121682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3LastExp", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w3Ansatz", "/.", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"tensor", "[", "a", "]"}], 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"dLog", "[", "b", "]"}], ",", 
          RowBox[{"dLog", "[", "c", "]"}]}], "]"}]}]}]}], ")"}], "//.", 
    "wedgeRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72986588399928*^9, 3.729865897399252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tensors", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "w3LastExp", "]"}], ",", 
     RowBox[{"tensor", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729865908097104*^9, 3.729865910540441*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3EqsInit", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{"#", ",", "tensors"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"w3LastExp", ",", "wedges"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72986591845809*^9, 3.729865926256227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3TaylorExp", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TimeConstrained", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ser", "[", 
                 RowBox[{"w3EqsInit", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "]"}], "@@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "3"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], 
               ")"}], "/.", 
              RowBox[{
               RowBox[{
                RowBox[{"ser", "[", "a_", "]"}], "[", "b__", "]"}], 
               "\[RuleDelayed]", 
               RowBox[{"Series", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}], "//.", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "\[Rule]", 
               RowBox[{"X", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ",",
            "15"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "$Aborted"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7199145902150097`*^9, 3.7199146986500673`*^9}, {
   3.7199147875753927`*^9, 3.7199147997*^9}, {3.719915240741102*^9, 
   3.719915255658091*^9}, {3.719915725337269*^9, 3.71991572917594*^9}, {
   3.71991589644422*^9, 3.719915897083332*^9}, 3.7199159594781237`*^9, {
   3.721749434380785*^9, 3.721749441575987*^9}, {3.721751850925799*^9, 
   3.721751871298616*^9}, {3.721751923918041*^9, 3.721751953492519*^9}, {
   3.721752016352873*^9, 3.7217520248047457`*^9}, {3.729865941946946*^9, 
   3.729865944783135*^9}, {3.7298659815295067`*^9, 3.72986598383536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3TaylorExpEqs", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"w3TaylorExp", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"X", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "vars", "]"}], "]"}]}]}], "]"}]}], "]"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729866000566588*^9, 3.729866003921871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Soln", "=", 
   RowBox[{"solve", "[", "w3TaylorExpEqs", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7198255733246803`*^9, 3.719825609221983*^9}, 
   3.7198256599717407`*^9, {3.719826022207017*^9, 3.7198260267957373`*^9}, {
   3.719827141397127*^9, 3.7198271428369417`*^9}, {3.719915309473819*^9, 
   3.71991531755264*^9}, {3.729866023961059*^9, 3.729866026267393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3EqsInit2", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"collectPs", "[", 
         RowBox[{
          RowBox[{"collectPs", "[", 
           RowBox[{"w3EqsInit", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], "//.", "w3Soln"}], "]"}], 
        "/.", 
        RowBox[{
         RowBox[{"a_", "*", 
          RowBox[{"p", "[", "b_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Together", "[", "a", "]"}], 
          RowBox[{"p", "[", "b", "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "ii"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721988358173491*^9, 3.721988361691494*^9}, {
  3.72198840458879*^9, 3.721988494838037*^9}, {3.721988544946871*^9, 
  3.721988593288219*^9}, {3.72986604429613*^9, 3.729866052533051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w3EqsInit2", "=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{"w3EqsInit2", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.721990098104023*^9, 3.721990126564876*^9}, {
  3.729866056423438*^9, 3.729866076625519*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7298660770918417`*^9, 3.729871096756508*^9, 
  3.729871156325746*^9, 3.729876535600821*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w3EqsInit", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "numEval"}], ")"}], "//.", 
          "w3Soln"}], "//", "Expand"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], "]"}]}], ";", 
  RowBox[{"check", "\[Equal]", 
   RowBox[{"{", "0", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.719915349994891*^9, 3.7199154294802217`*^9}, 
   3.7219913767588243`*^9, 3.7219915131502237`*^9, {3.729866080470913*^9, 
   3.729866089573677*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7199154008286247`*^9, {3.7199154429956617`*^9, 3.719915462190464*^9}, 
   3.721407558178978*^9, 3.72175275841094*^9, 3.7219913987360067`*^9, 
   3.721991705393016*^9, {3.7250370371300173`*^9, 3.725037047359942*^9}, 
   3.725037993913431*^9, 3.725038342411951*^9, 3.725093562856867*^9, 
   3.72986609035023*^9, 3.7298711589772873`*^9, 3.729876535851766*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Basis", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"w3Ansatz", "//.", "w3Soln"}], ",", 
         RowBox[{"p", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "w3Ansatz", "]"}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7199150426605177`*^9, 3.719915126462996*^9}, {
   3.719915500482781*^9, 3.719915506593685*^9}, 3.7219918227610617`*^9, {
   3.729866101429743*^9, 3.729866111239746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Bads", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Variables", "[", 
      RowBox[{"w3Basis", "//.", "a2XcoordsRep"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"#", "/.", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"b", ",", "c"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", "goods"}], 
           "]"}]}]}], "]"}], ">", "0"}], "&"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725093683842793*^9, 3.725093708421941*^9}, {
  3.725093866959771*^9, 3.725093954890315*^9}, {3.7298662714256287`*^9, 
  3.7298662748659573`*^9}, {3.729866310298513*^9, 3.729866374680358*^9}, {
  3.729866439362309*^9, 3.7298664626191397`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"w3Basis", "//.", "a2XcoordsRep"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725040428311413*^9, 3.725040442484074*^9}, {
  3.725040685523015*^9, 3.7250406886056356`*^9}, {3.725093191320801*^9, 
  3.72509319711075*^9}, {3.729866491051393*^9, 3.729866491165908*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "tmp", "]"}], "]"}]}], ")"}], ".", "tmp"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725040824836896*^9, 3.725040826465382*^9}, {
  3.7250933838005123`*^9, 3.725093384180983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3BasisAdj", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"tmp", ",", "#"}], "]"}], "&"}], "/@", "w3Bads"}],
                   ")"}], ")"}], "\[Equal]", "0"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"p", "[", "_", "]"}]}], "]"}]}], ")"}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], ")"}], "//.", 
    "a2Explicit"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7250407742550898`*^9, 3.725040853599792*^9}, {
  3.725093397232316*^9, 3.725093447126*^9}, {3.725093478773481*^9, 
  3.725093493712769*^9}, {3.7298664969749413`*^9, 3.729866505095972*^9}, {
  3.729872135740823*^9, 3.7298721372733088`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w3BasisAdj", "//", "Length"}]], "Input",
 CellChangeTimes->{{3.729866508332183*^9, 3.729866515778228*^9}, {
  3.7298711937236547`*^9, 3.729871194041604*^9}}],

Cell[BoxData["35"], "Output",
 CellChangeTimes->{{3.7298665107714453`*^9, 3.72986651618351*^9}, {
   3.7298711906741323`*^9, 3.7298711944242687`*^9}, 3.72987653601431*^9, 
   3.7298767299630623`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkW3", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "//.", "a2Explicit"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"tensor", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"tensor", "[", "a", "]"}], 
         RowBox[{"wedge", "[", 
          RowBox[{
           RowBox[{"dLog", "[", "b", "]"}], ",", 
           RowBox[{"dLog", "[", "c", "]"}]}], "]"}]}]}]}], ")"}], ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "//.", "a2Explicit"}], ")"}], "/.", 
       RowBox[{
        RowBox[{"tensor", "[", 
         RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
        RowBox[{
         RowBox[{"tensor", "[", "c", "]"}], 
         RowBox[{"wedge", "[", 
          RowBox[{
           RowBox[{"dLog", "[", "a", "]"}], ",", 
           RowBox[{"dLog", "[", "b", "]"}]}], "]"}]}]}]}], ")"}]}], "}"}], "//.",
    "wedgeRules"}]}]], "Input",
 CellChangeTimes->{{3.729867544520734*^9, 3.729867549487713*^9}, {
  3.7298708304563513`*^9, 3.729870843813068*^9}, {3.729870884609631*^9, 
  3.729870892580504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fReps", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "//.", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"a___", ",", 
           RowBox[{"{", 
            RowBox[{"b_", ",", "c_"}], "}"}], ",", "d___"}], "]"}], 
         "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"a", ",", "b", ",", "d"}], "]"}], "+", 
          RowBox[{"f", "[", 
           RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}]}], ")"}], "//.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"a___", ",", "1", ",", "b___"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"f", "[", 
          RowBox[{"a", ",", "X1", ",", "b"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"a___", ",", "2", ",", "b___"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"f", "[", 
          RowBox[{"a", ",", "X2", ",", "b"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"a___", ",", "3", ",", "b___"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"f", "[", 
          RowBox[{"a", ",", "X3", ",", "b"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"a___", ",", "4", ",", "b___"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"f", "[", 
          RowBox[{"a", ",", "X4", ",", "b"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"a___", ",", "5", ",", "b___"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"f", "[", 
          RowBox[{"a", ",", "X5", ",", "b"}], "]"}]}]}], "}"}]}], ")"}], "//.", 
    RowBox[{"f", "\[RuleDelayed]", "tensor"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729867397947384*^9, 3.729867510386312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "1", ",", "5"}], "]"}], "+", 
   RowBox[{"f", "[", 
    RowBox[{"1", ",", "5", ",", "1"}], "]"}], "+", 
   RowBox[{"f", "[", 
    RowBox[{"5", ",", "1", ",", "1"}], "]"}]}], ","}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3BasisNice", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", "1"}], "]"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", "1"}], "]"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", "1", ",", "1"}], "]"}], ",", 
     RowBox[{"f", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "2", ",", "1"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "1", ",", "2"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", "2", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", "5", ",", "5"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"5", ",", "1", ",", "5"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"5", ",", "5", ",", "1"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "5"}], "}"}], ",", "1", ",", "2"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "5"}], "}"}], ",", "2", ",", "1"}], "]"}], "+", 
      RowBox[{"f", "[", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "5"}], "}"}], ",", "1"}], "]"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "5"}], "}"}], ",", "1", ",", "5"}], "]"}], "+", 
        RowBox[{"f", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "5"}], "}"}], ",", "5", ",", "1"}], "]"}], "+", 
        RowBox[{"f", "[", 
         RowBox[{"5", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "5"}], "}"}], ",", "1"}], "]"}]}], ")"}]}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729867829566424*^9, 3.729867835739737*^9}, {
   3.729868018607401*^9, 3.729868084259904*^9}, {3.729868278805275*^9, 
   3.729868278931773*^9}, {3.729868329247387*^9, 3.729868331773073*^9}, {
   3.7298716468428183`*^9, 3.729871667865049*^9}, {3.729872204786442*^9, 
   3.729872232875864*^9}, {3.7298724574067507`*^9, 3.72987246203053*^9}, {
   3.72987283981148*^9, 3.729872873665114*^9}, {3.729873145988557*^9, 
   3.7298731796339703`*^9}, {3.729873348270657*^9, 3.729873348899712*^9}, {
   3.7298759333495007`*^9, 3.72987593375408*^9}, 3.729876956979649*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "w3BasisNice", "]"}]], "Input",
 CellChangeTimes->{{3.729876916727406*^9, 3.729876921308794*^9}}],

Cell[BoxData["9"], "Output",
 CellChangeTimes->{3.729876921747191*^9, 3.729876958895794*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cyc", "[", "x_", "]"}], ":=", 
   RowBox[{"x", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"X1", "\[Rule]", "X2"}], ",", 
      RowBox[{"X2", "\[Rule]", "X3"}], ",", 
      RowBox[{"X3", "\[Rule]", "X4"}], ",", 
      RowBox[{"X4", "\[Rule]", "X5"}], ",", 
      RowBox[{"X5", "\[Rule]", "X1"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729867730215006*^9, 3.7298677503225613`*^9}, {
  3.729868115902169*^9, 3.729868118317049*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzNice", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{"Length", "[", "w3BasisNice", "]"}], "*", "5"}], "]"}]}], 
     ")"}], ".", 
    RowBox[{"Flatten", "[", 
     RowBox[{"NestList", "[", 
      RowBox[{"cyc", ",", 
       RowBox[{"w3BasisNice", "//", "fReps"}], ",", "4"}], "]"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.729876589847168*^9, 3.72987659274516*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tensor", "[", 
    RowBox[{"X1", ",", "X2"}], "]"}], "-", 
   RowBox[{"tensor", "[", 
    RowBox[{"X1", ",", "X5"}], "]"}]}], "//.", "a2Explicit"}]], "Input",
 CellChangeTimes->{{3.72987720650331*^9, 3.72987721963162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"tensor", "[", 
    RowBox[{"x1", ",", "x2"}], "]"}]}], "-", 
  RowBox[{"tensor", "[", 
   RowBox[{"x1", ",", 
    FractionBox[
     RowBox[{"x1", " ", "x2"}], 
     RowBox[{"1", "+", "x1"}]]}], "]"}]}]], "Output",
 CellChangeTimes->{3.729877220059037*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fit", "[", "ansatzNice", "]"}]], "Input",
 CellChangeTimes->{{3.729876986639492*^9, 3.7298769934174*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"p", "[", "43", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "3", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"p", "[", "43", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "4", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"p", "[", "43", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "5", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "6", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "17", "]"}]}], "+", 
     RowBox[{"p", "[", "43", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "7", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "15", "]"}], "+", 
     RowBox[{"p", "[", "26", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "8", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "40", "]"}]}], "-", 
     RowBox[{"p", "[", "42", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "9", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "10", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "11", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "15", "]"}]}], "-", 
     RowBox[{"p", "[", "26", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "12", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "15", "]"}]}], "-", 
     RowBox[{"p", "[", "26", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "13", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "15", "]"}]}], "-", 
     RowBox[{"p", "[", "26", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "14", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "16", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "24", "]"}], "+", 
     RowBox[{"p", "[", "35", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "18", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "19", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "20", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "24", "]"}]}], "-", 
     RowBox[{"p", "[", "35", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "21", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "24", "]"}]}], "-", 
     RowBox[{"p", "[", "35", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "22", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "24", "]"}]}], "-", 
     RowBox[{"p", "[", "35", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "23", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "25", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "33", "]"}], "+", 
     RowBox[{"p", "[", "44", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "27", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "28", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "29", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "33", "]"}]}], "-", 
     RowBox[{"p", "[", "44", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "30", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "33", "]"}]}], "-", 
     RowBox[{"p", "[", "44", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "31", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"p", "[", "33", "]"}]}], "-", 
     RowBox[{"p", "[", "44", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "32", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "34", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"p", "[", "40", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "36", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "37", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "38", "]"}], "\[Rule]", 
    RowBox[{"p", "[", "40", "]"}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "39", "]"}], "\[Rule]", 
    RowBox[{"p", "[", "40", "]"}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "41", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "45", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.729876993788568*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"targets", "=", 
   RowBox[{"w3BasisAdj", "//.", "a2XcoordsRep"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7298765984704647`*^9, 3.729876613862589*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"fit", "[", 
     RowBox[{"ansatzNice", "-", "#"}], "]"}], "]"}], "&"}], "/@", 
  "targets"}]], "Input",
 CellChangeTimes->{{3.729876614715169*^9, 3.729876640076149*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",",
    "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", 
   ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", 
   "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", 
   ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", "35", ",", 
   "35", ",", "35"}], "}"}]], "Output",
 CellChangeTimes->{{3.72987661648459*^9, 3.729876640517542*^9}, 
   3.729876737948948*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"targets", "[", 
  RowBox[{"[", "4", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7298766454222927`*^9, 3.729876647107901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"tensor", "[", 
    RowBox[{"X1", ",", "X2", ",", "X2"}], "]"}]}], "-", 
  RowBox[{"tensor", "[", 
   RowBox[{"X1", ",", "X2", ",", "X5"}], "]"}], "-", 
  RowBox[{"tensor", "[", 
   RowBox[{"X1", ",", "X5", ",", "X2"}], "]"}], "-", 
  RowBox[{"tensor", "[", 
   RowBox[{"X1", ",", "X5", ",", "X5"}], "]"}]}]], "Output",
 CellChangeTimes->{3.729876647560079*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["look for things to glue on to log log terms", "Subsubsection",
 CellChangeTimes->{{3.729868716855422*^9, 3.72986872915907*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3AnsatzList", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"f", "@@@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Tuples", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "5"}], "}"}], ",", "3"}], "]"}], ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "]"}]}], ")"}], "//", 
      "fReps"}], ")"}], "//.", "a2Explicit"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729868754900749*^9, 3.729868832042273*^9}, {
  3.7298688820575113`*^9, 3.729868909192645*^9}, {3.72986995381013*^9, 
  3.72986995909055*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Ansatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "w3AnsatzList", "]"}], "]"}]}], ")"}], ".", 
    "w3AnsatzList"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7298658718749943`*^9, 3.729865876121682*^9}, {
  3.729868839375387*^9, 3.7298688497282333`*^9}, {3.729868919321219*^9, 
  3.7298689406161203`*^9}, {3.729869966994441*^9, 3.729869978626594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3LastExp", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w3Ansatz", "/.", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"tensor", "[", "a", "]"}], 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"dLog", "[", "b", "]"}], ",", 
          RowBox[{"dLog", "[", "c", "]"}]}], "]"}]}]}]}], ")"}], "//.", 
    "wedgeRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72986588399928*^9, 3.729865897399252*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tensors", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "w3LastExp", "]"}], ",", 
     RowBox[{"tensor", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729865908097104*^9, 3.729865910540441*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3EqsInit", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{"#", ",", "tensors"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"w3LastExp", ",", "wedges"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72986591845809*^9, 3.729865926256227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3TaylorExp", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TimeConstrained", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ser", "[", 
                 RowBox[{"w3EqsInit", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "]"}], "@@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "3"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], 
               ")"}], "/.", 
              RowBox[{
               RowBox[{
                RowBox[{"ser", "[", "a_", "]"}], "[", "b__", "]"}], 
               "\[RuleDelayed]", 
               RowBox[{"Series", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}], "//.", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "\[Rule]", 
               RowBox[{"X", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ",",
            "15"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "$Aborted"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7199145902150097`*^9, 3.7199146986500673`*^9}, {
   3.7199147875753927`*^9, 3.7199147997*^9}, {3.719915240741102*^9, 
   3.719915255658091*^9}, {3.719915725337269*^9, 3.71991572917594*^9}, {
   3.71991589644422*^9, 3.719915897083332*^9}, 3.7199159594781237`*^9, {
   3.721749434380785*^9, 3.721749441575987*^9}, {3.721751850925799*^9, 
   3.721751871298616*^9}, {3.721751923918041*^9, 3.721751953492519*^9}, {
   3.721752016352873*^9, 3.7217520248047457`*^9}, {3.729865941946946*^9, 
   3.729865944783135*^9}, {3.7298659815295067`*^9, 3.72986598383536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3TaylorExpEqs", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"w3TaylorExp", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"X", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "vars", "]"}], "]"}]}]}], "]"}]}], "]"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729866000566588*^9, 3.729866003921871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Soln", "=", 
   RowBox[{"solve", "[", "w3TaylorExpEqs", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7198255733246803`*^9, 3.719825609221983*^9}, 
   3.7198256599717407`*^9, {3.719826022207017*^9, 3.7198260267957373`*^9}, {
   3.719827141397127*^9, 3.7198271428369417`*^9}, {3.719915309473819*^9, 
   3.71991531755264*^9}, {3.729866023961059*^9, 3.729866026267393*^9}}],

Cell[CellGroupData[{

Cell[BoxData["w3Soln"], "Input",
 CellChangeTimes->{{3.7298688613714933`*^9, 3.729868862721787*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "3", "]"}], "+", 
     RowBox[{"p", "[", "4", "]"}], "-", 
     RowBox[{"p", "[", "7", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "6", "]"}], "\[Rule]", 
    RowBox[{"p", "[", "8", "]"}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "11", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "12", "]"}], "+", 
     RowBox[{"p", "[", "13", "]"}], "-", 
     RowBox[{"p", "[", "14", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "16", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "17", "]"}], "+", 
     RowBox[{"p", "[", "18", "]"}], "-", 
     RowBox[{"p", "[", "19", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.729868863083756*^9, 3.7298689458919992`*^9, 
  3.7298699838428392`*^9, 3.7298715209292183`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3EqsInit2", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"collectPs", "[", 
         RowBox[{
          RowBox[{"collectPs", "[", 
           RowBox[{"w3EqsInit", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], "//.", "w3Soln"}], "]"}], 
        "/.", 
        RowBox[{
         RowBox[{"a_", "*", 
          RowBox[{"p", "[", "b_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Together", "[", "a", "]"}], 
          RowBox[{"p", "[", "b", "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "ii"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721988358173491*^9, 3.721988361691494*^9}, {
  3.72198840458879*^9, 3.721988494838037*^9}, {3.721988544946871*^9, 
  3.721988593288219*^9}, {3.72986604429613*^9, 3.729866052533051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w3EqsInit2", "=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{"w3EqsInit2", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.721990098104023*^9, 3.721990126564876*^9}, {
  3.729866056423438*^9, 3.729866076625519*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7298660770918417`*^9, 3.729868858243616*^9, 
  3.7298689541594152`*^9, 3.7298699867258377`*^9, 3.729871525535774*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w3EqsInit", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "numEval"}], ")"}], "//.", 
          "w3Soln"}], "//", "Expand"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], "]"}]}], ";", 
  RowBox[{"check", "\[Equal]", 
   RowBox[{"{", "0", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.719915349994891*^9, 3.7199154294802217`*^9}, 
   3.7219913767588243`*^9, 3.7219915131502237`*^9, {3.729866080470913*^9, 
   3.729866089573677*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7199154008286247`*^9, {3.7199154429956617`*^9, 3.719915462190464*^9}, 
   3.721407558178978*^9, 3.72175275841094*^9, 3.7219913987360067`*^9, 
   3.721991705393016*^9, {3.7250370371300173`*^9, 3.725037047359942*^9}, 
   3.725037993913431*^9, 3.725038342411951*^9, 3.725093562856867*^9, 
   3.72986609035023*^9, 3.729868858408832*^9, 3.729868959107971*^9, 
   3.7298699889037037`*^9, 3.7298715257683973`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Basis", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"w3Ansatz", "//.", "w3Soln"}], ",", 
         RowBox[{"p", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "w3Ansatz", "]"}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7199150426605177`*^9, 3.719915126462996*^9}, {
   3.719915500482781*^9, 3.719915506593685*^9}, 3.7219918227610617`*^9, {
   3.729866101429743*^9, 3.729866111239746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3AnsatzList", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"w3Ansatz", "//.", "w3Soln"}], ")"}], ",", 
          RowBox[{"p", "[", "_", "]"}]}], "]"}]}], ")"}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], ")"}], "//.", 
    "a2Explicit"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729870189110615*^9, 3.729870198258881*^9}, {
  3.729870392204145*^9, 3.7298704023916883`*^9}, {3.729870469020524*^9, 
  3.7298705099517403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Ansatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "w3AnsatzList", "]"}], "]"}]}], ")"}], ".", 
    "w3AnsatzList"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7298658718749943`*^9, 3.729865876121682*^9}, {
  3.729868839375387*^9, 3.7298688497282333`*^9}, {3.729868919321219*^9, 
  3.7298689406161203`*^9}, {3.729869966994441*^9, 3.729869978626594*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3FirstExp", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w3Ansatz", "/.", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"tensor", "[", "c", "]"}], 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"dLog", "[", "a", "]"}], ",", 
          RowBox[{"dLog", "[", "b", "]"}]}], "]"}]}]}]}], ")"}], "//.", 
    "wedgeRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72986588399928*^9, 3.729865897399252*^9}, {
  3.729870421299199*^9, 3.72987043085732*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tensors", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "w3FirstExp", "]"}], ",", 
     RowBox[{"tensor", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729865908097104*^9, 3.729865910540441*^9}, {
  3.729870435486128*^9, 3.7298704372368813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3EqsInit", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{"#", ",", "tensors"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"w3FirstExp", ",", "wedges"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72986591845809*^9, 3.729865926256227*^9}, 
   3.7298704433777113`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3TaylorExp", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TimeConstrained", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ser", "[", 
                 RowBox[{"w3EqsInit", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "]"}], "@@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "3"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], 
               ")"}], "/.", 
              RowBox[{
               RowBox[{
                RowBox[{"ser", "[", "a_", "]"}], "[", "b__", "]"}], 
               "\[RuleDelayed]", 
               RowBox[{"Series", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}], "//.", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "\[Rule]", 
               RowBox[{"X", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ",",
            "15"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "$Aborted"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7199145902150097`*^9, 3.7199146986500673`*^9}, {
   3.7199147875753927`*^9, 3.7199147997*^9}, {3.719915240741102*^9, 
   3.719915255658091*^9}, {3.719915725337269*^9, 3.71991572917594*^9}, {
   3.71991589644422*^9, 3.719915897083332*^9}, 3.7199159594781237`*^9, {
   3.721749434380785*^9, 3.721749441575987*^9}, {3.721751850925799*^9, 
   3.721751871298616*^9}, {3.721751923918041*^9, 3.721751953492519*^9}, {
   3.721752016352873*^9, 3.7217520248047457`*^9}, {3.729865941946946*^9, 
   3.729865944783135*^9}, {3.7298659815295067`*^9, 3.72986598383536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3TaylorExpEqs", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"w3TaylorExp", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"X", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "vars", "]"}], "]"}]}]}], "]"}]}], "]"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729866000566588*^9, 3.729866003921871*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Soln", "=", 
   RowBox[{"solve", "[", "w3TaylorExpEqs", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7198255733246803`*^9, 3.719825609221983*^9}, 
   3.7198256599717407`*^9, {3.719826022207017*^9, 3.7198260267957373`*^9}, {
   3.719827141397127*^9, 3.7198271428369417`*^9}, {3.719915309473819*^9, 
   3.71991531755264*^9}, {3.729866023961059*^9, 3.729866026267393*^9}}],

Cell[CellGroupData[{

Cell[BoxData["w3Soln"], "Input",
 CellChangeTimes->{{3.7298688613714933`*^9, 3.729868862721787*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "3", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "5", "]"}], "+", 
     RowBox[{"p", "[", "8", "]"}], "-", 
     RowBox[{"p", "[", "12", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "4", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "7", "]"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"p", "[", "9", "]"}]}], "+", 
     RowBox[{"p", "[", "10", "]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"p", "[", "13", "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"p", "[", "14", "]"}]}], "+", 
     RowBox[{"p", "[", "15", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "6", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"p", "[", "7", "]"}], "+", 
     RowBox[{"p", "[", "9", "]"}], "-", 
     RowBox[{"p", "[", "13", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "11", "]"}], "\[Rule]", 
    RowBox[{"p", "[", "14", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.729868863083756*^9, 3.7298689458919992`*^9, 
  3.7298699838428392`*^9, 3.729870528513012*^9, 3.729871543334937*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3EqsInit2", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"collectPs", "[", 
         RowBox[{
          RowBox[{"collectPs", "[", 
           RowBox[{"w3EqsInit", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], "//.", "w3Soln"}], "]"}], 
        "/.", 
        RowBox[{
         RowBox[{"a_", "*", 
          RowBox[{"p", "[", "b_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Together", "[", "a", "]"}], 
          RowBox[{"p", "[", "b", "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "ii"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721988358173491*^9, 3.721988361691494*^9}, {
  3.72198840458879*^9, 3.721988494838037*^9}, {3.721988544946871*^9, 
  3.721988593288219*^9}, {3.72986604429613*^9, 3.729866052533051*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w3EqsInit2", "=", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{"w3EqsInit2", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.721990098104023*^9, 3.721990126564876*^9}, {
  3.729866056423438*^9, 3.729866076625519*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.7298660770918417`*^9, 3.729868858243616*^9, 
  3.7298689541594152`*^9, 3.7298699867258377`*^9, 3.7298705332040043`*^9, 
  3.729871546854299*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w3EqsInit", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "numEval"}], ")"}], "//.", 
          "w3Soln"}], "//", "Expand"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "w3EqsInit", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], "]"}]}], ";", 
  RowBox[{"check", "\[Equal]", 
   RowBox[{"{", "0", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.719915349994891*^9, 3.7199154294802217`*^9}, 
   3.7219913767588243`*^9, 3.7219915131502237`*^9, {3.729866080470913*^9, 
   3.729866089573677*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7199154008286247`*^9, {3.7199154429956617`*^9, 3.719915462190464*^9}, 
   3.721407558178978*^9, 3.72175275841094*^9, 3.7219913987360067`*^9, 
   3.721991705393016*^9, {3.7250370371300173`*^9, 3.725037047359942*^9}, 
   3.725037993913431*^9, 3.725038342411951*^9, 3.725093562856867*^9, 
   3.72986609035023*^9, 3.729868858408832*^9, 3.729868959107971*^9, 
   3.7298699889037037`*^9, 3.729870535881691*^9, 3.7298715477527933`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Basis", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"w3Ansatz", "//.", "w3Soln"}], ",", 
         RowBox[{"p", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "w3Ansatz", "]"}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7199150426605177`*^9, 3.719915126462996*^9}, {
   3.719915500482781*^9, 3.719915506593685*^9}, 3.7219918227610617`*^9, {
   3.729866101429743*^9, 3.729866111239746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3Bads", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Variables", "[", 
      RowBox[{"w3Basis", "//.", "a2XcoordsRep"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"#", "/.", 
         RowBox[{
          RowBox[{"tensor", "[", 
           RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"b", ",", "c"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}]}], "}"}], ",", "goods"}], 
           "]"}]}]}], "]"}], ">", "0"}], "&"}]}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{"w3Basis", "//.", "a2XcoordsRep"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725040428311413*^9, 3.725040442484074*^9}, {
  3.725040685523015*^9, 3.7250406886056356`*^9}, {3.725093191320801*^9, 
  3.72509319711075*^9}, {3.729866491051393*^9, 3.729866491165908*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tmp", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "tmp", "]"}], "]"}]}], ")"}], ".", "tmp"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725040824836896*^9, 3.725040826465382*^9}, {
  3.7250933838005123`*^9, 3.725093384180983*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w3BasisAdj", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"List", "@@", 
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"tmp", "//.", 
            RowBox[{
             RowBox[{"Solve", "[", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Coefficient", "[", 
                    RowBox[{"tmp", ",", "#"}], "]"}], "&"}], "/@", "w3Bads"}],
                   ")"}], ")"}], "\[Equal]", "0"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"p", "[", "_", "]"}]}], "]"}]}], ")"}], "/.", 
      RowBox[{
       RowBox[{"p", "[", "_", "]"}], "\[RuleDelayed]", "1"}]}], ")"}], "//.", 
    "a2Explicit"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7250407742550898`*^9, 3.725040853599792*^9}, {
  3.725093397232316*^9, 3.725093447126*^9}, {3.725093478773481*^9, 
  3.725093493712769*^9}, {3.7298664969749413`*^9, 3.729866505095972*^9}, {
  3.729872135740823*^9, 3.7298721372733088`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{"tensorExpand", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"Length", "[", "w3BasisNice", "]"}], "*", "5"}], "]"}]}], 
        ")"}], ".", 
       RowBox[{"Flatten", "[", 
        RowBox[{"NestList", "[", 
         RowBox[{"cyc", ",", 
          RowBox[{"w3BasisNice", "//", "fReps"}], ",", "4"}], "]"}], "]"}]}], 
      ")"}], "//.", "a2Explicit"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729870604977769*^9, 3.729870648469906*^9}, 
   3.7298725453706903`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "w3BasisNice", "]"}], "]"}]}], ")"}], ".", 
    RowBox[{"tensorExpand", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"w3BasisNice", "//", "fReps"}], ")"}], "//.", "a2Explicit"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729873828973233*^9, 3.7298738296660547`*^9}, {
  3.729873870970922*^9, 3.72987387153056*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"targets", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{"tensorExpand", "[", "w3BasisAdj", "]"}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.729870541301444*^9, 3.729870551655765*^9}, {
  3.7298705850712233`*^9, 3.729870587555331*^9}, {3.729870636325657*^9, 
  3.729870645038328*^9}, {3.729872145666901*^9, 3.729872145995976*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"fit", "[", 
     RowBox[{"ansatz", "-", "#"}], "]"}], "]"}], "&"}], "/@", "targets"}]], \
"Input",
 CellChangeTimes->{{3.729870225987002*^9, 3.7298702346128483`*^9}, {
  3.7298706510269547`*^9, 3.729870671676661*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", ",", "9", 
   ",", "9"}], "}"}]], "Output",
 CellChangeTimes->{{3.729870655302164*^9, 3.729870671974102*^9}, 
   3.729871595587316*^9, 3.729871693137041*^9, {3.7298721396536837`*^9, 
   3.729872147289392*^9}, 3.7298722583281937`*^9, 3.72987248294354*^9, 
   3.729872549903034*^9, 3.729872696209269*^9, 3.729872904756382*^9, 
   3.729873877024534*^9, 3.729875997229178*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fit", "[", 
  RowBox[{"ansatz", "-", 
   RowBox[{"targets", "[", 
    RowBox[{"[", "8", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.729873899421768*^9, 3.729873903522318*^9}, {
  3.7298742454147387`*^9, 3.72987427036333*^9}, {3.729874344787549*^9, 
  3.7298743449908257`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"p", "[", "7", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "3", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"p", "[", "7", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "4", "]"}], "\[Rule]", 
    RowBox[{"-", 
     RowBox[{"p", "[", "7", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "5", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "6", "]"}], "\[Rule]", 
    RowBox[{"p", "[", "7", "]"}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "8", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "9", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "10", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "11", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7298739039057426`*^9, {3.729874246060441*^9, 3.7298742707767563`*^9}, 
   3.729874345566691*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"w3BasisNice", "[", 
  RowBox[{"[", "5", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.729874355736487*^9, 3.7298743702439537`*^9}}],

Cell[BoxData[
 RowBox[{"f", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}], ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.7298743669772987`*^9, 3.729874370581715*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"w3BasisAdj", "//.", "a2XcoordsRep"}]], "Input",
 CellChangeTimes->{{3.729873930069529*^9, 3.7298739419347973`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w3BasisAdj", "[", 
    RowBox[{"[", "7", "]"}], "]"}], "-", 
   RowBox[{"w3BasisAdj", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], "//.", "a2XcoordsRep"}]], "Input",
 CellChangeTimes->{{3.729870679491037*^9, 3.7298706950021257`*^9}, {
  3.729871601112247*^9, 3.729871601415484*^9}, {3.7298717046711893`*^9, 
  3.7298717049900103`*^9}, {3.729872154917157*^9, 3.729872162429811*^9}, {
  3.729872265114359*^9, 3.729872265349092*^9}, {3.729872491510584*^9, 
  3.729872491791925*^9}, {3.729872557252599*^9, 3.7298725575652742`*^9}, {
  3.729872588406189*^9, 3.729872588908753*^9}, {3.729872703033022*^9, 
  3.729872709226328*^9}, {3.729872908814493*^9, 3.7298729272573853`*^9}, {
  3.729873483913994*^9, 3.729873496046891*^9}, {3.729874441837339*^9, 
  3.7298744516894913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X1", ",", "X2", ",", "X2"}], "]"}]}], "+", 
  RowBox[{"tensor", "[", 
   RowBox[{"X1", ",", "X5", ",", "X5"}], "]"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X5", ",", "X1", ",", "X2"}], "]"}]}], "+", 
  RowBox[{"tensor", "[", 
   RowBox[{"X5", ",", "X1", ",", "X5"}], "]"}], "-", 
  RowBox[{"tensor", "[", 
   RowBox[{"X5", ",", "X5", ",", "X1"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.729870684581456*^9, 3.729870695394668*^9}, 
   3.729871601789165*^9, 3.729871705277252*^9, 3.729872162790141*^9, 
   3.729872265642653*^9, 3.72987249233854*^9, 3.72987255814121*^9, 
   3.729872589672523*^9, {3.729872703525959*^9, 3.729872710005377*^9}, {
   3.729872909955018*^9, 3.7298729277430487`*^9}, {3.729873488570397*^9, 
   3.729873496597183*^9}, {3.729874442596055*^9, 3.729874452248837*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "w3BasisNice", "]"}], "]"}]}], ")"}], ".", 
       RowBox[{"fReps", "[", "w3BasisNice", "]"}]}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"w3BasisAdj", "[", 
          RowBox[{"[", "7", "]"}], "]"}], "-", 
         RowBox[{"w3BasisAdj", "[", 
          RowBox[{"[", "9", "]"}], "]"}]}], "//.", "a2XcoordsRep"}], ")"}]}], 
     ",", 
     RowBox[{"tensor", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729874752477222*^9, 3.729874753837894*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"List", "@@", "base"}], ")"}], "/.", 
    RowBox[{
     RowBox[{"tensor", "[", "__", "]"}], "\[RuleDelayed]", "1"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7298726069827747`*^9, 3.729872607901607*^9}, {
  3.7298744603219213`*^9, 3.729874535723454*^9}, {3.7298745712240047`*^9, 
  3.729874573360098*^9}, {3.729874757298744*^9, 3.729874757645277*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"soln2", "=", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"solve", "/@", 
      RowBox[{"Subsets", "[", 
       RowBox[{"eqs", ",", 
        RowBox[{"{", 
         RowBox[{"19", "-", "3"}], "}"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729874576028414*^9, 3.729874627581324*^9}, {
  3.729874764476952*^9, 3.729874764592696*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"base", "//.", "soln2"}]], "Input",
 CellChangeTimes->{{3.729874623178466*^9, 3.7298746540741043`*^9}, {
  3.729874761909614*^9, 3.729874766812414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X1", ",", "X2", ",", "X2"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X5", ",", "X1", ",", "X2"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X5", ",", "X5", ",", "X1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.729874630546722*^9, 3.729874654423499*^9}, 
   3.729874767161043*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"solns4", "=", 
   RowBox[{
    RowBox[{"Union", "[", 
     RowBox[{"solve", "/@", 
      RowBox[{"Subsets", "[", 
       RowBox[{"eqs", ",", 
        RowBox[{"{", 
         RowBox[{"19", "-", "4"}], "}"}]}], "]"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.729874576028414*^9, 3.729874627581324*^9}, {
  3.7298747003426323`*^9, 3.7298747413753*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "solns4", "]"}]], "Input",
 CellChangeTimes->{{3.729874812412427*^9, 3.729874814339426*^9}}],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{3.729874814739604*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "//.", 
   RowBox[{"solns4", "[", 
    RowBox[{"[", "7", "]"}], "]"}]}], "//.", 
  RowBox[{
   RowBox[{"p", "[", "_", "]"}], "\[RuleDelayed]", "0"}]}]], "Input",
 CellChangeTimes->{{3.729875009338252*^9, 3.729875020811698*^9}, {
  3.7298750531705933`*^9, 3.729875107755472*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X2", ",", "X1", ",", "X5"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X2", ",", "X2", ",", "X1"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X5", ",", "X1", ",", "X5"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"tensor", "[", 
    RowBox[{"X5", ",", "X5", ",", "X1"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.729875015668947*^9, 3.7298750212186193`*^9}, {
  3.729875053735454*^9, 3.7298751081186857`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "w3BasisNice", "]"}]], "Input",
 CellChangeTimes->{{3.729875426642384*^9, 3.729875432054347*^9}}],

Cell[BoxData["11"], "Output",
 CellChangeTimes->{3.729875432486765*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["weight 4", "Subsection",
 CellChangeTimes->{{3.71991500618958*^9, 3.719915007661523*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4AnsatzList", "=", 
   RowBox[{"Union", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"f", ",", "w2BasisAdj", ",", "w2BasisAdj"}], "]"}], "//.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"x___", ",", 
            RowBox[{"a_", "+", "b_"}], ",", "y___"}], "]"}], "\[RuleDelayed]", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"x", ",", "a", ",", "y"}], "]"}], "+", 
           RowBox[{"f", "[", 
            RowBox[{"x", ",", "b", ",", "y"}], "]"}]}]}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"x___", ",", 
            RowBox[{"-", "a_"}], ",", "y___"}], "]"}], "\[RuleDelayed]", 
          RowBox[{"-", 
           RowBox[{"f", "[", 
            RowBox[{"x", ",", "a", ",", "y"}], "]"}]}]}]}], "}"}]}], "]"}], "/.", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{
        RowBox[{"tensor", "[", "a__", "]"}], ",", 
        RowBox[{"tensor", "[", "b__", "]"}]}], "]"}], "\[RuleDelayed]", 
      RowBox[{"tensor", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719780617550583*^9, 3.7197807704627647`*^9}, {
  3.719780841364235*^9, 3.719780861891436*^9}, {3.7199151388758717`*^9, 
  3.719915159350226*^9}, {3.725093529602891*^9, 3.725093534247239*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4Ansatz", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"p", "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "w4AnsatzList", "]"}], "]"}]}], ")"}], ".", 
    "w4AnsatzList"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719780772133238*^9, 3.7197807876479683`*^9}, {
  3.71991516166535*^9, 3.7199151640021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4MidExp", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"w4Ansatz", "/.", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"tensor", "[", 
         RowBox[{"a", ",", "d"}], "]"}], 
        RowBox[{"wedge", "[", 
         RowBox[{
          RowBox[{"dLog", "[", "b", "]"}], ",", 
          RowBox[{"dLog", "[", "c", "]"}]}], "]"}]}]}]}], ")"}], "//.", 
    "wedgeRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7198249007624483`*^9, 3.719824928652575*^9}, {
  3.719915208628167*^9, 3.719915212415275*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tensors", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Variables", "[", "w4MidExp", "]"}], ",", 
     RowBox[{"tensor", "[", "__", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719825069870194*^9, 3.719825084130332*^9}, 
   3.719915223087585*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4EqsInit", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"Normal", "[", 
        RowBox[{
         RowBox[{"CoefficientArrays", "[", 
          RowBox[{"#", ",", "tensors"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"w4MidExp", ",", "wedges"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7198249330255127`*^9, 3.719824938125103*^9}, {
  3.71982501362733*^9, 3.719825020430686*^9}, {3.719825087899084*^9, 
  3.719825119985145*^9}, {3.719827290091446*^9, 3.719827345969574*^9}, {
  3.7199151993419228`*^9, 3.719915224706628*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4TaylorExp", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Monitor", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"TimeConstrained", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Normal", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ser", "[", 
                 RowBox[{"w4EqsInit", "[", 
                  RowBox[{"[", "ii", "]"}], "]"}], "]"}], "@@", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"vars", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "0", ",", "3"}], 
                   "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], 
               ")"}], "/.", 
              RowBox[{
               RowBox[{
                RowBox[{"ser", "[", "a_", "]"}], "[", "b__", "]"}], 
               "\[RuleDelayed]", 
               RowBox[{"Series", "[", 
                RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}], "//.", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"vars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "\[Rule]", 
               RowBox[{"X", "[", "i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"Length", "[", "vars", "]"}]}], "}"}]}], "]"}]}], ",",
            "15"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", 
           RowBox[{"Length", "[", "w4EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w4EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "$Aborted"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7199145902150097`*^9, 3.7199146986500673`*^9}, {
   3.7199147875753927`*^9, 3.7199147997*^9}, {3.719915240741102*^9, 
   3.719915255658091*^9}, {3.719915725337269*^9, 3.71991572917594*^9}, {
   3.71991589644422*^9, 3.719915897083332*^9}, 3.7199159594781237`*^9, {
   3.721749434380785*^9, 3.721749441575987*^9}, {3.721751850925799*^9, 
   3.721751871298616*^9}, {3.721751923918041*^9, 3.721751953492519*^9}, {
   3.721752016352873*^9, 3.7217520248047457`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "w4TaylorExp", "]"}]], "Input",
 CellChangeTimes->{{3.721756511465966*^9, 3.721756512654438*^9}}],

Cell[BoxData["25"], "Output",
 CellChangeTimes->{3.721756513031374*^9, 3.725037013779022*^9, 
  3.725037973835642*^9, 3.7250383060048847`*^9, 3.7250935451485558`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "w4EqsInit", "]"}]], "Input",
 CellChangeTimes->{{3.721756514064612*^9, 3.721756519897407*^9}}],

Cell[BoxData["25"], "Output",
 CellChangeTimes->{3.721756520406805*^9, 3.725037013832814*^9, 
  3.725037979484367*^9, 3.7250383074464207`*^9, 3.7250935459944468`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4TaylorExpEqs", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"CoefficientList", "[", 
      RowBox[{"w4TaylorExp", ",", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"X", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "vars", "]"}], "]"}]}]}], "]"}]}], "]"}], 
     "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719825665325235*^9, 3.7198256680703697`*^9}, {
  3.7198269352844763`*^9, 3.719826949243087*^9}, {3.719915285132024*^9, 
  3.7199153019839*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4Soln", "=", 
   RowBox[{"solve", "[", "w4TaylorExpEqs", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7198255733246803`*^9, 3.719825609221983*^9}, 
   3.7198256599717407`*^9, {3.719826022207017*^9, 3.7198260267957373`*^9}, {
   3.719827141397127*^9, 3.7198271428369417`*^9}, {3.719915309473819*^9, 
   3.71991531755264*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4EqsInit2", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"collectPs", "[", 
         RowBox[{
          RowBox[{"collectPs", "[", 
           RowBox[{"w4EqsInit", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], "//.", "w4Soln"}], "]"}], 
        "/.", 
        RowBox[{
         RowBox[{"a_", "*", 
          RowBox[{"p", "[", "b_", "]"}]}], "\[RuleDelayed]", 
         RowBox[{
          RowBox[{"Together", "[", "a", "]"}], 
          RowBox[{"p", "[", "b", "]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "w4EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
     "ii"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721988358173491*^9, 3.721988361691494*^9}, {
  3.72198840458879*^9, 3.721988494838037*^9}, {3.721988544946871*^9, 
  3.721988593288219*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4EqsInit2", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{"w4EqsInit2", ",", "0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721990098104023*^9, 3.721990126564876*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"hm", "=", 
   RowBox[{"w4EqsInit2", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721990360417028*^9, 3.721990367713007*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"",2,258,38,23438113706511975335,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.725093554876075*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eqsTest", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"hm", ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "ii"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "jj"}], "}"}]}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"x1", "\[Rule]", "1"}], ",", 
          RowBox[{"x2", "\[Rule]", "2"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", "0", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"jj", ",", "0", ",", "5"}], "}"}]}], "]"}], ",", "1"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721990791716317*^9, 3.721990870406213*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"",2,259,39,23438113706511975335,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.725093556744174*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"",2,259,40,23438113706511975335,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7250935567657833`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"",2,259,41,23438113706511975335,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.725093556787355*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,259,42,23438113706511975335,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.725093556809682*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"soln1", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"Thread", "[", 
      RowBox[{"eqsTest", "\[Equal]", "0"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.721990855246705*^9, 3.72199091892772*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"collectPs", "[", 
   RowBox[{"hm", "//.", "soln1"}], "]"}], "/.", 
  RowBox[{
   RowBox[{"a_", "*", 
    RowBox[{"p", "[", "b_", "]"}]}], "\[RuleDelayed]", 
   RowBox[{
    RowBox[{"Together", "[", "a", "]"}], 
    RowBox[{"p", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7219909124062634`*^9, 3.721990948841896*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"0\\\", \\\"}\\\"}]\\) does not exist.\"",2,261,43,23438113706511975335,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.725037043937727*^9, 3.725038337722707*^9, 
  3.72509355972729*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], ".", 
  RowBox[{
   RowBox[{"{", "0", "}"}], "\[LeftDoubleBracket]", "2", 
   "\[RightDoubleBracket]"}]}]], "Output",
 CellChangeTimes->{{3.721990923013166*^9, 3.721990949593917*^9}, 
   3.725037043948059*^9, 3.725038337742956*^9, 3.725093559749922*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"newSoln", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"w4Soln", ",", "soln1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.72199135467371*^9, 3.721991365987701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"check", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w4EqsInit", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "numEval"}], ")"}], "//.", 
          "newSoln"}], "//", "Expand"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "w4EqsInit", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"ProgressIndicator", "[", 
       RowBox[{"i", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Length", "[", "w4EqsInit", "]"}]}], "}"}]}], "]"}]}], 
     "]"}], "]"}]}], ";", 
  RowBox[{"check", "\[Equal]", 
   RowBox[{"{", "0", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.719915349994891*^9, 3.7199154294802217`*^9}, 
   3.7219913767588243`*^9, 3.7219915131502237`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7199154008286247`*^9, {3.7199154429956617`*^9, 3.719915462190464*^9}, 
   3.721407558178978*^9, 3.72175275841094*^9, 3.7219913987360067`*^9, 
   3.721991705393016*^9, {3.7250370371300173`*^9, 3.725037047359942*^9}, 
   3.725037993913431*^9, 3.725038342411951*^9, 3.725093562856867*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4Basis", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{
         RowBox[{"w4Ansatz", "//.", "newSoln"}], ",", 
         RowBox[{"p", "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "w4Ansatz", "]"}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7199150426605177`*^9, 3.719915126462996*^9}, {
   3.719915500482781*^9, 3.719915506593685*^9}, 3.7219918227610617`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "w4Basis", "]"}]], "Input",
 CellChangeTimes->{{3.7199151280809793`*^9, 3.7199151326657457`*^9}, {
  3.719915511132938*^9, 3.71991551169623*^9}}],

Cell[BoxData["86"], "Output",
 CellChangeTimes->{
  3.7199151330845222`*^9, {3.719915508806079*^9, 3.7199155121423693`*^9}, 
   3.7214075585961943`*^9, 3.7217528384537973`*^9, 3.721992013919191*^9, 
   3.725037051615117*^9, 3.725038345868608*^9, 3.7250935667439213`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"w4Bads", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Variables", "[", 
      RowBox[{"w4Basis", "//.", "a2XcoordsRep"}], "]"}], ",", 
     RowBox[{
      RowBox[{"!", 
       RowBox[{"MemberQ", "[", 
        RowBox[{"goods", ",", 
         RowBox[{"(", 
          RowBox[{"#", "/.", 
           RowBox[{
            RowBox[{"tensor", "[", 
             RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"b", ",", "c"}], "}"}]}]}], ")"}]}], "]"}]}], "&"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.725093683842793*^9, 3.725093708421941*^9}, {
  3.725093866959771*^9, 3.725093954890315*^9}}],

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "w4Basis", "]"}], "]"}]}], ")"}], ".", 
       "w4Basis"}], "//.", "a2XcoordsRep"}], ")"}], "//.", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"p", "/@", 
                 RowBox[{"Range", "[", 
                  RowBox[{"Length", "[", "w4Basis", "]"}], "]"}]}], ")"}], 
               ".", "w4Basis"}], "//.", "a2XcoordsRep"}], ",", "#"}], "]"}], 
           "&"}], "/@", "w4Bads"}], ")"}], "\[Equal]", "0"}], "]"}], "]"}], 
     "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ",", 
   RowBox[{"p", "[", "_", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.725093961931244*^9, 3.725094079564681*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"smallBasis", "=", 
   RowBox[{"w4Basis", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"1", "/", "x1"}], ",", "b___"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "X1", ",", "b"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a___", ",", "x2", ",", "b___"}], "]"}], "\[RuleDelayed]", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "X2", ",", "b"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"x1", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x2"}], ")"}]}], ",", "b___"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "X3", ",", "b"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a___", ",", 
         FractionBox[
          RowBox[{"1", "+", "x1", "+", 
           RowBox[{"x1", " ", "x2"}]}], "x2"], ",", "b___"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "X4", ",", "b"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tensor", "[", 
        RowBox[{"a___", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "x1"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"x1", " ", "x2"}], ")"}]}], ",", "b___"}], "]"}], 
       "\[RuleDelayed]", 
       RowBox[{"tensor", "[", 
        RowBox[{"a", ",", "X5", ",", "b"}], "]"}]}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725038354356495*^9, 3.7250384007979527`*^9}, {
  3.725038451604373*^9, 3.7250384553953342`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "[", 
  RowBox[{
   RowBox[{"Variables", "[", "bigBasis", "]"}], "/.", 
   RowBox[{
    RowBox[{"tensor", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], "\[RuleDelayed]", 
    RowBox[{"{", 
     RowBox[{"c", ",", "d"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.725038583047483*^9, 3.725038584220854*^9}, {
  3.725038618714188*^9, 3.7250386749196453`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"X1", ",", "X1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X1", ",", "X2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X1", ",", "X5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X2", ",", "X1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X2", ",", "X2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X2", ",", "X3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X3", ",", "X2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X3", ",", "X3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X3", ",", "X4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X4", ",", "X3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X4", ",", "X4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X4", ",", "X5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X5", ",", "X1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X5", ",", "X4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"X5", ",", "X5"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.725038584608966*^9, {3.725038640820447*^9, 3.7250386754224567`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"sortMinus", "[", "x_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{"#", ",", 
          RowBox[{"-", "#"}]}], "}"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}], "&"}], "/@", "x"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.725038473044394*^9, 3.7250385202532787`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"List", "@@", 
          RowBox[{"(", 
           RowBox[{"Collect", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"p", "/@", 
                  RowBox[{"Range", "[", "19", "]"}]}], ")"}], ".", 
                "smallBasis"}], ")"}], "-", "#"}], ",", 
             RowBox[{"tensor", "[", "__", "]"}]}], "]"}], ")"}]}], ")"}], "//.", 
        RowBox[{
         RowBox[{"tensor", "[", "__", "]"}], "\[RuleDelayed]", "1"}]}], ")"}],
       "\[Equal]", "0"}], "]"}], "]"}], "&"}], "/@", 
  RowBox[{"Complement", "[", 
   RowBox[{
    RowBox[{"sortMinus", "[", "bigBasis", "]"}], ",", 
    RowBox[{"sortMinus", "[", "smallBasis", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7250384618062468`*^9, 3.725038468433939*^9}, {
  3.725038500531867*^9, 3.725038533730208*^9}, {3.725038740321425*^9, 
  3.725038815873702*^9}, {3.725038889563538*^9, 3.725038924055764*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.725038468807485*^9, 3.725038534188919*^9, {3.725038744269965*^9, 
   3.7250387784556303`*^9}, 3.725038817156498*^9, {3.725038907994169*^9, 
   3.7250389255690727`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Complement", "[", 
  RowBox[{
   RowBox[{"sortMinus", "[", "bigBasis", "]"}], ",", 
   RowBox[{"sortMinus", "[", "smallBasis", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</packages/data\>\""}],
    "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.721407916451131*^9, 3.721407947006073*^9}, {
  3.721992239227162*^9, 3.721992262767536*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{"\"\<w4Basis.dat\>\"", ",", "w4Basis"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.721992267810151*^9, 3.721992290956064*^9}}]
}, Open  ]]
},
WindowSize->{1280, 1002},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.5,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 98, 1, 65, "Subsection"],
Cell[681, 25, 4570, 122, 483, "Input"],
Cell[5254, 149, 895, 26, 142, "Input"],
Cell[6152, 177, 971, 27, 142, "Input"],
Cell[7126, 206, 1341, 43, 204, "Input"],
Cell[8470, 251, 459, 13, 48, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8966, 269, 97, 1, 65, "Subsection"],
Cell[9066, 272, 531, 15, 70, "Input"],
Cell[9600, 289, 3186, 90, 386, "Input"],
Cell[12789, 381, 1136, 32, 131, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13962, 418, 98, 1, 65, "Subsection"],
Cell[14063, 421, 247, 5, 48, "Input"],
Cell[14313, 428, 181, 4, 48, "Input"],
Cell[14497, 434, 494, 15, 48, "Input"],
Cell[14994, 451, 830, 22, 48, "Input"],
Cell[15827, 475, 1664, 46, 111, "Input"],
Cell[17494, 523, 763, 21, 111, "Input"],
Cell[18260, 546, 368, 10, 48, "Input"],
Cell[18631, 558, 501, 14, 48, "Input"],
Cell[19135, 574, 275, 7, 48, "Input"],
Cell[19413, 583, 419, 10, 48, "Input"],
Cell[19835, 595, 1899, 53, 204, "Input"],
Cell[21737, 650, 589, 15, 80, "Input"],
Cell[22329, 667, 184, 4, 48, "Input"],
Cell[CellGroupData[{
Cell[22538, 675, 940, 27, 142, "Input"],
Cell[23481, 704, 376, 5, 48, "Output"]
}, Open  ]],
Cell[23872, 712, 546, 15, 111, "Input"],
Cell[24421, 729, 1075, 34, 80, "Input"],
Cell[25499, 765, 277, 6, 48, "Input"],
Cell[25779, 773, 557, 16, 48, "Input"],
Cell[26339, 791, 343, 10, 48, "Input"],
Cell[26685, 803, 999, 28, 111, "Input"],
Cell[CellGroupData[{
Cell[27709, 835, 136, 2, 48, "Input"],
Cell[27848, 839, 73, 1, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27958, 845, 877, 23, 80, "Input"],
Cell[28838, 870, 213, 4, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29088, 879, 191, 4, 48, "Input"],
Cell[29282, 885, 236, 6, 48, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29567, 897, 96, 1, 65, "Subsection"],
Cell[29666, 900, 401, 12, 48, "Input"],
Cell[30070, 914, 1327, 35, 173, "Input"],
Cell[31400, 951, 319, 9, 48, "Input"],
Cell[31722, 962, 567, 16, 48, "Input"],
Cell[32292, 980, 281, 7, 48, "Input"],
Cell[32576, 989, 636, 17, 80, "Input"],
Cell[33215, 1008, 2559, 61, 235, "Input"],
Cell[35777, 1071, 487, 13, 80, "Input"],
Cell[36267, 1086, 409, 7, 48, "Input"],
Cell[36679, 1095, 973, 26, 111, "Input"],
Cell[CellGroupData[{
Cell[37677, 1125, 244, 5, 48, "Input"],
Cell[37924, 1132, 158, 3, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38119, 1140, 994, 28, 142, "Input"],
Cell[39116, 1170, 412, 6, 48, "Output"]
}, Open  ]],
Cell[39543, 1179, 670, 17, 111, "Input"],
Cell[40216, 1198, 1028, 26, 80, "Input"],
Cell[41247, 1226, 323, 6, 48, "Input"],
Cell[41573, 1234, 343, 10, 48, "Input"],
Cell[41919, 1246, 1221, 31, 111, "Input"],
Cell[CellGroupData[{
Cell[43165, 1281, 181, 3, 48, "Input"],
Cell[43349, 1286, 199, 3, 48, "Output"]
}, Open  ]],
Cell[43563, 1292, 1256, 35, 111, "Input"],
Cell[44822, 1329, 1824, 48, 142, "Input"],
Cell[46649, 1379, 269, 8, 48, "Input"],
Cell[46921, 1389, 3054, 81, 173, "Input"],
Cell[CellGroupData[{
Cell[50000, 1474, 135, 2, 48, "Input"],
Cell[50138, 1478, 92, 1, 48, "Output"]
}, Open  ]],
Cell[50245, 1482, 498, 13, 48, "Input"],
Cell[50746, 1497, 495, 15, 48, "Input"],
Cell[CellGroupData[{
Cell[51266, 1516, 269, 7, 48, "Input"],
Cell[51538, 1525, 307, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51882, 1540, 129, 2, 48, "Input"],
Cell[52014, 1544, 4329, 136, 235, "Output"]
}, Open  ]],
Cell[56358, 1683, 187, 4, 48, "Input"],
Cell[CellGroupData[{
Cell[56570, 1691, 244, 7, 48, "Input"],
Cell[56817, 1700, 552, 10, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57406, 1715, 151, 3, 48, "Input"],
Cell[57560, 1720, 412, 11, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58009, 1736, 133, 1, 52, "Subsubsection"],
Cell[58145, 1739, 718, 20, 48, "Input"],
Cell[58866, 1761, 467, 11, 48, "Input"],
Cell[59336, 1774, 567, 16, 48, "Input"],
Cell[59906, 1792, 281, 7, 48, "Input"],
Cell[60190, 1801, 636, 17, 80, "Input"],
Cell[60829, 1820, 2559, 61, 235, "Input"],
Cell[63391, 1883, 487, 13, 80, "Input"],
Cell[63881, 1898, 409, 7, 48, "Input"],
Cell[CellGroupData[{
Cell[64315, 1909, 100, 1, 48, "Input"],
Cell[64418, 1912, 872, 25, 48, "Output"]
}, Open  ]],
Cell[65305, 1940, 973, 26, 111, "Input"],
Cell[CellGroupData[{
Cell[66303, 1970, 244, 5, 48, "Input"],
Cell[66550, 1977, 184, 3, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66771, 1985, 994, 28, 142, "Input"],
Cell[67768, 2015, 462, 7, 48, "Output"]
}, Open  ]],
Cell[68245, 2025, 670, 17, 111, "Input"],
Cell[68918, 2044, 653, 18, 48, "Input"],
Cell[69574, 2064, 467, 11, 48, "Input"],
Cell[70044, 2077, 616, 17, 48, "Input"],
Cell[70663, 2096, 333, 8, 48, "Input"],
Cell[70999, 2106, 665, 18, 80, "Input"],
Cell[71667, 2126, 2559, 61, 235, "Input"],
Cell[74229, 2189, 487, 13, 80, "Input"],
Cell[74719, 2204, 409, 7, 48, "Input"],
Cell[CellGroupData[{
Cell[75153, 2215, 100, 1, 48, "Input"],
Cell[75256, 2218, 1096, 31, 80, "Output"]
}, Open  ]],
Cell[76367, 2252, 973, 26, 111, "Input"],
Cell[CellGroupData[{
Cell[77365, 2282, 244, 5, 48, "Input"],
Cell[77612, 2289, 211, 4, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77860, 2298, 994, 28, 142, "Input"],
Cell[78857, 2328, 484, 7, 48, "Output"]
}, Open  ]],
Cell[79356, 2338, 670, 17, 111, "Input"],
Cell[80029, 2357, 763, 22, 80, "Input"],
Cell[80795, 2381, 323, 6, 48, "Input"],
Cell[81121, 2389, 343, 10, 48, "Input"],
Cell[81467, 2401, 1221, 31, 111, "Input"],
Cell[82691, 2434, 659, 19, 142, "Input"],
Cell[83353, 2455, 502, 14, 48, "Input"],
Cell[83858, 2471, 371, 8, 48, "Input"],
Cell[CellGroupData[{
Cell[84254, 2483, 292, 8, 48, InheritFromParent],
Cell[84549, 2493, 479, 9, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85065, 2507, 311, 7, 48, "Input"],
Cell[85379, 2516, 1059, 32, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86475, 2553, 155, 3, 48, "Input"],
Cell[86633, 2558, 254, 7, 48, "Output"]
}, Open  ]],
Cell[86902, 2568, 139, 2, 48, "Input"],
Cell[CellGroupData[{
Cell[87066, 2574, 819, 15, 48, "Input"],
Cell[87888, 2591, 923, 20, 80, "Output"]
}, Open  ]],
Cell[88826, 2614, 734, 21, 80, "Input"],
Cell[89563, 2637, 446, 11, 48, "Input"],
Cell[90012, 2650, 433, 12, 48, "Input"],
Cell[CellGroupData[{
Cell[90470, 2666, 175, 3, 48, "Input"],
Cell[90648, 2671, 437, 12, 48, "Output"]
}, Open  ]],
Cell[91100, 2686, 483, 14, 48, "Input"],
Cell[CellGroupData[{
Cell[91608, 2704, 130, 2, 48, "Input"],
Cell[91741, 2708, 70, 1, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91848, 2714, 320, 8, 48, "Input"],
Cell[92171, 2724, 569, 15, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92777, 2744, 135, 2, 48, "Input"],
Cell[92915, 2748, 71, 1, 48, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93047, 2756, 95, 1, 65, "Subsection"],
Cell[93145, 2759, 1429, 36, 173, "Input"],
Cell[94577, 2797, 365, 10, 48, "Input"],
Cell[94945, 2809, 667, 19, 80, "Input"],
Cell[95615, 2830, 306, 8, 48, "Input"],
Cell[95924, 2840, 832, 20, 80, "Input"],
Cell[96759, 2862, 2462, 60, 235, "Input"],
Cell[CellGroupData[{
Cell[99246, 2926, 135, 2, 48, "Input"],
Cell[99384, 2930, 166, 2, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99587, 2937, 133, 2, 48, "Input"],
Cell[99723, 2941, 166, 2, 48, "Output"]
}, Open  ]],
Cell[99904, 2946, 587, 15, 80, "Input"],
Cell[100494, 2963, 363, 7, 48, "Input"],
Cell[100860, 2972, 928, 26, 111, "Input"],
Cell[101791, 3000, 215, 5, 48, "Input"],
Cell[CellGroupData[{
Cell[102031, 3009, 197, 5, 48, "Input"],
Cell[102231, 3016, 279, 6, 34, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102547, 3027, 781, 23, 48, "Input"],
Cell[103331, 3052, 279, 6, 34, "Message"],
Cell[103613, 3060, 281, 6, 34, "Message"],
Cell[103897, 3068, 279, 6, 34, "Message"],
Cell[104179, 3076, 339, 7, 34, "Message"]
}, Open  ]],
Cell[104533, 3086, 300, 8, 48, "Input"],
Cell[CellGroupData[{
Cell[104858, 3098, 363, 10, 48, "Input"],
Cell[105224, 3110, 340, 8, 34, "Message"],
Cell[105567, 3120, 299, 7, 48, "Output"]
}, Open  ]],
Cell[105881, 3130, 204, 5, 48, "Input"],
Cell[CellGroupData[{
Cell[106110, 3139, 945, 27, 142, "Input"],
Cell[107058, 3168, 341, 5, 48, "Output"]
}, Open  ]],
Cell[107414, 3176, 621, 16, 111, "Input"],
Cell[CellGroupData[{
Cell[108060, 3196, 183, 3, 48, "Input"],
Cell[108246, 3201, 270, 4, 48, "Output"]
}, Open  ]],
Cell[108531, 3208, 739, 21, 80, "Input"],
Cell[109273, 3231, 1085, 32, 142, "Input"],
Cell[110361, 3265, 1786, 50, 220, "Input"],
Cell[CellGroupData[{
Cell[112172, 3319, 416, 10, 48, "Input"],
Cell[112591, 3331, 1061, 34, 80, "Output"]
}, Open  ]],
Cell[113667, 3368, 461, 15, 48, "Input"],
Cell[CellGroupData[{
Cell[114153, 3387, 1152, 30, 111, "Input"],
Cell[115308, 3419, 2218, 74, 111, "Output"]
}, Open  ]],
Cell[117541, 3496, 176, 4, 48, "Input"],
Cell[117720, 3502, 289, 7, 48, "Input"],
Cell[118012, 3511, 189, 4, 48, "Input"]
}, Open  ]]
}
]
*)

