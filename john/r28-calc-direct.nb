(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45055,       1367]
NotebookOptionsPosition[     41729,       1258]
NotebookOutlinePosition[     42109,       1275]
CellTagsIndexPosition[     42066,       1272]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Q: Explore A5 function properties", "Title",
 CellChangeTimes->{{3.7155216343483543`*^9, 3.715521661935596*^9}, {
   3.7155217024191933`*^9, 3.715521776747312*^9}, {3.715697106466093*^9, 
   3.715697132670868*^9}, 3.717339565784286*^9, {3.717596412665661*^9, 
   3.7175964295471077`*^9}, 3.7190772318918056`*^9, {3.719161602248806*^9, 
   3.719161617724811*^9}, 3.7191622907219543`*^9, {3.719330906137623*^9, 
   3.719330919779743*^9}, 3.7214675803034782`*^9, {3.722256568008562*^9, 
   3.722256584333577*^9}, {3.7222587062837543`*^9, 3.7222587099149513`*^9}, 
   3.723892693455821*^9, {3.723910170409132*^9, 3.723910179723064*^9}, {
   3.7247613005595207`*^9, 3.724761305849478*^9}, {3.7251093997280607`*^9, 
   3.725109422520021*^9}, {3.725109486952263*^9, 3.725109487141718*^9}, {
   3.7253796263545513`*^9, 3.725379627752042*^9}, {3.7262081679226522`*^9, 
   3.726208187405767*^9}, {3.7262310495952473`*^9, 3.726231058788488*^9}, {
   3.727099108843804*^9, 3.727099123185153*^9}, {3.727512928109139*^9, 
   3.727512933417872*^9}, {3.72821639588512*^9, 3.728216402599391*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "tools.m"}], ";"}]}], "Input",
 CellChangeTimes->{{3.713271961760497*^9, 3.7132719819312153`*^9}, {
  3.713272319095078*^9, 3.713272323693686*^9}, {3.7132801678394003`*^9, 
  3.7132801680639467`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"ratios", "[", "8", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728654541400839*^9, 3.7286545600847597`*^9}, {
  3.728751185707884*^9, 3.72875118689926*^9}, {3.728821644914404*^9, 
  3.728821644983272*^9}}],

Cell[CellGroupData[{

Cell["do all the sklyanin calcs", "Section",
 CellChangeTimes->{{3.728668069751317*^9, 3.728668074153475*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "sklyaninZ", ",", "sklyaninZPartial", ",", "brNumPartial", ",", "dFast", 
   ",", "startVec", ",", "sklyanin"}], "]"}]], "Input",
 CellChangeTimes->{{3.728655501011294*^9, 3.728655526761607*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"sklyaninZ", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"sklyaninZ", "[", "n", "]"}], "=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"RowReduce", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Z", "[", "n", "]"}], "]"}], "]"}], "]"}], ",", "50"}], 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sklyaninZPartial", "[", "n_", "]"}], "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"sklyaninZPartial", "[", "n", "]"}], "[", 
     RowBox[{"i", ",", "j"}], "]"}], "=", 
    RowBox[{"Insert", "[", 
     RowBox[{
      RowBox[{"Delete", "[", 
       RowBox[{
        RowBox[{"sklyaninZ", "[", "n", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
      RowBox[{"Y", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"brNumPartial", "[", "n_", "]"}], "[", 
     RowBox[{"i_", ",", "j_"}], "]"}], "[", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"brNumPartial", "[", "n", "]"}], "[", 
      RowBox[{"i", ",", "j"}], "]"}], "[", 
     RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "=", 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sklyaninZPartial", "[", "n", "]"}], "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"[", "a", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"sklyaninZPartial", "[", "n", "]"}], "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"[", "b", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"sklyaninZPartial", "[", "n", "]"}], "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"[", "c", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"sklyaninZPartial", "[", "n", "]"}], "[", 
         RowBox[{"i", ",", "j"}], "]"}], "[", 
        RowBox[{"[", "d", "]"}], "]"}]}], "}"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dFast", "[", "n_", "]"}], "[", 
    RowBox[{"f_", ",", 
     RowBox[{"Y", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"dFast", "[", "n", "]"}], "[", 
     RowBox[{"f", ",", 
      RowBox[{"Y", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "=", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", "f", ")"}], "//.", 
        RowBox[{"br", ":>", 
         RowBox[{
          RowBox[{"brNumPartial", "[", "n", "]"}], "[", 
          RowBox[{"i", ",", "j"}], "]"}]}]}], ",", 
       RowBox[{"Y", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], "]"}], "//.", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ":>", 
      RowBox[{
       RowBox[{"sklyaninZ", "[", "n", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"startVec", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"startVec", "[", "n", "]"}], "=", 
    RowBox[{"-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"hold", "[", 
         RowBox[{"i", ",", "j", ",", "a", ",", "b"}], "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sign", "[", 
           RowBox[{"a", "-", "i"}], "]"}], "-", 
          RowBox[{"Sign", "[", 
           RowBox[{"b", "-", "j"}], "]"}]}], ")"}], 
        RowBox[{
         RowBox[{"sklyaninZ", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "b"}], "]"}], "]"}], 
        RowBox[{
         RowBox[{"sklyaninZ", "[", "n", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"a", ",", "j"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"a", ",", "n"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"b", ",", "4"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sklyanin", "[", "n_", "]"}], "[", 
    RowBox[{"F_", ",", "G_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"f", ",", "g", ",", "base", ",", "intPart", ",", "fracPart"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"f", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"F", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ccap1", ":>", "cap1"}], ",", 
            RowBox[{"ccap", ":>", "cap"}]}], "}"}]}], ")"}], "//.", 
        "sort"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G", "//.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"ccap1", ":>", "cap1"}], ",", 
            RowBox[{"ccap", ":>", "cap"}]}], "}"}]}], ")"}], "//.", 
        "sort"}]}], ";", 
      RowBox[{"base", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"startVec", "[", "n", "]"}], "/.", 
          RowBox[{
           RowBox[{"hold", "[", 
            RowBox[{"i_", ",", "j_", ",", "a_", ",", "b_"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{
            RowBox[{
             RowBox[{"dFast", "[", "n", "]"}], "[", 
             RowBox[{"f", ",", 
              RowBox[{"Y", "[", 
               RowBox[{"i", ",", "j"}], "]"}]}], "]"}], 
            RowBox[{
             RowBox[{"dFast", "[", "n", "]"}], "[", 
             RowBox[{"g", ",", 
              RowBox[{"Y", "[", 
               RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", 
          RowBox[{
           RowBox[{"num", "[", "n", "]"}], "[", 
           RowBox[{"F", " ", "G"}], "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"intPart", "=", 
       RowBox[{"IntegerPart", "[", "base", "]"}]}], ";", 
      RowBox[{"fracPart", "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"FractionalPart", "[", "base", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"base", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Chop", "[", "base", "]"}], "===", "0"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"base", "-", "1"}], "]"}], "===", "0"}], ",", "1", ",", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{"base", "+", "1"}], "]"}], "===", "0"}], ",", 
         RowBox[{"-", "1"}], ",", "True", ",", "I"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "base", "]"}], ";"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.728654601074205*^9, 3.728654835551777*^9}, {
  3.728655027605917*^9, 3.728655051949662*^9}, {3.728655415015486*^9, 
  3.728655426803289*^9}, {3.7286554978982067`*^9, 3.728655498030416*^9}, {
  3.728655535065586*^9, 3.7286555352570257`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"skMatrix", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"sklyanin", "[", "9", "]"}], "[", 
       RowBox[{
        RowBox[{"base", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"base", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "base", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.7286558216258593`*^9, 3.728655889166992*^9}, {
  3.728656184678506*^9, 3.728656219360629*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25284.928913`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.728776923363207*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Save", "[", 
   RowBox[{"\"\<pb9.dat\>\"", ",", "skMatrix"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.728656197305503*^9, 3.728656225063737*^9}, {
  3.7287512144291143`*^9, 3.7287512190071173`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["clean up", "Section",
 CellChangeTimes->{{3.728668086376066*^9, 3.728668087444128*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<pb8.dat\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.728668104229123*^9, 3.728668105936501*^9}, {
  3.72875123109067*^9, 3.7287512324626217`*^9}, {3.7288216546151867`*^9, 
  3.728821654713852*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"base", ",", 
     RowBox[{"1", "/", "base"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728668472220148*^9, 3.7286684770726023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"len", "=", 
   RowBox[{"Length", "[", "base", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"lenBase", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"ratios", "[", "8", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728751239068491*^9, 3.72875125069877*^9}, {
  3.728821656696514*^9, 3.7288216567804937`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"clean8", "[", 
      RowBox[{
       RowBox[{"numRatios", "[", "8", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"allRatios", "[", "8", "]"}], "[", 
      RowBox[{"[", "i", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"numRatios", "[", "8", "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"clean8", "[", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"numRatios", "[", "8", "]"}], "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "=", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"allRatios", "[", "8", "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", 
       RowBox[{"numRatios", "[", "8", "]"}], "]"}]}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.725626332129253*^9, 3.72562637601993*^9}, {
  3.725626437295609*^9, 3.725626448422358*^9}, {3.7262163192182703`*^9, 
  3.7262163202225523`*^9}, {3.728668495377776*^9, 3.728668511560245*^9}, {
  3.728821749136611*^9, 3.728821761690243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"clean8", "[", "x_", "]"}], ":=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.725626473134863*^9, 3.7256264820493*^9}, {
  3.728668512973983*^9, 3.728668513303569*^9}, {3.728821769979789*^9, 
  3.728821770105782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fixPb1Pairs", "[", 
    RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "x1", ",", "x2", ",", "eval", ",", "posGoods", ",", "goodVals"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"x1", "=", 
       RowBox[{"base", "[", 
        RowBox[{"[", "n1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x2", "=", 
       RowBox[{"base", "[", 
        RowBox[{"[", "n2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eval", "=", 
       RowBox[{"clean8", "/@", 
        RowBox[{
         RowBox[{"num", "[", "8", "]"}], "[", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"1", "+", "x1"}], 
            RowBox[{"x1", " ", "x2"}]], ",", 
           FractionBox[
            RowBox[{"1", "+", 
             RowBox[{"(", 
              RowBox[{"1", "/", "x1"}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "x1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "/", "x2"}], ")"}]}]], ",", 
           FractionBox[
            RowBox[{"1", "+", 
             RowBox[{"(", 
              RowBox[{"1", "/", "x2"}], ")"}]}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "x2"}], ")"}], " ", "x1"}]], ",", 
           FractionBox[
            RowBox[{"1", "+", "x2"}], 
            RowBox[{"x2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "/", "x1"}], ")"}]}]]}], "}"}], "]"}]}]}], ";", 
      RowBox[{"posGoods", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Range", "[", "4", "]"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"eval", ",", "0"}], "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"goodVals", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"n1", ",", "n2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n1", "+", "lenBase"}], ",", 
              RowBox[{"n2", "+", "lenBase"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n2", "+", "lenBase"}], ",", "n1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n2", ",", 
              RowBox[{"n1", "+", "lenBase"}]}], "}"}]}], "}"}], "[", 
          RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posGoods"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"#", ",", 
           RowBox[{"2", "*", "lenBase"}], ",", "1"}], "]"}], "&"}], "/@", 
        "goodVals"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.727440854960793*^9, 3.727440866285125*^9}, {
  3.727441030220784*^9, 3.7274410307387447`*^9}, {3.7274412096481857`*^9, 
  3.727441211529909*^9}, {3.727441310338481*^9, 3.727441311859867*^9}, {
  3.72866852372716*^9, 3.728668557194051*^9}, {3.728751265473688*^9, 
  3.728751269973425*^9}, {3.728821774011963*^9, 3.728821775988071*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"newPb1Pairs", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"fixPb1Pairs", "@@", 
        RowBox[{"pb1Pairs", "[", 
         RowBox[{"[", "ii", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "pb1Pairs", "]"}]}], "}"}]}], "]"}], ",", 
     "ii"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pb1PairsRedux", "=", 
   RowBox[{"Union", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"newPb1Pairs", ",", "1"}], "]"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", "pb8", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7288219762881117`*^9, 3.728821980583393*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"pb8", "[", 
       RowBox[{"pb1PairsRedux", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", "1"}], ";", 
     RowBox[{
      RowBox[{"pb8", "[", 
       RowBox[{"Reverse", "[", 
        RowBox[{"pb1PairsRedux", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", 
      RowBox[{"-", "1"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{"Length", "[", "pb1PairsRedux", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pb8", "[", 
        RowBox[{"pb0Pairs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], "=", "0"}], ";", 
      RowBox[{
       RowBox[{"pb8", "[", 
        RowBox[{"Reverse", "[", 
         RowBox[{"pb0Pairs", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "pb0Pairs", "]"}]}], "}"}]}], "]"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pb8", "[", 
     RowBox[{"a_", ",", "a_"}], "]"}], ":=", "0"}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"pb8", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"pb8", "[", 
      RowBox[{"a", ",", "b"}], "]"}], "=", 
     RowBox[{"pb8", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b"}], "}"}], "]"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb8", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", "I"}], ";"}]}], "Input",
 CellChangeTimes->{{3.728670088743498*^9, 3.728670109397491*^9}, {
  3.728670156234994*^9, 3.728670188589501*^9}, {3.728670257331625*^9, 
  3.728670263057914*^9}, {3.72882198514177*^9, 3.7288220009378233`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "pb1PairsRedux", "]"}]], "Input",
 CellChangeTimes->{{3.7286693708804903`*^9, 3.728669375938244*^9}}],

Cell[BoxData["11200"], "Output",
 CellChangeTimes->{3.728777308025878*^9, 3.7288219195593643`*^9, 
  3.728822005378043*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "pb1Pairs", "]"}]], "Input",
 CellChangeTimes->{{3.728821841583209*^9, 3.728821845265786*^9}}],

Cell[BoxData["22400"], "Output",
 CellChangeTimes->{3.728821919635479*^9, 3.72882200666775*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pb1Buds", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pb1Buds", "[", "n", "]"}], "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Range", "[", "len", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"pb8", "[", 
         RowBox[{"n", ",", "#"}], "]"}], "\[Equal]", "1"}], "&"}]}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb0Buds", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pb0Buds", "[", "n", "]"}], "=", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Range", "[", "len", "]"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"pb8", "[", 
         RowBox[{"n", ",", "#"}], "]"}], "\[Equal]", "0"}], "&"}]}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.728813683499399*^9, 3.728813719009295*^9}, {
  3.7288218499147453`*^9, 3.728821850626604*^9}}],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"pb1Buds", "[", "n", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "len"}], "}"}]}], "]"}], ";"}], ",", "n"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7288138982202168`*^9, 3.728813959226224*^9}}],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"pb0Buds", "[", "n", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "len"}], "}"}]}], "]"}], ";"}], ",", "n"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.728814006732176*^9, 3.728814006934466*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["find good A5s", "Section",
 CellChangeTimes->{{3.7286697723232307`*^9, 3.728669775876183*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"evalPair", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "lists", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lists", "=", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"lists", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"lists", "[", 
                    RowBox[{"[", "aa", "]"}], "]"}], ",", "#"}], "]"}], "&"}],
                 "/@", 
                RowBox[{"Intersection", "[", 
                 RowBox[{
                  RowBox[{"pb1Buds", "[", 
                   RowBox[{"lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"aa", ",", 
                    RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], ",", 
                  RowBox[{"Intersection", "@@", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"pb0Buds", "[", 
                    RowBox[{"lists", "[", 
                    RowBox[{"[", 
                    RowBox[{"aa", ",", "ii"}], "]"}], "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"ii", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"lists", "[", 
                    RowBox[{"[", "aa", "]"}], "]"}], "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"aa", ",", 
                 RowBox[{"Length", "[", "lists", "]"}]}], "}"}]}], "]"}], ",",
              "1"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"___", ",", "x_", ",", "___", ",", "x_", ",", "___"}], 
            "}"}]}], "]"}]}], ",", "3"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "lists", "]"}], ";"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.728813342349893*^9, 3.728813407313992*^9}, {
  3.728813731095347*^9, 3.7288137750159283`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5Opts", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"evalPair", "[", 
        RowBox[{"pb1PairsRedux", "[", 
         RowBox[{"[", "aa", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"aa", ",", 
         RowBox[{"Length", "[", "pb1PairsRedux", "]"}]}], "}"}]}], "]"}], ",",
      "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728813436512266*^9, 3.7288134719012413`*^9}, {
  3.728814608632662*^9, 3.728814620298317*^9}, {3.7288152227352324`*^9, 
  3.728815225929406*^9}, {3.728817195842985*^9, 3.728817200330102*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "a5Opts", "]"}]], "Input",
 CellChangeTimes->{{3.728814664417626*^9, 3.7288146672114353`*^9}}],

Cell[BoxData["4064"], "Output",
 CellChangeTimes->{{3.7288146677105207`*^9, 3.728814680801055*^9}, 
   3.72882210850072*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5CountBads", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{
         RowBox[{"clean8", "/@", 
          RowBox[{
           RowBox[{"num", "[", "8", "]"}], "[", 
           RowBox[{"a5Xs", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"base", "[", 
                RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
              RowBox[{"a5Opts", "[", 
               RowBox[{"[", "ii", "]"}], "]"}]}], ")"}]}], "]"}]}], ",", 
         "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"ii", ",", 
         RowBox[{"Length", "[", "a5Opts", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"ProgressIndicator", "[", 
      RowBox[{"ii", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "a5Opts", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728671015667851*^9, 3.7286710186426067`*^9}, {
  3.728822119132592*^9, 3.728822121997957*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Count", "[", 
  RowBox[{"a5CountBads", ",", "0"}], "]"}]], "Input"],

Cell[BoxData["448"], "Output",
 CellChangeTimes->{3.728786313833919*^9, 3.728817097643464*^9, 
  3.728822441872292*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodA5s", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"base", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"a5Opts", "[", 
        RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"a5CountBads", ",", "0"}], "]"}], "]"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.727512125210362*^9, 3.727512151134872*^9}, {
  3.7275127010696507`*^9, 3.727512778849861*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodA5sNum", "=", 
   RowBox[{
    RowBox[{"num", "[", "8", "]"}], "[", "goodA5s", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.727540825594473*^9, 3.7275408424951077`*^9}, {
  3.728671419607298*^9, 3.7286714198290997`*^9}, {3.7288224026826963`*^9, 
  3.728822402838578*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"evalFullXs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"sortInverse", "[", 
      RowBox[{"a5Xs", "@@", "#"}], "]"}], "&"}], "/@", "goodA5sNum"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.727541190360359*^9, 3.72754119418526*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uniqueA5s", "=", 
   RowBox[{"Union", "[", "evalFullXs", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7275408466362047`*^9, 3.727540876013023*^9}, {
  3.727541169840522*^9, 3.7275412003874607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodA5sReduced", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"goodA5s", "[", 
      RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"evalFullXs", ",", "#"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "uniqueA5s"}], "]"}]}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.727541177923134*^9, 3.727541242012731*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "goodA5sReduced", "]"}]], "Input",
 CellChangeTimes->{{3.727617977703248*^9, 3.727617982567045*^9}}],

Cell[BoxData["56"], "Output",
 CellChangeTimes->{3.728786313965322*^9, 3.728818958056404*^9, 
  3.728822443682914*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"allImages", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Union", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"listSym", "[", "8", "]"}], "[", 
        RowBox[{"f", "[", 
         RowBox[{"sortInverse", "[", 
          RowBox[{"clean8", "/@", 
           RowBox[{
            RowBox[{"num", "[", "8", "]"}], "[", 
            RowBox[{"a5Xs", "@@", 
             RowBox[{"goodA5sReduced", "[", 
              RowBox[{"[", "aa", "]"}], "]"}]}], "]"}]}], "]"}], "]"}], "]"}],
        "/.", 
       RowBox[{
        RowBox[{"f", "[", "a_", "]"}], "\[RuleDelayed]", 
        RowBox[{"sortInverse", "[", "a", "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", 
       RowBox[{"Length", "[", "goodA5sReduced", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728671979875907*^9, 3.728672016902842*^9}, {
  3.728672067808107*^9, 3.728672165809305*^9}, {3.7288224142536793`*^9, 
  3.728822417208301*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Union", "[", 
  RowBox[{"Length", "/@", "allImages"}], "]"}]], "Input",
 CellChangeTimes->{{3.72867216918813*^9, 3.728672173148546*^9}, {
  3.7287515854934*^9, 3.728751587202077*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "16"}], "}"}]], "Output",
 CellChangeTimes->{3.728786314040728*^9, 3.728819025416144*^9, 
  3.72882245796982*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"posGoods", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Position", "[", 
       RowBox[{"allImages", ",", "#"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Union", "[", "allImages", "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7287492000267773`*^9, 3.7287492010384903`*^9}, 
   3.7287515687996893`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "posGoods", "]"}]], "Input",
 CellChangeTimes->{{3.728751590695044*^9, 3.728751593098089*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.728786314123789*^9, 3.728819040490986*^9, 
  3.7288224585940523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Length", "/@", "allImages"}], ")"}], "[", 
    RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", "posGoods"}]], "Input",
 CellChangeTimes->{{3.728751329732737*^9, 3.728751341027359*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "16", ",", "16", ",", "16"}], "}"}]], "Output",
 CellChangeTimes->{3.728786314197228*^9, 3.7288190623829536`*^9, 
  3.7288224586983633`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"goodA5sReduced", "[", 
     RowBox[{"[", "#", "]"}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"allImages", ",", "#"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"Union", "[", "allImages", "]"}]}], ")"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7286725062412853`*^9, 3.728672517452669*^9}, {
   3.7287491595609703`*^9, 3.728749169851562*^9}, 3.7288190951866407`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"goodA5sBase", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"listSym", "[", "8", "]"}], "[", 
         RowBox[{"f", "[", 
          RowBox[{"goodA5sReduced", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"f", "[", "a_", "]"}], "\[RuleDelayed]", "a"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "posGoods"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72873218472192*^9, 3.728732185532209*^9}, {
  3.728749207091157*^9, 3.728749227735136*^9}, {3.728822430426209*^9, 
  3.728822430523934*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["fit to R29", "Section",
 CellChangeTimes->{{3.728748995746583*^9, 3.728748997871173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<a2SubFuncs.dat\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.727789559255394*^9, 3.727789571610578*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a5Func", "[", 
    RowBox[{"X1_", ",", "X2_", ",", "X3_", ",", "X4_", ",", "X5_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a5FuncMM", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "\[Rule]", "X1"}], ",", 
       RowBox[{"x2", "\[Rule]", "X2"}], ",", 
       RowBox[{"x3", "\[Rule]", "X3"}], ",", 
       RowBox[{"x4", "\[Rule]", "X4"}], ",", 
       RowBox[{"x5", "\[Rule]", "X5"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"q", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "2", "]"}], "\[Rule]", 
       RowBox[{"1", "/", "4"}]}], ",", 
      RowBox[{
       RowBox[{"q", "[", "3", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "4", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"q", "[", "5", "]"}], "\[Rule]", 
       RowBox[{"1", "/", "4"}]}]}], "}"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fastB2b2", "[", "n_", "]"}], "[", "x_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ttensor", ",", "wwedge", ",", "tmp"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"wwedge", "[", 
        RowBox[{
         RowBox[{"cb2", "[", "a_", "]"}], ",", 
         RowBox[{"cb2", "[", "b_", "]"}]}], "]"}], ":=", 
       RowBox[{"ttensor", "[", 
        RowBox[{"a", ",", 
         RowBox[{
          RowBox[{"m1", "[", "n", "]"}], "[", "a", "]"}], ",", "b", ",", 
         RowBox[{
          RowBox[{"m1", "[", "n", "]"}], "[", "b", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"x", "/.", 
        RowBox[{"wedge", "\[Rule]", "wwedge"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ttensor", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"b_", "*", "c_"}], ",", "d___"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"ttensor", "[", 
         RowBox[{"a", ",", "b", ",", "d"}], "]"}], "+", 
        RowBox[{"ttensor", "[", 
         RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"ttensor", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"b_", "^", "c_"}], ",", "d___"}], "]"}], ":=", 
       RowBox[{"c", " ", 
        RowBox[{"ttensor", "[", 
         RowBox[{"a", ",", "b", ",", "d"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"ttensor", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"b_", "/", "c_"}], ",", "d___"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"ttensor", "[", 
         RowBox[{"a", ",", "b", ",", "d"}], "]"}], "-", 
        RowBox[{"ttensor", "[", 
         RowBox[{"a", ",", "c", ",", "d"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"ttensor", "[", 
        RowBox[{"a___", ",", 
         RowBox[{"b_", "?", "NumberQ"}], ",", "c___"}], "]"}], ":=", "0"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"Evaluate", "[", "tmp", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Clear", "[", "ttensor", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ttensor", "[", 
        RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "]"}], ":=", 
       RowBox[{
        RowBox[{"tensor", "[", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "]"}], "-", 
        RowBox[{"tensor", "[", 
         RowBox[{"a", ",", "b", ",", "d", ",", "c"}], "]"}], "-", 
        RowBox[{"tensor", "[", 
         RowBox[{"b", ",", "a", ",", "c", ",", "d"}], "]"}], "+", 
        RowBox[{"tensor", "[", 
         RowBox[{"b", ",", "a", ",", "d", ",", "c"}], "]"}], "-", 
        RowBox[{"tensor", "[", 
         RowBox[{"c", ",", "d", ",", "a", ",", "b"}], "]"}], "+", 
        RowBox[{"tensor", "[", 
         RowBox[{"c", ",", "d", ",", "b", ",", "a"}], "]"}], "+", 
        RowBox[{"tensor", "[", 
         RowBox[{"d", ",", "c", ",", "a", ",", "b"}], "]"}], "-", 
        RowBox[{"tensor", "[", 
         RowBox[{"d", ",", "c", ",", "b", ",", "a"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Expand", "[", "tmp", "]"}], "]"}], ";"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.72804267462464*^9, 3.728042724118924*^9}, {
  3.7280427544145393`*^9, 3.728042905346055*^9}, {3.7280429556691523`*^9, 
  3.728043169681387*^9}, {3.7280497517292337`*^9, 3.7280497536690683`*^9}, {
  3.728559930886508*^9, 3.728559939863666*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a5AnsatzExp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tmp", "=", 
         RowBox[{
          RowBox[{"listSym", "[", "8", "]"}], "[", 
          RowBox[{"Expand", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a5Func", "@@", 
              RowBox[{"goodA5sBase", "[", 
               RowBox[{"[", "aaa", "]"}], "]"}]}], ")"}], "/.", 
            RowBox[{
             RowBox[{"cb2", "[", "a_", "]"}], "\[RuleDelayed]", 
             RowBox[{"cb2", "[", 
              RowBox[{
               RowBox[{"clean", "[", "8", "]"}], "[", "a", "]"}], "]"}]}]}], 
           "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Monitor", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fastB2b2", "[", "8", "]"}], "[", 
            RowBox[{"tmp", "[", 
             RowBox[{"[", "iii", "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"iii", ",", 
             RowBox[{"Length", "[", "tmp", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"iii", ",", "aaa"}], "}"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"aaa", ",", 
       RowBox[{"Length", "[", "goodA5sBase", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728567314060536*^9, 3.728567323299004*^9}, {
  3.7285673543165083`*^9, 3.7285674060359898`*^9}, {3.72874912696802*^9, 
  3.728749130285658*^9}, {3.728749232798204*^9, 3.7287492428428917`*^9}, {
  3.728749418618829*^9, 3.7287495494110193`*^9}, {3.728819441056377*^9, 
  3.728819447917605*^9}, {3.728822484837582*^9, 3.7288224960067873`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ansatzExp", "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "aa", "]"}], 
      RowBox[{"Total", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"a5AnsatzExp", "[", 
         RowBox[{"[", "aa", "]"}], "]"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", 
       RowBox[{"Length", "[", "a5AnsatzExp", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.728568320664447*^9, 3.728568395175703*^9}, {
  3.728568685509221*^9, 3.7285686981993017`*^9}, {3.7287492871015673`*^9, 
  3.728749287280765*^9}, {3.72882251809377*^9, 3.728822520174348*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"answer", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"b2b2", "[", "8", "]"}], "[", 
     RowBox[{"symbol", "[", "8", "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728046222540709*^9, 3.728046225175274*^9}, {
  3.728749035010214*^9, 3.7287490373148603`*^9}, {3.728822524365613*^9, 
  3.728822526489118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsAnswer", "=", 
   RowBox[{"Variables", "[", "answer", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.727793972555093*^9, 3.727793977769606*^9}, {
  3.7277940148349447`*^9, 3.727794014967668*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsSamp", "=", 
   RowBox[{"RandomSample", "[", 
    RowBox[{"varsAnswer", ",", "100"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728568884207963*^9, 3.728568905392662*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Normal", "[", 
    RowBox[{
     RowBox[{"CoefficientArrays", "[", 
      RowBox[{
       RowBox[{"ansatzExp", "-", "answer"}], ",", "varsSamp"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.728568731276816*^9, 3.728568758342907*^9}, {
  3.728568909251799*^9, 3.7285689353521557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solve", "[", "eqs", "]"}]], "Input",
 CellChangeTimes->{{3.728751116120035*^9, 3.728751119780645*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
    FractionBox["1", "4"]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "3", "]"}], "\[Rule]", 
    FractionBox["1", "2"]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "4", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.728751120368403*^9, 3.7287863245512743`*^9, 
  3.728820685203075*^9, 3.728823166060231*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{840, 1001},
WindowMargins->{{26, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1085, 14, 114, "Title"],
Cell[1668, 38, 368, 9, 66, "Input"],
Cell[2039, 49, 269, 6, 39, "Input"],
Cell[CellGroupData[{
Cell[2333, 59, 110, 1, 80, "Section"],
Cell[2446, 62, 246, 5, 66, "Input"],
Cell[2695, 69, 7245, 213, 742, "Input"],
Cell[CellGroupData[{
Cell[9965, 286, 726, 20, 92, "Input"],
Cell[10694, 308, 130, 3, 39, "Output"]
}, Open  ]],
Cell[10839, 314, 239, 5, 39, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[11115, 324, 93, 1, 62, "Section"],
Cell[11211, 327, 244, 5, 39, "Input"],
Cell[11458, 334, 227, 6, 39, "Input"],
Cell[11688, 342, 106, 3, 39, "Input"],
Cell[11797, 347, 258, 6, 39, "Input"],
Cell[12058, 355, 1298, 38, 118, "Input"],
Cell[13359, 395, 265, 6, 39, "Input"],
Cell[13627, 403, 3239, 87, 316, "Input"],
Cell[16869, 492, 422, 13, 92, "Input"],
Cell[17294, 507, 184, 5, 39, "Input"],
Cell[17481, 514, 146, 3, 39, "Input"],
Cell[17630, 519, 1942, 62, 274, "Input"],
Cell[CellGroupData[{
Cell[19597, 585, 139, 2, 39, "Input"],
Cell[19739, 589, 123, 2, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19899, 596, 132, 2, 39, "Input"],
Cell[20034, 600, 95, 1, 39, "Output"]
}, Open  ]],
Cell[20144, 604, 904, 28, 66, "Input"],
Cell[21051, 634, 328, 10, 39, "Input"],
Cell[21382, 646, 326, 10, 39, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21745, 661, 100, 1, 80, "Section"],
Cell[21848, 664, 2409, 62, 274, "Input"],
Cell[24260, 728, 641, 16, 66, "Input"],
Cell[CellGroupData[{
Cell[24926, 748, 132, 2, 39, "Input"],
Cell[25061, 752, 124, 2, 39, "Output"]
}, Open  ]],
Cell[25200, 757, 1083, 31, 118, "Input"],
Cell[CellGroupData[{
Cell[26308, 792, 91, 2, 39, "Input"],
Cell[26402, 796, 119, 2, 39, "Output"]
}, Open  ]],
Cell[26536, 801, 610, 19, 66, "Input"],
Cell[27149, 822, 313, 7, 39, "Input"],
Cell[27465, 831, 270, 8, 39, "Input"],
Cell[27738, 841, 236, 5, 39, "Input"],
Cell[27977, 848, 493, 15, 66, "Input"],
Cell[CellGroupData[{
Cell[28495, 867, 138, 2, 39, "Input"],
Cell[28636, 871, 118, 2, 39, "Output"]
}, Open  ]],
Cell[28769, 876, 989, 27, 170, "Input"],
Cell[CellGroupData[{
Cell[29783, 907, 207, 4, 39, "Input"],
Cell[29993, 913, 162, 4, 39, "Output"]
}, Open  ]],
Cell[30170, 920, 420, 12, 39, "Input"],
Cell[CellGroupData[{
Cell[30615, 936, 132, 2, 39, "Input"],
Cell[30750, 940, 119, 2, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30906, 947, 260, 7, 39, "Input"],
Cell[31169, 956, 189, 4, 39, "Output"]
}, Open  ]],
Cell[31373, 963, 580, 16, 66, "Input"],
Cell[31956, 981, 687, 19, 92, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32680, 1005, 95, 1, 80, "Section"],
Cell[32778, 1008, 150, 3, 39, "Input"],
Cell[32931, 1013, 955, 27, 92, "Input"],
Cell[33889, 1042, 3526, 87, 378, "Input"],
Cell[37418, 1131, 1736, 44, 222, "Input"],
Cell[39157, 1177, 653, 17, 66, "Input"],
Cell[39813, 1196, 372, 9, 39, "Input"],
Cell[40188, 1207, 235, 5, 39, "Input"],
Cell[40426, 1214, 216, 5, 39, "Input"],
Cell[40645, 1221, 398, 10, 39, "Input"],
Cell[CellGroupData[{
Cell[41068, 1235, 126, 2, 39, "Input"],
Cell[41197, 1239, 492, 14, 52, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

